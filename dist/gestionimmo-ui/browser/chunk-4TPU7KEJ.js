import{a as $e,b as ct,d as he}from"./chunk-YSQV2JRF.js";import{a as Ae,b as Y,e as k,f as Ze,h as be,i as Ft}from"./chunk-EFHLZIDN.js";import{$ as D,Ab as Bt,Ba as R,Bc as z,Ca as It,Cb as O,D as yt,Db as kt,E as Ue,Ea as Me,Eb as j,Fa as De,G as Ge,Ga as Fe,Hc as Ne,Ia as a,Ja as v,Jc as Re,Ka as d,La as w,Lc as ie,M as _,Ma as Qe,Mc as Dt,N as f,Na as bt,Oa as fe,Pa as Z,Q as xt,Qa as ee,Qc as Tt,Ra as te,S as we,Sc as Pt,X as t,Xa as r,Ya as o,Z as h,Za as ht,_a as We,aa as qe,ac as wt,bc as Mt,ca as ae,da as x,ec as H,f as _t,g as G,ga as b,gc as K,ha as N,hb as Ye,hc as Q,ia as S,ib as Ct,ic as Te,j as ze,jb as ye,k as L,ka as He,la as I,lb as P,lc as Pe,mb as Ke,mc as Oe,na as Ce,nb as St,oa as F,oc as Ie,pa as T,pc as Ve,qa as n,qb as Xe,qc as Le,r as A,ra as i,rb as Et,rc as re,s as ge,sa as c,sc as oe,tb as Je,tc as le,ub as U,v as _e,va as B,vb as q,wb as xe,wc as W,xa as y,xb as dt,ya as g,z as ft,zb as $,zc as V}from"./chunk-DX4DG724.js";var Se=(p=>(p.ANNUAL="annual",p.HALFYEARLY="half-yearly",p.QUARTERLY="quarterly",p))(Se||{}),et=Object.values(Se).filter(l=>typeof l=="string");var M=class l extends Mt{constructor(e,p,s,u){super(e,p,u);this.https=e;this.snak=p;this.router=s;this.injector_=u}_inventories$=new G([]);get inventories$(){return this._inventories$.asObservable()}_missingInventories$=new G([]);get missingInventories$(){return this._missingInventories$.asObservable()}_brokenInventories$=new G([]);get brokenInventories$(){return this._brokenInventories$.asObservable()}getInventoriesFromServer(e=this.emptyPaginate,p=[]){let s=this.getHearder(),u=this.explosePaginationOption(e),E=Ze(p);u+=E?`&${E}`:"",this.setLoadStatus(!0),this.http.get(`${$.apiUrlFirst}/admin/inventories/all?${u}`,s).pipe(L(C=>{this.setLoadStatus(!1),console.log("Inventories data:",C),this._inventories$.next(C.data?.data??[]),this._paginateData$.next({current_page:C.data?.current_page??1,per_page:C.data?.per_page??1,total:C.data?.total??1})}),A(C=>(this.setLoadStatus(!1),this.setSnackMesage("Error loading inventories","btn-danger"),ze([])))).subscribe()}getInventoryDetailFromServer(e){let p=this.getHearder();return this.setLoadStatus(!0),this.http.get(`${$.apiUrlFirst}/admin/inventories/${e}`,p).pipe(L(s=>(this.setLoadStatus(!1),s.data)),A(s=>{throw this.setLoadStatus(!1),this.setSnackMesage("Error loading inventory details","btn-danger"),s}))}createInventory(e){let p=this.getHearder();return this.setLoadStatus(!0),this.http.post(`${$.apiUrlFirst}/admin/inventories/create`,e.value,p).pipe(L(s=>(this.setLoadStatus(!1),s.success&&this.setSnackMesage(s.message??"Inventory created successfully","btn-success"),s)),A(s=>{throw this.setLoadStatus(!1),this.setSnackMesage("Error creating inventory","btn-danger"),s}))}validateInventoryOffice(e,p){let s=this.getHearder();return this.http.put(`${$.apiUrlFirst}/admin/offices/validate-inventory/${e}`,{is_inventory:p},s).pipe(L(u=>(u.success&&this.setSnackMesage(u.message??"Office inventory status updated successfully","btn-success"),u.data)),A(u=>{throw this.setLoadStatus(!1),this.setSnackMesage("Error updating office inventory status","btn-danger"),u}))}updateInventory(e,p){let s=this.getHearder();return this.setLoadStatus(!0),this.http.put(`${$.apiUrlFirst}/admin/inventories/update/${e}`,p.value,s).pipe(L(u=>(this.setLoadStatus(!1),u.success&&this.setSnackMesage(u.message??"Inventory updated successfully","btn-success"),u)),A(u=>{throw this.setLoadStatus(!1),this.setSnackMesage("Error updating inventory","btn-danger"),u}))}deleteInventory(e){let p=this.getHearder();return this.setLoadStatus(!0),this.http.delete(`${$.apiUrlFirst}/admin/inventories/${e}`,p).pipe(L(s=>(this.setLoadStatus(!1),s.success&&this.setSnackMesage(s.message??"Inventory deleted successfully","btn-success"),s)),A(s=>{throw this.setLoadStatus(!1),this.setSnackMesage("Error deleting inventory","btn-danger"),s}))}closeInventory(e){let p=this.getHearder();return this.setLoadStatus(!0),this.http.post(`${$.apiUrlFirst}/admin/inventories/close/${e}`,{},p).pipe(L(s=>(this.setLoadStatus(!1),s.success&&this.setSnackMesage(s.message??"Inventory closed successfully","btn-success"),s)),A(s=>{throw this.setLoadStatus(!1),this.setSnackMesage("Error closing inventory","btn-danger"),s})).subscribe()}getMissingInventoriesFromServer(e=this.emptyPaginate,p=[]){let s=this.getHearder(),u=this.explosePaginationOption(e),E=Ze(p);u+=E?`&${E}`:"",this.setLoadStatus(!0),this.http.get(`${$.apiUrlFirst}/admin/inventorie-missings/all?${u}`,s).pipe(L(C=>{this.setLoadStatus(!1),console.log("Missing Inventories data:",C),this._missingInventories$.next(C.data?.data??[]),this._paginateData$.next({current_page:C.data?.current_page??1,per_page:C.data?.per_page??1,total:C.data?.total??1})}),A(C=>(this.setLoadStatus(!1),this.setSnackMesage("Error loading missing inventories","btn-danger"),ze([])))).subscribe()}getMissingInventoryDetailFromServer(e){let p=this.getHearder();return this.setLoadStatus(!0),this.http.get(`${$.apiUrlFirst}/admin/inventorie-missings/${e}`,p).pipe(L(s=>(this.setLoadStatus(!1),s.data)),A(s=>{throw this.setLoadStatus(!1),this.setSnackMesage("Error loading missing inventory details","btn-danger"),s}))}createMissingInventory(e){let p=this.getHearder();this.setLoadStatus(!0),this.http.post(`${$.apiUrlFirst}/admin/inventorie-missings/create`,e,p).pipe(L(s=>(this.setLoadStatus(!1),this.setConfirmSubmit(!0),s.success&&this.setSnackMesage(s.message??"Missing inventory created successfully","btn-success"),s)),A(s=>{throw this.setLoadStatus(!1),this.setSnackMesage("Error creating missing inventory","btn-danger"),s})).subscribe()}updateMissingInventory(e,p){let s=this.getHearder();this.setLoadStatus(!0),this.http.put(`${$.apiUrlFirst}/admin/inventorie-missings/update/${e}`,p,s).pipe(L(u=>(this.setLoadStatus(!1),this.setConfirmSubmit(!0),u.success&&this.setSnackMesage(u.message??"Missing inventory updated successfully","btn-success"),u)),A(u=>{throw this.setLoadStatus(!1),this.setSnackMesage("Error updating missing inventory","btn-danger"),u})).subscribe()}deleteMissingInventory(e){let p=this.getHearder();return this.setLoadStatus(!0),this.http.delete(`${$.apiUrlFirst}/admin/inventorie-missings/${e}`,p).pipe(L(s=>(this.setLoadStatus(!1),s.success&&this.setSnackMesage(s.message??"Missing inventory deleted successfully","btn-success"),s)),A(s=>{throw this.setLoadStatus(!1),this.setSnackMesage("Error deleting missing inventory","btn-danger"),s}))}getBrokenInventoriesFromServer(e=this.emptyPaginate,p=[]){let s=this.getHearder(),u=this.explosePaginationOption(e),E=Ze(p);u+=E?`&${E}`:"",this.setLoadStatus(!0),this.http.get(`${$.apiUrlFirst}/admin/inventorie-brokens/all?${u}`,s).pipe(L(C=>{this.setLoadStatus(!1),console.log("Broken Inventories data:",C),this._brokenInventories$.next(C.data?.data??[]),this._paginateData$.next({current_page:C.data?.current_page??1,per_page:C.data?.per_page??1,total:C.data?.total??1})}),A(C=>(this.setLoadStatus(!1),this.setSnackMesage("Error loading broken inventories","btn-danger"),ze([])))).subscribe()}getBrokenInventoryDetailFromServer(e){let p=this.getHearder();return this.setLoadStatus(!0),this.http.get(`${$.apiUrlFirst}/admin/inventorie-brokens/${e}`,p).pipe(L(s=>(this.setLoadStatus(!1),s.data)),A(s=>{throw this.setLoadStatus(!1),this.setSnackMesage("Error loading broken inventory details","btn-danger"),s}))}createBrokenInventory(e){let p=this.getHearder();this.setLoadStatus(!0),this.http.post(`${$.apiUrlFirst}/admin/inventorie-brokens/create`,e,p).pipe(L(s=>(this.setLoadStatus(!1),this.setConfirmSubmit(!0),s.success?this.setSnackMesage(s.message??"Broken inventory created successfully","btn-success"):this.setSnackMesage(s.message,"btn-danger"),s)),A(s=>{throw this.setLoadStatus(!1),this.setSnackMesage(s.message,"btn-danger"),s})).subscribe()}updateBrokenInventory(e,p){let s=this.getHearder();this.setLoadStatus(!0),this.http.put(`${$.apiUrlFirst}/admin/inventorie-brokens/update/${e}`,p,s).pipe(L(u=>(this.setLoadStatus(!1),this.setConfirmSubmit(!0),u.success?this.setSnackMesage(u.message??"Broken inventory updated successfully","btn-success"):this.setSnackMesage(u.message,"btn-danger"),u)),A(u=>{throw this.setLoadStatus(!1),this.setSnackMesage(u.message,"btn-danger"),u})).subscribe()}deleteBrokenInventory(e){let p=this.getHearder();return this.setLoadStatus(!0),this.http.delete(`${$.apiUrlFirst}/admin/inventorie-brokens/${e}`,p).pipe(L(s=>(this.setLoadStatus(!1),s.success&&this.setSnackMesage(s.message??"Broken inventory deleted successfully","btn-success"),s)),A(s=>{throw this.setLoadStatus(!1),this.setSnackMesage("Error deleting broken inventory","btn-danger"),s}))}getActiveInventoriesFromServer(){let e=this.getHearder();return this.http.get(`${$.apiUrlFirst}/admin/inventories/active`,e).pipe(L(p=>p.data??[]),A(p=>(this.setSnackMesage("Error loading active inventories","btn-danger"),ze([]))))}static \u0275fac=function(p){return new(p||l)(Ge(Je),Ge(wt),Ge(q),Ge(xt))};static \u0275prov=yt({token:l,factory:l.\u0275fac,providedIn:"root"})};var Nt=(l,m)=>m.value;function Rt(l,m){l&1&&(n(0,"div",6),c(1,"app-custom-spinner"),n(2,"p",14),a(3),r(4,"translate"),i()()),l&2&&(t(3),d("",o(4,1,"Loading"),"..."))}function jt(l,m){if(l&1&&(n(0,"div",21),a(1),i()),l&2){let e=g(2);t(),d(" ",e.getFieldError("name")," ")}}function zt(l,m){if(l&1&&(n(0,"option",26),a(1),r(2,"translate"),i()),l&2){let e=m.$implicit;b("value",e.value),t(),v(o(2,2,e.label))}}function Gt(l,m){if(l&1&&(n(0,"div",21),a(1),i()),l&2){let e=g(2);t(),d(" ",e.getFieldError("type")," ")}}function Ut(l,m){if(l&1&&(n(0,"div",21),a(1),i()),l&2){let e=g(2);t(),d(" ",e.getFieldError("end_date")," ")}}function qt(l,m){if(l&1&&(n(0,"div",21),a(1),i()),l&2){let e=g(2);t(),d(" ",e.getFieldError("description")," ")}}function Ht(l,m){if(l&1){let e=B();n(0,"form",15),y("ngSubmit",function(){_(e);let s=g();return f(s.onSubmit())}),n(1,"div",16)(2,"div",17)(3,"label",18),a(4),r(5,"translate"),n(6,"span",19),a(7,"*"),i()(),c(8,"input",20),r(9,"translate"),x(10,jt,2,1,"div",21),i(),n(11,"div",22)(12,"label",23),a(13),r(14,"translate"),n(15,"span",19),a(16,"*"),i()(),n(17,"select",24)(18,"option",25),a(19),r(20,"translate"),i(),F(21,zt,3,4,"option",26,Nt),i(),x(23,Gt,2,1,"div",21),i(),n(24,"div",22)(25,"label",27),a(26),r(27,"translate"),i(),c(28,"input",28),x(29,Ut,2,1,"div",21),i(),n(30,"div",17)(31,"label",29),a(32),r(33,"translate"),i(),c(34,"textarea",30),r(35,"translate"),x(36,qt,2,1,"div",21),i()()()}if(l&2){let e=g();b("formGroup",e.inventoryForm),t(4),d(" ",o(5,20,"Name")," "),t(4),N("is-invalid",e.isFieldInvalid("name")),R("placeholder",o(9,22,"EnterInventoryName")),t(2),I(e.isFieldInvalid("name")?10:-1),t(3),d(" ",o(14,24,"Type")," "),t(4),N("is-invalid",e.isFieldInvalid("type")),t(2),v(o(20,26,"SelectType")),t(2),T(e.inventoryTypes),t(2),I(e.isFieldInvalid("type")?23:-1),t(3),d(" ",o(27,28,"EndDate")," "),t(2),N("is-invalid",e.isFieldInvalid("end_date")),t(),I(e.isFieldInvalid("end_date")?29:-1),t(3),d(" ",o(33,30,"Description")," "),t(2),N("is-invalid",e.isFieldInvalid("description")),R("placeholder",o(35,32,"EnterDescription")),t(2),I(e.isFieldInvalid("description")?36:-1)}}function Qt(l,m){l&1&&c(0,"i",12)}function Wt(l,m){l&1&&c(0,"i",13)}var Be=class l{constructor(m,e,p,s){this.formBuilder=m;this.inventoryService=e;this.activeModal=p;this.languageService=s}inventoryId;reload=new we;inventoryForm;loading$;isEdit=!1;inventoryDetail;inventoryTypes=[{value:"annual",label:"Annual"},{value:"half-yearly",label:"HalfYearly"},{value:"quarterly",label:"Quarterly"}];inventoryTypeEnum=Se;listInventoryTypeEnum=et;ngOnInit(){this.loading$=this.inventoryService.loading$,this.isEdit=!!this.inventoryId,this.initForm(),this.isEdit&&this.inventoryId&&this.loadInventoryDetail()}initForm(){this.inventoryForm=this.formBuilder.group({name:["",[K.required,K.minLength(3)]],type:["",K.required],description:[""],end_date:[""]})}loadInventoryDetail(){this.inventoryId&&this.inventoryService.getInventoryDetailFromServer(this.inventoryId).subscribe({next:m=>{this.inventoryDetail=m,this.patchForm(m)},error:m=>{console.error("Error loading inventory detail:",m)}})}patchForm(m){this.inventoryForm.patchValue({name:m.name,type:m.type,description:m.description,end_date:m.end_date?new Date(m.end_date).toISOString().split("T")[0]:""})}onSubmit(){if(this.inventoryForm.valid){let m=this.inventoryForm;(this.isEdit&&this.inventoryId?this.inventoryService.updateInventory(this.inventoryId,m):this.inventoryService.createInventory(m)).subscribe({next:p=>{p.success&&(this.reload.emit(!0),this.activeModal.close(!0))},error:p=>{console.error("Error submitting inventory:",p)}})}else this.markFormGroupTouched()}markFormGroupTouched(){Object.keys(this.inventoryForm.controls).forEach(m=>{this.inventoryForm.get(m)?.markAsTouched()})}isFieldInvalid(m){let e=this.inventoryForm.get(m);return!!(e&&e.invalid&&(e.dirty||e.touched))}getFieldError(m){let e=this.inventoryForm.get(m);if(e?.errors){if(e.errors.required)return this.languageService.instant("FieldRequired");if(e.errors.minlength)return`Minimum length is ${e.errors.minlength.requiredLength} characters`}return""}onCancel(){this.activeModal.dismiss(!1)}get modalTitle(){return this.isEdit?"EditInventory":"CreateInventory"}get submitButtonText(){return this.isEdit?"Update":"Create"}static \u0275fac=function(e){return new(e||l)(h(W),h(M),h(Ae),h(j))};static \u0275cmp=D({type:l,selectors:[["app-create-inventory"]],inputs:{inventoryId:"inventoryId"},outputs:{reload:"reload"},standalone:!1,decls:24,vars:18,consts:[[1,"modal-header"],["id","modal-title",1,"modal-title"],[1,"fas","fa-inventory","me-2"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"text-center","py-4"],[3,"formGroup"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-times","me-2"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"fas","fa-spinner","fa-spin","me-2"],[1,"fas","fa-save","me-2"],[1,"text-muted","mt-3"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-md-12","mb-3"],["for","name",1,"form-label"],[1,"text-danger"],["type","text","id","name","formControlName","name",1,"form-control",3,"placeholder"],[1,"invalid-feedback"],[1,"col-md-6","mb-3"],["for","type",1,"form-label"],["id","type","formControlName","type",1,"form-select"],["value",""],[3,"value"],["for","end_date",1,"form-label"],["type","date","id","end_date","formControlName","end_date",1,"form-control"],["for","description",1,"form-label"],["id","description","formControlName","description","rows","3",1,"form-control",3,"placeholder"]],template:function(e,p){e&1&&(n(0,"div",0)(1,"h4",1),c(2,"i",2),a(3),r(4,"translate"),i(),n(5,"button",3),y("click",function(){return p.onCancel()}),n(6,"span",4),a(7,"\xD7"),i()()(),n(8,"div",5),x(9,Rt,5,3,"div",6),r(10,"async"),x(11,Ht,37,34,"form",7),i(),n(12,"div",8)(13,"button",9),y("click",function(){return p.onCancel()}),c(14,"i",10),a(15),r(16,"translate"),i(),n(17,"button",11),r(18,"async"),y("click",function(){return p.onSubmit()}),x(19,Qt,1,0,"i",12),r(20,"async"),x(21,Wt,1,0,"i",13),a(22),r(23,"translate"),i()()),e&2&&(t(3),d(" ",o(4,6,p.modalTitle)," "),t(6),I(o(10,8,p.loading$)?9:11),t(6),d(" ",o(16,10,"Cancel")," "),t(2),b("disabled",p.inventoryForm.invalid||o(18,12,p.loading$)),t(2),I(o(20,14,p.loading$)?19:21),t(3),d(" ",o(23,16,p.submitButtonText)," "))},dependencies:[Oe,oe,le,H,re,Q,Te,Ve,Le,V,P,O],encapsulation:2})};var Yt=(l,m)=>m.id;function Kt(l,m){if(l&1){let e=B();n(0,"div",48)(1,"button",49),y("click",function(){_(e);let s=g();return f(s.closeScan())}),a(2),r(3,"translate"),i()()}l&2&&(t(2),d(" ",o(3,1,"close scan barcode")," "))}function Xt(l,m){if(l&1){let e=B();n(0,"div",48)(1,"button",49),y("click",function(){_(e);let s=g();return f(s.scanCodeBarre())}),c(2,"i",50),a(3),r(4,"translate"),i()()}l&2&&(t(3),d(" ",o(4,1,"scan a barcode")," "))}function Jt(l,m){if(l&1&&(n(0,"option",34),a(1),r(2,"titlecase"),r(3,"translate"),i()),l&2){let e=m.$implicit;b("value",e),t(),v(o(3,4,o(2,2,e)))}}function Zt(l,m){if(l&1&&(n(0,"option",34),a(1),i()),l&2){let e=m.$implicit;b("value",e),t(),v(e)}}function ei(l,m){l&1&&(n(0,"div",47),c(1,"app-custom-spinner"),n(2,"p",51),a(3),r(4,"translate"),i()()),l&2&&(t(3),d("",o(4,1,"LoadingInventories"),"..."))}function ti(l,m){if(l&1){let e=B();n(0,"div",47),c(1,"i",52),n(2,"h6",51),a(3),r(4,"translate"),i(),n(5,"p",53),a(6),r(7,"translate"),i(),n(8,"button",46),y("click",function(){_(e);let s=g(2);return f(s.createInventory())}),c(9,"i",20),a(10),r(11,"translate"),i()()}l&2&&(t(3),v(o(4,3,"NoInventoriesFound")),t(3),v(o(7,5,"CreateFirstInventory")),t(4),d("",o(11,7,"CreateInventory")," "))}function ii(l,m){if(l&1&&(n(0,"p",72),c(1,"i",84),a(2),r(3,"translate"),i()),l&2){let e=g().$implicit,p=g(3);t(2),w("",o(3,2,"EndDate"),": ",p.formatDate(e.end_date)," ")}}function ni(l,m){if(l&1){let e=B();n(0,"tr")(1,"td",65)(2,"div",66)(3,"div",67),c(4,"i",68),i(),n(5,"div",69)(6,"h6",70),a(7),i(),n(8,"p",71),a(9),r(10,"translate"),i()()()(),n(11,"td")(12,"span"),a(13),r(14,"titlecase"),r(15,"translate"),i()(),n(16,"td")(17,"p",71),a(18),i()(),n(19,"td")(20,"p",71),a(21),i(),x(22,ii,4,4,"p",72),i(),n(23,"td",73)(24,"div",74)(25,"button",75),c(26,"i",76),i(),n(27,"ul",18)(28,"li")(29,"a",19),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.viewDetails(s.id))}),c(30,"i",77),a(31),r(32,"translate"),i()(),n(33,"li")(34,"a",19),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.generateReport(s.id))}),c(35,"i",78),a(36),r(37,"translate"),i()(),n(38,"li")(39,"a",19),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.updateInventory(s.id))}),c(40,"i",79),a(41),r(42,"translate"),i()(),n(43,"li")(44,"a",80),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.closeInventory(s.id))}),c(45,"i",81),a(46),r(47,"translate"),i()(),n(48,"li"),c(49,"hr",21),i(),n(50,"li")(51,"a",82),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.deleteInventory(s.id))}),c(52,"i",83),a(53),r(54,"translate"),i()()()()()()}if(l&2){let e=m.$implicit,p=g(3);t(4),S(p.getTypeIcon(e.type)),t(3),v(e.name),t(2),Qe(" ",o(10,17,"CreatedBy"),": ",e.user.first_name," ",e.user.last_name," "),t(3),S(p.getTypeClass(e.type)),t(),d(" ",o(15,21,o(14,19,e.type))," "),t(5),d(" ",e.description||"N/A"," "),t(3),v(p.formatDate(e.created_at)),t(),I(e.end_date?22:-1),t(9),d("",o(32,23,"View")," "),t(5),d("",o(37,25,"GenerateReport")," "),t(5),d("",o(42,27,"Edit")," "),t(5),d("",o(47,29,"CloseInventory")," "),t(7),d("",o(54,31,"Delete")," ")}}function ai(l,m){if(l&1){let e=B();n(0,"div",54)(1,"table",55)(2,"thead")(3,"tr")(4,"th",56)(5,"a",57),y("click",function(){_(e);let s=g(2);return f(s.sortBy("name"))}),a(6),r(7,"translate"),c(8,"i"),i()(),n(9,"th",58)(10,"a",57),y("click",function(){_(e);let s=g(2);return f(s.sortBy("type"))}),a(11),r(12,"translate"),c(13,"i"),i()(),n(14,"th",58),a(15),r(16,"translate"),i(),n(17,"th",58)(18,"a",57),y("click",function(){_(e);let s=g(2);return f(s.sortBy("created_at"))}),a(19),r(20,"translate"),c(21,"i"),i()(),n(22,"th",59),a(23),r(24,"translate"),i()()(),n(25,"tbody"),F(26,ni,55,33,"tr",null,Yt),r(28,"async"),i()()(),n(29,"div",60)(30,"div",10)(31,"div",61)(32,"div",62)(33,"span",63),a(34),r(35,"translate"),r(36,"async"),r(37,"translate"),r(38,"async"),r(39,"translate"),r(40,"async"),r(41,"translate"),i()()(),n(42,"div",61)(43,"mat-paginator",64,1),y("page",function(s){_(e);let u=g(2);return f(u.pageChange(s))}),i()()()()}if(l&2){let e,p=g(2);t(6),d(" ",o(7,22,"Name")," "),t(2),S(p.getSortIcon("name")),t(3),d(" ",o(12,24,"Type")," "),t(2),S(p.getSortIcon("type")),t(2),d(" ",o(16,26,"Description")," "),t(4),d(" ",o(20,28,"CreatedAt")," "),t(2),S(p.getSortIcon("created_at")),t(2),d(" ",o(24,30,"Actions")," "),t(3),T(o(28,32,p.inventories$)),t(8),fe(" ",o(35,34,"Showing")," ",((e=o(36,36,p.paginateData$))==null?null:e.current_page)||0," ",o(37,38,"to")," ",((e=o(38,40,p.paginateData$))==null?null:e.per_page)||0," ",o(39,42,"of")," ",((e=o(40,44,p.paginateData$))==null?null:e.total)||0," ",o(41,46,"entries")," "),t(9),b("length",p.totaElement)("pageSize",p.itemsPerPage)("pageSizeOptions",p.pageArray)("showFirstLastButtons",!0)}}function ri(l,m){if(l&1&&(x(0,ti,12,9,"div",47),r(1,"async"),x(2,ai,45,48)),l&2){let e,p=g();I(((e=o(1,1,p.inventories$))==null?null:e.length)===0?0:2)}}var tt=class l extends z{constructor(e,p,s,u,E,C){super();this.languageService=e;this.inventoryService=p;this.modalService=s;this.router=u;this.formBuilder=E;this.route=C}loading$;itemsPerPage=10;paginateData$;paginateData;totaElement=0;pageEvent;pageArray=[];searchCtrl;typeCtrl;itemsPerPage$=new G(this.itemsPerPage);page$=new G(1);inventories$;barcodeScanner;isActiveScan=!1;inventoryTypeEnum=Se;listInventoryTypeEnum=et;currentSortBy="created_at";sortDirection="desc";startDate="";endDate="";ngOnInit(){console.log("init list-inventory"),this.loading$=this.inventoryService.loading$,this.searchCtrl=this.formBuilder.control(""),this.typeCtrl=this.formBuilder.control(""),this.inventories$=this.inventoryService.inventories$,this.inventoryService.getInventoriesFromServer({current_page:1,per_page:this.itemsPerPage}),this.inventories$.subscribe(e=>{this.isActiveScan&&e.length==1&&(this.isActiveScan=!1,this.barcodeScanner.stop(),this.inventoryService.setSnackMesage("Inventaire trouv\xE9 : "+e[0].id))}),this.initSearchFilter(),this.paginateData$=this.inventoryService.paginateData$,this.paginateData$.subscribe(e=>{this.paginateData=e,this.totaElement=e.total??0,this.generatePageArray()})}getInventorySearchOptions(e=[]){this.inventoryService.getInventoriesFromServer(this.paginateData,e)}initSearchFilter(){this.searchCtrl.valueChanges.pipe(ge(300),_e()).subscribe(()=>{this.applyFilters()}),this.typeCtrl.valueChanges.subscribe(()=>{this.applyFilters()})}createInventory(){let e=this.modalService.open(Be,{centered:!0,backdrop:"static",size:"lg"});var p;p=e.componentInstance.reload,p.subscribe(s=>{s&&this.applyFilters()})}updateInventory(e){let p=this.modalService.open(Be,{centered:!0,backdrop:"static",size:"lg"});p.componentInstance.inventoryId=e;var s;s=p.componentInstance.reload,s.subscribe(u=>{u&&this.applyFilters()})}viewDetails(e){this.router.navigate(["detail",e],{relativeTo:this.route})}generateReport(e){this.router.navigate(["report-inventory",e],{relativeTo:this.route})}deleteInventory(e){confirm(this.languageService.instant("ConfirmDelete"))&&this.inventoryService.deleteInventory(e).subscribe(()=>{this.applyFilters()})}closeInventory(e){this.inventoryService.closeInventory(e)}pageChange(e){return this.itemsPerPage=e.pageSize,this.paginateData.current_page=e.pageIndex+1,this.paginateData.per_page=this.itemsPerPage,this.applyFilters(),e}changeChoiceItemPage(){this.paginateData.per_page=this.itemsPerPage,this.paginateData.current_page=1,this.applyFilters()}applyFilters(){let e=[];this.searchCtrl.value&&this.searchCtrl.value.trim()!==""&&e.push(k("search",this.searchCtrl.value.trim())),this.typeCtrl.value&&this.typeCtrl.value!==""&&e.push(k("type",this.typeCtrl.value)),this.startDate&&e.push(k("start_date",this.startDate)),this.endDate&&e.push(k("end_date",this.endDate)),e.push(k("sort_by",this.currentSortBy)),e.push(k("sort_direction",this.sortDirection)),this.getInventorySearchOptions(e)}resetFilters(){this.searchCtrl.setValue(""),this.typeCtrl.setValue(""),this.startDate="",this.endDate="",this.currentSortBy="created_at",this.sortDirection="desc",this.paginateData.current_page=1,this.getInventorySearchOptions()}sortBy(e){this.currentSortBy===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.currentSortBy=e,this.sortDirection="asc"),this.applyFilters()}getSortIcon(e){return this.currentSortBy!==e?"fas fa-sort text-muted":this.sortDirection==="asc"?"fas fa-sort-up text-primary":"fas fa-sort-down text-primary"}formatDate(e){return new Date(e).toLocaleDateString()}getTypeIcon(e){switch(e){case"annual":return"fas fa-calendar-alt";case"half-yearly":return"fas fa-calendar";case"quarterly":return"fas fa-calendar-week";default:return"fas fa-list"}}getTypeClass(e){switch(e){case"annual":return"badge bg-gradient-primary";case"half-yearly":return"badge bg-gradient-info";case"quarterly":return"badge bg-gradient-warning";default:return"badge bg-gradient-secondary"}}generatePageArray(){this.pageArray=[];for(let e=5;e<=50;e+=5)this.pageArray.push(e)}onValueChanges(e){console.log("valueChanges :",e.codeResult.code),e.codeResult.code.length>8&&(console.log("valueChanges 2 : ",e.codeResult.code),this.searchCtrl.setValue(e.codeResult.code),this.applyFilters())}scanCodeBarre(){this.barcodeScanner&&typeof this.barcodeScanner.start=="function"&&(this.barcodeScanner.start(),this.isActiveScan=!0)}closeScan(){this.barcodeScanner.stop(),this.isActiveScan=!1}onStarted(e){console.log("started :",e)}static \u0275fac=function(p){return new(p||l)(h(j),h(M),h(Y),h(q),h(W),h(U))};static \u0275cmp=D({type:l,selectors:[["app-list-inventory"]],viewQuery:function(p,s){if(p&1&&Me(ie,5),p&2){let u;De(u=Fe())&&(s.barcodeScanner=u.first)}},standalone:!1,features:[ae],decls:113,vars:58,consts:[["barcodeScanner",""],["paginator",""],[1,"row","col-6"],["type","code_128",3,"valueChanges","started"],["class","col-lg-8 col-md-6 col-12",4,"ngIf"],[1,"container-fluid","py-4"],[1,"row"],[1,"col-12"],[1,"card","mb-4"],[1,"card-header","pb-0","bg-gradient-primary"],[1,"row","align-items-center"],[1,"col-lg-6","col-7"],[1,"mb-0","text-white"],[1,"text-sm","mb-0","text-white","opacity-8"],[1,"col-lg-6","col-5","my-auto","text-end"],[1,"dropdown","float-lg-end","pe-4"],["href","#","role","button","data-bs-toggle","dropdown",1,"btn","bg-gradient-light","mb-0","dropdown-toggle"],[1,"fas","fa-plus"],[1,"dropdown-menu"],[1,"dropdown-item",3,"click"],[1,"fas","fa-plus","me-2"],[1,"dropdown-divider"],["routerLink","missing-inventory",1,"dropdown-item"],[1,"fas","fa-exclamation-triangle","me-2"],[1,"fas","fa-filter","me-2"],[1,"card-body","px-0","pt-0","pb-2"],[1,"row","mt-3","px-3"],[1,"col-lg-3","col-md-6","col-12"],[1,"form-group","mb-0"],[1,"form-label","text-xs"],["type","text",1,"form-control",3,"formControl","placeholder"],[1,"col-lg-2","col-md-6","col-12"],[1,"form-select",3,"formControl"],["value",""],[3,"value"],[1,"form-select",3,"ngModelChange","change","ngModel"],["type","date",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-lg-1","col-md-6","col-12"],[1,"form-label","text-xs","opacity-0"],[1,"btn","btn-outline-secondary","btn-sm","w-100",3,"click","title"],[1,"fas","fa-undo"],[1,"card"],[1,"card-header","pb-0"],[1,"col-8"],[1,"mb-0"],[1,"col-4","text-end"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"text-center","py-4"],[1,"col-lg-8","col-md-6","col-12"],[1,"btn","btn-outline-info","btn-sm","mb-1","me-2",3,"click"],[1,"fas","fa-barcode","me-2"],[1,"text-muted","mt-3"],[1,"fas","fa-inventory","text-muted",2,"font-size","3rem"],[1,"text-sm","text-muted"],[1,"table-responsive","p-0"],[1,"table","align-items-center","mb-0"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","ps-2"],[1,"text-decoration-none","cursor-pointer",3,"click"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7"],[1,"card-footer"],[1,"col-sm-6"],[1,"dataTables_info"],[1,"text-sm","text-secondary"],["aria-label","Select page",3,"page","length","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"ps-2"],[1,"d-flex","px-2","py-1"],[1,"avatar","avatar-sm","bg-gradient-secondary","me-3"],[1,"text-white"],[1,"d-flex","flex-column","justify-content-center"],[1,"mb-0","text-sm"],[1,"text-xs","text-secondary","mb-0"],[1,"text-xs","text-warning","mb-0"],[1,"text-center"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-link","text-secondary","p-0","dropdown-toggle"],[1,"fas","fa-ellipsis-v"],[1,"fas","fa-eye","me-2"],[1,"fas","fa-file-pdf","me-2"],[1,"fas","fa-edit","me-2"],[1,"dropdown-item","text-warning",3,"click"],[1,"fas","fa-lock","me-2"],[1,"dropdown-item","text-danger",3,"click"],[1,"fas","fa-trash","me-2"],[1,"fas","fa-clock","me-1"]],template:function(p,s){if(p&1){let u=B();n(0,"app-base")(1,"div",2)(2,"barcode-scanner-livestream",3,0),y("valueChanges",function(C){return _(u),f(s.onValueChanges(C))})("started",function(){return _(u),f(s.onStarted(!0))}),i(),x(4,Kt,4,3,"div",4),i(),x(5,Xt,5,3,"div",4),n(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"h6",12),a(14),r(15,"translate"),i(),n(16,"p",13),a(17),r(18,"translate"),i()(),n(19,"div",14)(20,"div",15)(21,"a",16),c(22,"i",17),a(23),r(24,"translate"),i(),n(25,"ul",18)(26,"li")(27,"a",19),y("click",function(){return _(u),f(s.createInventory())}),c(28,"i",20),a(29),r(30,"translate"),i()(),n(31,"li"),c(32,"hr",21),i(),n(33,"li")(34,"a",22),c(35,"i",23),a(36),r(37,"translate"),i()(),n(38,"li"),c(39,"hr",21),i(),n(40,"li")(41,"a",19),y("click",function(){return _(u),f(s.resetFilters())}),c(42,"i",24),a(43),r(44,"translate"),i()()()()()()()()()(),n(45,"div",6)(46,"div",7)(47,"div",8)(48,"div",25)(49,"div",26)(50,"div",27)(51,"div",28)(52,"label",29),a(53),r(54,"translate"),i(),c(55,"input",30),r(56,"translate"),i()(),n(57,"div",31)(58,"div",28)(59,"label",29),a(60),r(61,"translate"),i(),n(62,"select",32)(63,"option",33),a(64),r(65,"translate"),i(),F(66,Jt,4,6,"option",34,Ce),i()()(),n(68,"div",31)(69,"div",28)(70,"label",29),a(71),r(72,"translate"),i(),n(73,"select",35),te("ngModelChange",function(C){return _(u),ee(s.itemsPerPage,C)||(s.itemsPerPage=C),f(C)}),y("change",function(){return _(u),f(s.changeChoiceItemPage())}),F(74,Zt,2,2,"option",34,Ce),i()()(),n(76,"div",31)(77,"div",28)(78,"label",29),a(79),r(80,"translate"),i(),n(81,"input",36),te("ngModelChange",function(C){return _(u),ee(s.startDate,C)||(s.startDate=C),f(C)}),y("change",function(){return _(u),f(s.applyFilters())}),i()()(),n(82,"div",31)(83,"div",28)(84,"label",29),a(85),r(86,"translate"),i(),n(87,"input",36),te("ngModelChange",function(C){return _(u),ee(s.endDate,C)||(s.endDate=C),f(C)}),y("change",function(){return _(u),f(s.applyFilters())}),i()()(),n(88,"div",37)(89,"div",28)(90,"label",38),a(91,"Action"),i(),n(92,"button",39),r(93,"translate"),y("click",function(){return _(u),f(s.resetFilters())}),c(94,"i",40),i()()()()()()()(),n(95,"div",6)(96,"div",7)(97,"div",41)(98,"div",42)(99,"div",10)(100,"div",43)(101,"h6",44),a(102),r(103,"translate"),i()(),n(104,"div",45)(105,"button",46),y("click",function(){return _(u),f(s.createInventory())}),c(106,"i",20),a(107),r(108,"translate"),i()()()(),n(109,"div",25),x(110,ei,5,3,"div",47),r(111,"async"),x(112,ri,3,3),i()()()()()()}p&2&&(t(4),b("ngIf",s.isActiveScan),t(),b("ngIf",!s.isActiveScan),t(9),v(o(15,24,"Inventories")),t(3),v(o(18,26,"ManageInventories")),t(6),d("\xA0\xA0",o(24,28,"Actions")," "),t(6),d("",o(30,30,"CreateInventory")," "),t(7),d("",o(37,32,"InventoryMissing")," "),t(7),d("",o(44,34,"ResetFilters")," "),t(10),v(o(54,36,"Search")),t(2),R("placeholder",o(56,38,"SearchInventories")),b("formControl",s.searchCtrl),t(5),v(o(61,40,"Type")),t(2),b("formControl",s.typeCtrl),t(2),v(o(65,42,"AllTypes")),t(2),T(s.listInventoryTypeEnum),t(5),v(o(72,44,"ItemsPerPage")),t(2),Z("ngModel",s.itemsPerPage),t(),T(s.pageArray),t(5),v(o(80,46,"DateFrom")),t(2),Z("ngModel",s.startDate),t(4),v(o(86,48,"DateTo")),t(2),Z("ngModel",s.endDate),t(5),R("title",o(93,50,"ResetFilters")),t(10),v(o(103,52,"InventoriesList")),t(5),d("",o(108,54,"Add")," "),t(3),I(o(111,56,s.loading$)?110:112))},dependencies:[ye,xe,z,oe,le,H,re,Q,Pe,Ie,V,be,ie,P,Ke,O],encapsulation:2})};var J=(e=>(e.PENDING="pending",e.TERMINATED="terminated",e))(J||{});function oi(l,m){l&1&&(n(0,"div",6),c(1,"app-custom-spinner"),n(2,"p",14),a(3),r(4,"translate"),i()()),l&2&&(t(3),d("",o(4,1,"Loading"),"..."))}function li(l,m){if(l&1&&(n(0,"div",21),a(1),i()),l&2){let e=g(2);t(),d(" ",e.getFieldError("office_id")," ")}}function si(l,m){if(l&1&&(n(0,"div")(1,"strong"),a(2),i(),c(3,"br"),n(4,"small",30),a(5),i()()),l&2){let e=m.item;t(2),v(e.name),t(3),w("",e.code," - ",e.mark,"")}}function pi(l,m){if(l&1&&(n(0,"div",21),a(1),i()),l&2){let e=g(2);t(),d(" ",e.getFieldError("immobilisation_id")," ")}}function mi(l,m){if(l&1&&(n(0,"div")(1,"strong"),a(2),i(),c(3,"br"),n(4,"small",30),a(5),r(6,"translate"),i()()),l&2){let e=m.item;t(2),v(e.name),t(3),v(o(6,2,e.type))}}function di(l,m){if(l&1&&(n(0,"div",21),a(1),i()),l&2){let e=g(2);t(),d(" ",e.getFieldError("inventory_id")," ")}}function ci(l,m){if(l&1&&(n(0,"div",21),a(1),i()),l&2){let e=g(2);t(),d(" ",e.getFieldError("comment")," ")}}function vi(l,m){if(l&1&&(n(0,"div",27)(1,"div",31)(2,"div",32),c(3,"i",33),n(4,"span"),a(5),r(6,"translate"),n(7,"strong"),a(8),r(9,"translate"),i()()()()()),l&2){let e,p,s,u=g(2);t(3),S(u.getStatusIcon((e=u.missingInventoryForm.get("status"))==null?null:e.value)),b("ngClass",u.getStatusClass((p=u.missingInventoryForm.get("status"))==null?null:p.value)),t(2),d(" ",o(6,5,"StatusSelected"),": "),t(3),v(o(9,7,(s=u.missingInventoryForm.get("status"))==null?null:s.value))}}function ui(l,m){if(l&1){let e=B();n(0,"form",15),y("ngSubmit",function(){_(e);let s=g();return f(s.onSubmit())}),n(1,"div",16)(2,"div",17)(3,"label",18),a(4),r(5,"translate"),n(6,"span",19),a(7,"*"),i()(),c(8,"ng-select",20),r(9,"async"),r(10,"translate"),x(11,li,2,1,"div",21),i(),n(12,"div",17)(13,"label",22),a(14),r(15,"translate"),n(16,"span",19),a(17,"*"),i()(),n(18,"ng-select",23),r(19,"async"),r(20,"translate"),x(21,si,6,3,"ng-template",24),i(),x(22,pi,2,1,"div",21),i(),n(23,"div",17)(24,"label",25),a(25),r(26,"translate"),n(27,"span",19),a(28,"*"),i()(),n(29,"ng-select",26),r(30,"async"),r(31,"translate"),x(32,mi,7,4,"ng-template",24),i(),x(33,di,2,1,"div",21),i(),n(34,"div",27)(35,"label",28),a(36),r(37,"translate"),i(),c(38,"textarea",29),r(39,"translate"),x(40,ci,2,1,"div",21),i(),x(41,vi,10,9,"div",27),i()()}if(l&2){let e,p=g();b("formGroup",p.missingInventoryForm),t(4),d(" ",o(5,31,"Office")," "),t(4),N("is-invalid",p.isFieldInvalid("office_id")),b("items",o(9,33,p.offices$))("clearable",!0)("searchable",!0)("placeholder",o(10,35,"SelectOffice")),t(3),I(p.isFieldInvalid("office_id")?11:-1),t(3),d(" ",o(15,37,"Immobilisation")," "),t(4),N("is-invalid",p.isFieldInvalid("immobilisation_id")),b("items",o(19,39,p.immobilisations$))("clearable",!0)("searchable",!0)("placeholder",o(20,41,"SelectImmobilisation")),t(4),I(p.isFieldInvalid("immobilisation_id")?22:-1),t(3),d(" ",o(26,43,"Inventory")," "),t(4),N("is-invalid",p.isFieldInvalid("inventory_id")),b("items",o(30,45,p.inventories$))("clearable",!0)("searchable",!0)("placeholder",o(31,47,"SelectInventory")),t(4),I(p.isFieldInvalid("inventory_id")?33:-1),t(3),d(" ",o(37,49,"Comment")," "),t(2),N("is-invalid",p.isFieldInvalid("comment")),R("placeholder",o(39,51,"CommentPlaceholder")),t(2),I(p.isFieldInvalid("comment")?40:-1),t(),I((e=p.missingInventoryForm.get("status"))!=null&&e.value?41:-1)}}function gi(l,m){l&1&&c(0,"i",12)}function _i(l,m){l&1&&c(0,"i",13)}var de=class l{constructor(m,e,p,s,u,E){this.formBuilder=m;this.inventoryService=e;this.languageService=p;this.activeModal=s;this.immoService=u;this.employeeService=E}reload=new we;missingInventoryId="";inventoryId=null;preSelectedOfficeId=null;preSelectedImmobilisationId=null;missingInventoryForm;isLoading=!1;isEditMode=!1;currentMissingInventory;inventories$;offices$;immobilisations$;confirmSubmit$;inventoryStatusEnum=J;statusOptions=[{value:"pending",label:"Pending"},{value:"terminated",label:"Terminated"}];ngOnInit(){this.isEditMode=!!this.missingInventoryId,this.initForm(),this.loadDropdownData(),this.isEditMode&&this.loadMissingInventoryData()}initForm(){this.confirmSubmit$=this.inventoryService.confirmSubmit$,this.confirmSubmit$.subscribe(m=>{m&&(this.activeModal.close(!0),this.reload.emit(!0))}),this.missingInventoryForm=this.formBuilder.group({office_id:["",[K.required]],immobilisation_id:["",[K.required]],inventory_id:["",[K.required]],comment:[""]})}loadDropdownData(){this.inventories$=this.inventoryService.getActiveInventoriesFromServer(),this.inventories$.subscribe(),this.offices$=this.employeeService.offices$,this.immobilisations$=this.immoService.immobilisations$,this.employeeService.getOfficesFullFromServer(),this.immoService.getImmoFullFromServer([k("assigned_employee",1)]),this.inventoryId&&this.missingInventoryForm.patchValue({inventory_id:this.inventoryId}),this.preSelectedOfficeId&&this.missingInventoryForm.patchValue({office_id:this.preSelectedOfficeId}),this.preSelectedImmobilisationId&&this.missingInventoryForm.patchValue({immobilisation_id:this.preSelectedImmobilisationId})}loadMissingInventoryData(){this.isLoading=!0,this.inventoryService.getMissingInventoryDetailFromServer(this.missingInventoryId).subscribe({next:m=>{this.currentMissingInventory=m,this.populateForm(m),this.isLoading=!1},error:m=>{console.error("Erreur lors du chargement des donn\xE9es:",m),this.isLoading=!1}})}populateForm(m){this.missingInventoryForm.patchValue({office_id:m.office_id,immobilisation_id:m.immobilisation_id,inventory_id:m.inventory_id,status:m.status,comment:m.comment||""})}onSubmit(){if(this.missingInventoryForm.valid){this.isLoading=!0;let m=this.missingInventoryForm.value;console.log("Form Data:",m);let e=this.isEditMode?this.inventoryService.updateMissingInventory(this.missingInventoryId,m):this.inventoryService.createMissingInventory(this.missingInventoryForm.value)}else this.markFormGroupTouched()}markFormGroupTouched(){Object.keys(this.missingInventoryForm.controls).forEach(m=>{this.missingInventoryForm.get(m)?.markAsTouched()})}isFieldInvalid(m){let e=this.missingInventoryForm.get(m);return!!(e&&e.invalid&&e.touched)}getFieldError(m){let e=this.missingInventoryForm.get(m);return e?.errors&&e.errors.required?this.languageService.instant("FieldRequired"):""}onCancel(){this.activeModal.dismiss("cancel")}getModalTitle(){return this.isEditMode?this.languageService.instant("EditMissingItem"):this.languageService.instant("AddMissingItem")}getSubmitButtonText(){return this.isEditMode?this.languageService.instant("Update"):this.languageService.instant("Create")}getStatusIcon(m){switch(m){case"pending":return"fas fa-clock";case"terminated":return"fas fa-check-circle";default:return"fas fa-question-circle"}}getStatusClass(m){switch(m){case"pending":return"text-warning";case"terminated":return"text-success";default:return"text-secondary"}}static \u0275fac=function(e){return new(e||l)(h(W),h(M),h(j),h(Ae),h($e),h(he))};static \u0275cmp=D({type:l,selectors:[["app-create-missing-inventory"]],inputs:{missingInventoryId:"missingInventoryId",inventoryId:"inventoryId",preSelectedOfficeId:"preSelectedOfficeId",preSelectedImmobilisationId:"preSelectedImmobilisationId"},outputs:{reload:"reload"},standalone:!1,decls:19,vars:8,consts:[[1,"modal-header"],["id","modal-title",1,"modal-title"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"text-center","py-4"],[3,"formGroup"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-times","me-2"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"fas","fa-spinner","fa-spin","me-2"],[1,"fas","fa-save","me-2"],[1,"text-muted","mt-3"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-md-6","mb-3"],["for","office_id",1,"form-label"],[1,"text-danger"],["bindLabel","name","bindValue","id","formControlName","office_id",3,"items","clearable","searchable","placeholder"],[1,"invalid-feedback"],["for","immobilisation_id",1,"form-label"],["bindLabel","name","bindValue","id","formControlName","immobilisation_id",3,"items","clearable","searchable","placeholder"],["ng-option-tmp",""],["for","inventory_id",1,"form-label"],["bindLabel","name","bindValue","id","formControlName","inventory_id",3,"items","clearable","searchable","placeholder"],[1,"col-md-12","mb-3"],["for","comment",1,"form-label"],["id","comment","formControlName","comment","rows","3",1,"form-control",3,"placeholder"],[1,"text-muted"],[1,"alert","alert-info"],[1,"d-flex","align-items-center"],[1,"me-2",3,"ngClass"]],template:function(e,p){e&1&&(n(0,"div",0)(1,"h4",1),c(2,"i",2),a(3),i(),n(4,"button",3),y("click",function(){return p.onCancel()}),n(5,"span",4),a(6,"\xD7"),i()()(),n(7,"div",5),x(8,oi,5,3,"div",6)(9,ui,42,53,"form",7),i(),n(10,"div",8)(11,"button",9),y("click",function(){return p.onCancel()}),c(12,"i",10),a(13),r(14,"translate"),i(),n(15,"button",11),y("click",function(){return p.onSubmit()}),x(16,gi,1,0,"i",12)(17,_i,1,0,"i",13),a(18),i()()),e&2&&(t(3),d(" ",p.getModalTitle()," "),t(5),I(p.isLoading?8:9),t(5),d(" ",o(14,6,"Cancel")," "),t(2),b("disabled",p.missingInventoryForm.invalid||p.isLoading),t(),I(p.isLoading?16:17),t(2),d(" ",p.getSubmitButtonText()," "))},dependencies:[Ye,Oe,H,Q,Te,Ve,Le,V,Re,Ne,P,O],encapsulation:2})};function fi(l,m){l&1&&(c(0,"i",11),a(1),r(2,"translate")),l&2&&(t(),d("",o(2,1,"EditBrokenItem")," "))}function yi(l,m){l&1&&(c(0,"i",12),a(1),r(2,"translate")),l&2&&(t(),d("",o(2,1,"CreateBrokenItem")," "))}function xi(l,m){l&1&&(n(0,"div",4),c(1,"app-custom-spinner"),n(2,"p",13),a(3),r(4,"translate"),i()()),l&2&&(t(3),d("",o(4,1,"LoadingData"),"..."))}function Ii(l,m){if(l&1&&(n(0,"div")(1,"strong"),a(2),i(),c(3,"br"),n(4,"small",27),a(5),i()()),l&2){let e=m.item;t(2),v(e.name),t(3),w("",e.code," - ",e.mark,"")}}function bi(l,m){if(l&1&&(n(0,"div",21),a(1),i()),l&2){let e=g(2);t(),d(" ",e.getFieldError("immobilisation_id")," ")}}function hi(l,m){if(l&1&&(n(0,"div")(1,"strong"),a(2),i(),c(3,"br"),n(4,"small",27),a(5),r(6,"translate"),i()()),l&2){let e=m.item;t(2),v(e.name),t(3),v(o(6,2,e.type))}}function Ci(l,m){if(l&1&&(n(0,"div",21),a(1),i()),l&2){let e=g(2);t(),d(" ",e.getFieldError("inventory_id")," ")}}function Si(l,m){if(l&1&&(n(0,"div",21),a(1),i()),l&2){let e=g(2);t(),d(" ",e.getFieldError("comment")," ")}}function Ei(l,m){if(l&1){let e=B();n(0,"form",14),y("ngSubmit",function(){_(e);let s=g();return f(s.onSubmit())}),n(1,"div",15)(2,"div",16)(3,"label",17),a(4),r(5,"translate"),n(6,"span",18),a(7,"*"),i()(),n(8,"ng-select",19),r(9,"async"),r(10,"translate"),x(11,Ii,6,3,"ng-template",20),i(),x(12,bi,2,1,"div",21),i(),n(13,"div",16)(14,"label",22),a(15),r(16,"translate"),n(17,"span",18),a(18,"*"),i()(),n(19,"ng-select",23),r(20,"async"),r(21,"translate"),x(22,hi,7,4,"ng-template",20),i(),x(23,Ci,2,1,"div",21),i(),n(24,"div",24)(25,"label",25),a(26),r(27,"translate"),n(28,"span",18),a(29,"*"),i()(),c(30,"textarea",26),r(31,"translate"),x(32,Si,2,1,"div",21),i()()()}if(l&2){let e=g();b("formGroup",e.brokenInventoryForm),t(4),d(" ",o(5,22,"Immobilisation")," "),t(4),N("is-invalid",e.isFieldInvalid("immobilisation_id")),b("items",o(9,24,e.immobilisations$))("clearable",!0)("searchable",!0)("placeholder",o(10,26,"SelectImmobilisation")),t(4),I(e.isFieldInvalid("immobilisation_id")?12:-1),t(3),d(" ",o(16,28,"Inventory")," "),t(4),N("is-invalid",e.isFieldInvalid("inventory_id")),b("items",o(20,30,e.inventories$))("clearable",!0)("searchable",!0)("placeholder",o(21,32,"SelectInventory")),t(4),I(e.isFieldInvalid("inventory_id")?23:-1),t(3),d(" ",o(27,34,"Comment")," "),t(4),N("is-invalid",e.isFieldInvalid("comment")),b("placeholder",o(31,36,"EnterComment")),t(2),I(e.isFieldInvalid("comment")?32:-1)}}function Bi(l,m){l&1&&c(0,"span",10)}function ki(l,m){l&1&&(c(0,"i",28),a(1),r(2,"translate")),l&2&&(t(),d("",o(2,1,"Update")," "))}function wi(l,m){l&1&&(c(0,"i",12),a(1),r(2,"translate")),l&2&&(t(),d("",o(2,1,"Create")," "))}function Mi(l,m){if(l&1&&x(0,ki,3,3)(1,wi,3,3),l&2){let e=g();I(e.isEditMode?0:1)}}var ce=class l{constructor(m,e,p,s,u){this.formBuilder=m;this.activeModal=e;this.inventoryService=p;this.employeeService=s;this.immoService=u}brokenInventoryId=null;isEditMode=!1;inventoryId=null;preSelectedImmobilisationId=null;reload=new we;brokenInventoryForm;loading$;inventories$;immobilisations$;inventoryStatusEnum=J;ngOnInit(){this.initializeForm(),this.loadData(),this.isEditMode&&this.brokenInventoryId&&this.loadBrokenInventoryData()}initializeForm(){this.brokenInventoryForm=this.formBuilder.group({immobilisation_id:["",[K.required]],inventory_id:["",[K.required]],comment:["",[K.required,K.minLength(3)]]})}loadData(){this.loading$=this.inventoryService.loading$,this.inventories$=this.inventoryService.getActiveInventoriesFromServer(),this.immobilisations$=this.immoService.immobilisations$,this.immoService.getImmoFullFromServer([k("assigned_employee",1)]),this.inventoryId&&this.brokenInventoryForm.patchValue({inventory_id:this.inventoryId}),this.preSelectedImmobilisationId&&this.brokenInventoryForm.patchValue({immobilisation_id:this.preSelectedImmobilisationId})}loadBrokenInventoryData(){this.brokenInventoryId&&this.inventoryService.getBrokenInventoryDetailFromServer(this.brokenInventoryId).subscribe({next:m=>{this.brokenInventoryForm.patchValue({immobilisation_id:m.immobilisation_id,inventory_id:m.inventory_id,status:m.status,comment:m.comment})},error:m=>{console.error("Error loading broken inventory data:",m),this.close()}})}onSubmit(){this.brokenInventoryForm.valid?(this.isEditMode&&this.brokenInventoryId?this.inventoryService.updateBrokenInventory(this.brokenInventoryId,this.brokenInventoryForm.value):this.inventoryService.createBrokenInventory(this.brokenInventoryForm.value),this.inventoryService.confirmSubmit$.subscribe(m=>{m&&(this.reload.emit(!0),this.activeModal.close(!0))})):this.markFormGroupTouched()}markFormGroupTouched(){Object.keys(this.brokenInventoryForm.controls).forEach(m=>{this.brokenInventoryForm.get(m)?.markAsTouched()})}isFieldInvalid(m){let e=this.brokenInventoryForm.get(m);return!!(e&&e.invalid&&(e.dirty||e.touched))}getFieldError(m){let e=this.brokenInventoryForm.get(m);if(e?.errors){if(e.errors.required)return`${m} is required`;if(e.errors.minlength)return`${m} must be at least ${e.errors.minlength.requiredLength} characters`}return""}close(){this.activeModal.close(!1)}dismiss(){this.activeModal.dismiss()}static \u0275fac=function(e){return new(e||l)(h(W),h(Ae),h(M),h(he),h($e))};static \u0275cmp=D({type:l,selectors:[["app-create-broken-inventory"]],inputs:{brokenInventoryId:"brokenInventoryId",isEditMode:"isEditMode",inventoryId:"inventoryId",preSelectedImmobilisationId:"preSelectedImmobilisationId"},outputs:{reload:"reload"},standalone:!1,decls:19,vars:13,consts:[[1,"modal-header","bg-gradient-primary"],["id","modal-title",1,"modal-title","text-white"],["type","button","aria-label","Close",1,"btn-close","btn-close-white",3,"click"],[1,"modal-body"],[1,"text-center","py-4"],[3,"formGroup"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-times","me-2"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["role","status",1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-edit","me-2"],[1,"fas","fa-plus","me-2"],[1,"text-muted","mt-3"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-md-6","mb-3"],["for","immobilisation_id",1,"form-label"],[1,"text-danger"],["bindLabel","name","bindValue","id","formControlName","immobilisation_id",3,"items","clearable","searchable","placeholder"],["ng-option-tmp",""],[1,"invalid-feedback"],["for","inventory_id",1,"form-label"],["bindLabel","name","bindValue","id","formControlName","inventory_id",3,"items","clearable","searchable","placeholder"],[1,"col-md-12","mb-3"],["for","comment",1,"form-label"],["formControlName","comment","rows","4",1,"form-control",3,"placeholder"],[1,"text-muted"],[1,"fas","fa-save","me-2"]],template:function(e,p){e&1&&(n(0,"div",0)(1,"h4",1),x(2,fi,3,3)(3,yi,3,3),i(),n(4,"button",2),y("click",function(){return p.dismiss()}),i()(),n(5,"div",3),x(6,xi,5,3,"div",4),r(7,"async"),x(8,Ei,33,38,"form",5),i(),n(9,"div",6)(10,"button",7),y("click",function(){return p.close()}),c(11,"i",8),a(12),r(13,"translate"),i(),n(14,"button",9),r(15,"async"),y("click",function(){return p.onSubmit()}),x(16,Bi,1,0,"span",10),r(17,"async"),x(18,Mi,2,1),i()()),e&2&&(t(2),I(p.isEditMode?2:3),t(4),I(o(7,5,p.loading$)?6:8),t(6),d("",o(13,7,"Cancel")," "),t(2),b("disabled",!p.brokenInventoryForm.valid||o(15,9,p.loading$)),t(2),I(o(17,11,p.loading$)?16:18))},dependencies:[Oe,H,Q,Te,Ve,Le,V,Re,Ne,P,O],encapsulation:2})};var Di=(l,m)=>m.id;function Fi(l,m){if(l&1&&(n(0,"option",38),a(1),r(2,"translate"),r(3,"translate"),i()),l&2){let e=m.$implicit;b("value",e),t(),d(" ",e===0?o(2,2,"GroundFloor"):o(3,4,"Floor")+" "+e," ")}}function Ti(l,m){if(l&1&&(n(0,"div")(1,"strong"),a(2),i(),c(3,"br"),n(4,"small",39),a(5),i()()),l&2){let e=m.item;t(2),v(e.name),t(3),v(e.num_office)}}function Pi(l,m){if(l&1&&(n(0,"div")(1,"strong"),a(2),i(),c(3,"br"),n(4,"small",39),a(5),i()()),l&2){let e=m.item;t(2),w("",e.first_name," ",e.last_name,""),t(3),w("",e.matricule," - ",e.fonction,"")}}function Oi(l,m){if(l&1&&(n(0,"option",38),a(1),r(2,"translate"),i()),l&2){let e=m.$implicit;b("value",e),t(),d(" ",o(2,2,e)," ")}}function Vi(l,m){l&1&&(n(0,"div",36)(1,"div",40)(2,"div",41)(3,"div",42),c(4,"app-custom-spinner"),n(5,"p",43),a(6),r(7,"translate"),i()()()()()),l&2&&(t(6),d("",o(7,1,"LoadingImmobilisations"),"..."))}function Li(l,m){if(l&1){let e=B();n(0,"label",58)(1,"input",59),y("change",function(s){_(e);let u=g(2);return f(u.toggleOfficeSelection(s))}),i(),c(2,"span"),a(3),r(4,"translate"),i()}if(l&2){let e=g(2);t(),b("checked",e.currentOffice.is_inventory),t(2),d(" ",o(4,2,"validate Inventory office")," ")}}function Ai(l,m){if(l&1&&(n(0,"div",75)(1,"div",82)(2,"div",83),a(3),i()(),n(4,"div",84)(5,"h6",85),a(6),i(),n(7,"p",64),a(8),i()()()),l&2){let e=g().$implicit;t(3),w(" ",e.employee_immo.employee.first_name.charAt(0),"",e.employee_immo.employee.last_name.charAt(0)," "),t(3),w("",e.employee_immo.employee.first_name," ",e.employee_immo.employee.last_name,""),t(2),v(e.employee_immo.employee.matricule)}}function $i(l,m){l&1&&(n(0,"span",67),c(1,"i",86),a(2),r(3,"translate"),i()),l&2&&(t(2),d("",o(3,1,"NotAssigned")," "))}function Ni(l,m){if(l&1){let e=B();n(0,"tr",60)(1,"td")(2,"div",61)(3,"div",62)(4,"h6",63),a(5),i(),n(6,"p",64),c(7,"i",65),a(8),i()()()(),n(9,"td",66)(10,"div",62)(11,"span",67),c(12,"i",68),a(13),i(),n(14,"span",67),c(15,"i",69),a(16),i(),n(17,"span",67),c(18,"i",70),a(19),i()()(),n(20,"td",71)(21,"span",72),a(22),i()(),n(23,"td",71)(24,"span",73),a(25),i()(),n(26,"td",71)(27,"span",74),a(28),r(29,"translate"),i()(),n(30,"td",71),x(31,Ai,9,5,"div",75)(32,$i,4,3,"span",67),i(),n(33,"td",71)(34,"span",73),a(35),r(36,"date"),i()(),n(37,"td",71)(38,"div",76)(39,"button",77),c(40,"i",78),i(),n(41,"ul",79)(42,"li")(43,"a",80),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.declareMissingForItem(s))}),c(44,"i",10),a(45),r(46,"translate"),i()(),n(47,"li")(48,"a",81),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.declareBrokenForItem(s))}),c(49,"i",12),a(50),r(51,"translate"),i()()()()()()}if(l&2){let e=m.$implicit,p=g(3);t(5),v(e.name),t(3),d("",e.code," "),t(5),d("",e.categorie.name," "),t(3),d("",e.structure.name," "),t(3),d("",e.fournisseur.raison_social," "),t(3),v(e.quantity),t(3),d(" ",p.formatCurrency(e.unit_price)," "),t(2),S(p.getStatusClass(e.status)),t(),d(" ",o(29,14,e.status)," "),t(3),I(e.employee_immo!=null&&e.employee_immo.employee?31:32),t(4),d(" ",ht(36,16,e.created_at,"dd/MM/yyyy")," "),t(10),d("",o(46,19,"DeclareMissing")," "),t(5),d("",o(51,21,"DeclareBroken")," ")}}function Ri(l,m){l&1&&F(0,Ni,52,23,"tr",60,Di),l&2&&T(m)}function ji(l,m){l&1&&(n(0,"tr")(1,"td",87)(2,"div",88),c(3,"i",89),n(4,"h6",90),a(5),r(6,"translate"),i(),n(7,"p",56),a(8),r(9,"translate"),i()()()()),l&2&&(t(5),v(o(6,2,"NoDataFound")),t(3),v(o(9,4,"NoImmobilisationsAvailable")))}function zi(l,m){if(l&1){let e=B();n(0,"div",37)(1,"div",14),x(2,Li,5,4,"label",44),n(3,"div",15)(4,"div",45)(5,"div",46)(6,"table",47)(7,"thead")(8,"tr")(9,"th",48),a(10),r(11,"translate"),i(),n(12,"th",49),a(13),r(14,"translate"),i(),n(15,"th",50),y("click",function(){_(e);let s=g();return f(s.sortBy("quantity"))}),a(16),r(17,"translate"),c(18,"i",51),i(),n(19,"th",50),y("click",function(){_(e);let s=g();return f(s.sortBy("unit_price"))}),a(20),r(21,"translate"),c(22,"i",51),i(),n(23,"th",50),y("click",function(){_(e);let s=g();return f(s.sortBy("status"))}),a(24),r(25,"translate"),c(26,"i",51),i(),n(27,"th",52),a(28),r(29,"translate"),i(),n(30,"th",50),y("click",function(){_(e);let s=g();return f(s.sortBy("created_at"))}),a(31),r(32,"translate"),c(33,"i",51),i(),n(34,"th",52),a(35),r(36,"translate"),i()()(),n(37,"tbody"),x(38,Ri,2,0),r(39,"async"),x(40,ji,10,6,"tr"),i()()(),n(41,"div",53)(42,"div",54)(43,"div",55)(44,"span",56),a(45),r(46,"translate"),r(47,"translate"),r(48,"translate"),r(49,"translate"),i()()(),n(50,"div",54)(51,"mat-paginator",57,0),y("page",function(s){_(e);let u=g();return f(u.pageEvent=u.pageChange(s))}),i()()()()()()()}if(l&2){let e,p=g();t(2),b("ngIf",p.currentOffice),t(8),d(" ",o(11,29,"Immobilisation")," "),t(3),d(" ",o(14,31,"Details")," "),t(3),d(" ",o(17,33,"Quantity")," "),t(2),S(p.getSortIcon("quantity")),t(2),d(" ",o(21,35,"Value")," "),t(2),S(p.getSortIcon("unit_price")),t(2),d(" ",o(25,37,"Status")," "),t(2),S(p.getSortIcon("status")),t(2),d(" ",o(29,39,"Employee")," "),t(3),d(" ",o(32,41,"CreatedAt")," "),t(2),S(p.getSortIcon("created_at")),t(2),d(" ",o(36,43,"Actions")," "),t(3),I((e=o(39,45,p.immobilisations$))?38:40,e),t(7),fe(" ",o(46,47,"Showing")," ",(p.paginateData.current_page-1)*p.paginateData.per_page+1," ",o(47,49,"to")," ",p.Math.min(p.paginateData.current_page*p.paginateData.per_page,p.totaElement)," ",o(48,51,"of")," ",p.totaElement," ",o(49,53,"entries")," "),t(6),b("length",p.totaElement)("pageSize",p.itemsPerPage)("pageSizeOptions",p.pageArray)("showFirstLastButtons",!0)}}var it=class l extends z{constructor(e,p,s,u,E){super();this.formBuilder=e;this.inventoryService=p;this.immoService=s;this.employeeService=u;this.modalService=E}inventoryId;loading$;immobilisations$;buildings$;offices$;employees$;currentOffice;dataOffices=[];paginateData$;paginateData;totaElement=0;pageEvent;pageArray=[];itemsPerPage=10;itemsPerPage$=new G(this.itemsPerPage);page$=new G(1);searchCtrl;buildingCtrl;floorCtrl;officeCtrl;employeeCtrl;statusCtrl;immobilisationStatusEnum=ct;immobilisationStatusOptions=Object.values(ct);Math=Math;floorOptions=[];currentSortBy="created_at";sortDirection="desc";ngOnInit(){this.initializeForm(),this.loadInitialData(),this.setupObservables(),this.initFilters()}initializeForm(){this.searchCtrl=this.formBuilder.control(""),this.buildingCtrl=this.formBuilder.control(""),this.floorCtrl=this.formBuilder.control(""),this.officeCtrl=this.formBuilder.control(""),this.employeeCtrl=this.formBuilder.control(""),this.statusCtrl=this.formBuilder.control("")}loadInitialData(){this.employeeService.getBuildingsFullFromServer(),this.loadImmobilisations()}toggleOfficeSelection(e){e.preventDefault(),console.log("Office selection toggled:",e.target.checked),this.currentOffice&&this.inventoryService.validateInventoryOffice(this.currentOffice.id,e.target.checked).subscribe(s=>{console.log("Office validation response:",s),this.currentOffice=s},s=>{console.error("Error validating office:",s)})}setupObservables(){this.loading$=this.immoService.loading$,this.immobilisations$=this.immoService.immobilisations$,this.buildings$=this.employeeService.buildings$,this.offices$=this.employeeService.offices$,this.offices$.subscribe(e=>{this.dataOffices=e}),this.employees$=this.employeeService.employees$,this.paginateData$=this.immoService.paginateData$,this.paginateData$.subscribe(e=>{this.paginateData=e,this.totaElement=e.total??0,this.generatePageArray()})}initFilters(){this.searchCtrl.valueChanges.pipe(ge(300),_e()).subscribe(()=>{this.applyFilters()}),this.buildingCtrl.valueChanges.subscribe(e=>{this.floorCtrl.setValue("",{emitEvent:!1}),this.officeCtrl.setValue("",{emitEvent:!1}),this.employeeCtrl.setValue("",{emitEvent:!1}),e?this.loadFloorsForBuilding(e):(this.floorOptions=[],this.employeeService.getOfficesFullFromServer([]),this.employeeService.getEmployeeFullFromServer([])),this.applyFilters()}),this.floorCtrl.valueChanges.subscribe(e=>{this.officeCtrl.setValue("",{emitEvent:!1}),this.employeeCtrl.setValue("",{emitEvent:!1});let p=this.buildingCtrl.value;p&&e!==null&&e!==void 0?(console.log(`Loading offices for building ${p} and floor ${e}`),this.loadOfficesForBuildingAndFloor(p,e)):(this.employeeService.getOfficesFullFromServer([]),this.employeeService.getEmployeeFullFromServer([])),this.applyFilters()}),this.officeCtrl.valueChanges.subscribe(e=>{this.employeeCtrl.setValue("",{emitEvent:!1}),e?this.loadEmployeesForOffice(e):this.employeeService.getEmployeeFullFromServer([]),this.currentOffice=this.dataOffices.find(p=>p.id===e),this.applyFilters()}),this.employeeCtrl.valueChanges.subscribe(()=>{this.applyFilters()}),this.statusCtrl.valueChanges.subscribe(()=>{this.applyFilters()})}loadFloorsForBuilding(e){this.employeeService.getBuildingDetailFromServer(e).subscribe(p=>{this.floorOptions=[];for(let s=0;s<=p.nb_etage;s++)this.floorOptions.push(s)})}loadOfficesForBuildingAndFloor(e,p){let s=[k("building_id",e),k("num_etage",p.toString())];this.employeeService.getOfficesFullFromServer(s)}loadEmployeesForOffice(e){let p=[k("office_id",e)];this.employeeService.getEmployeeFullFromServer(p)}loadImmobilisations(){this.immoService.getImmoFromServer({current_page:1,per_page:this.itemsPerPage},[k("assigned_employee",1)])}applyFilters(){let e=[];this.searchCtrl.value?.trim()&&e.push(k("search",this.searchCtrl.value.trim())),this.buildingCtrl.value&&e.push(k("building_id",this.buildingCtrl.value)),this.floorCtrl.value!==null&&this.floorCtrl.value!==""&&e.push(k("num_etage",this.floorCtrl.value.toString())),this.officeCtrl.value&&e.push(k("office_id",this.officeCtrl.value)),this.employeeCtrl.value&&e.push(k("employee_id",this.employeeCtrl.value)),this.statusCtrl.value&&e.push(k("status",this.statusCtrl.value)),e.push(k("assigned_employee",1)),this.immoService.getImmoFromServer(this.paginateData,e)}resetFilters(){this.searchCtrl.setValue("",{emitEvent:!1}),this.buildingCtrl.setValue("",{emitEvent:!1}),this.floorCtrl.setValue("",{emitEvent:!1}),this.officeCtrl.setValue("",{emitEvent:!1}),this.employeeCtrl.setValue("",{emitEvent:!1}),this.statusCtrl.setValue("",{emitEvent:!1}),this.floorOptions=[],this.employeeService.getOfficesFullFromServer([]),this.employeeService.getEmployeeFullFromServer([]),this.loadImmobilisations()}declareMissing(){let e=this.modalService.open(de,{centered:!0,backdrop:"static",size:"lg"});e.componentInstance.inventoryId=this.inventoryId,this.officeCtrl.value&&(e.componentInstance.preSelectedOfficeId=this.officeCtrl.value),e.componentInstance.reload.subscribe(p=>{p&&this.applyFilters()})}declareBroken(){let e=this.modalService.open(ce,{centered:!0,backdrop:"static",size:"lg"});e.componentInstance.inventoryId=this.inventoryId,e.componentInstance.reload.subscribe(p=>{p&&this.applyFilters()})}declareMissingForItem(e){let p=this.modalService.open(de,{centered:!0,backdrop:"static",size:"lg"});p.componentInstance.inventoryId=this.inventoryId,p.componentInstance.preSelectedImmobilisationId=e.id,this.officeCtrl.value&&(p.componentInstance.preSelectedOfficeId=this.officeCtrl.value),p.componentInstance.reload.subscribe(s=>{s&&this.applyFilters()})}declareBrokenForItem(e){let p=this.modalService.open(ce,{centered:!0,backdrop:"static",size:"lg"});p.componentInstance.inventoryId=this.inventoryId,p.componentInstance.preSelectedImmobilisationId=e.id,p.componentInstance.reload.subscribe(s=>{s&&this.applyFilters()})}pageChange(e){return this.itemsPerPage=e.pageSize,this.paginateData={current_page:e.pageIndex+1,per_page:this.itemsPerPage,total:this.totaElement},this.applyFilters(),e}generatePageArray(){let e=[];if(this.totaElement<=2)e.push(this.totaElement);else{for(let p=1;p<this.totaElement/2;p++)e.push(p*2);this.totaElement%2>0&&e.push(this.totaElement)}this.pageArray=e}sortBy(e){this.currentSortBy===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.currentSortBy=e,this.sortDirection="asc"),this.applyFilters()}getSortIcon(e){return this.currentSortBy!==e?"fas fa-sort":this.sortDirection==="asc"?"fas fa-sort-up":"fas fa-sort-down"}formatCurrency(e){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"CFA"}).format(e)}getStatusClass(e){switch(e){case"active":return"bg-gradient-success";case"broken":return"bg-gradient-danger";case"stock":return"bg-gradient-warning";case"created":return"bg-gradient-info";case"cession":return"bg-gradient-secondary";case"sale":return"bg-gradient-dark";default:return"bg-gradient-secondary"}}static \u0275fac=function(p){return new(p||l)(h(W),h(M),h($e),h(he),h(Y))};static \u0275cmp=D({type:l,selectors:[["app-manage-inventory"]],inputs:{inventoryId:"inventoryId"},standalone:!1,features:[ae],decls:89,vars:86,consts:[["paginator",""],[1,"row","mb-2"],[1,"col-lg-8","col-md-6","col-12"],[1,"d-flex","align-items-center"],[1,"mb-0","text-dark"],[1,"badge","bg-gradient-info","ms-2"],[1,"text-sm","text-secondary","mb-0"],[1,"col-lg-4","col-md-6","col-12","text-end"],["role","group",1,"btn-group"],[1,"btn","btn-warning","btn-sm","me-2",3,"click"],[1,"fas","fa-exclamation-triangle","me-2"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fas","fa-tools","me-2"],[1,"row","mb-1"],[1,"col-12"],[1,"card"],[1,"card-body","py-2","px-3"],[1,"row","align-items-end"],[1,"col-lg-2","col-md-4","col-12"],[1,"form-label","text-xs","mb-1"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text",1,"form-control",3,"placeholder","formControl"],["bindLabel","name","bindValue","id",3,"items","placeholder","formControl","clearable"],[1,"col-lg-1","col-md-4","col-12"],[1,"form-select",3,"formControl","disabled"],["value",""],[3,"value",4,"ngFor","ngForOf"],["bindLabel","name","bindValue","id",3,"items","placeholder","formControl","clearable","disabled"],["ng-option-tmp",""],["bindLabel","first_name","bindValue","id",3,"items","placeholder","formControl","clearable","disabled"],[1,"form-select",3,"formControl"],[1,"form-label","text-xs","mb-1","invisible"],[1,"btn","btn-outline-secondary","btn-sm","w-100","d-block",3,"click"],[1,"fas","fa-undo","me-1"],[1,"row","justify-content-center"],[1,"row"],[3,"value"],[1,"text-muted"],[1,"col-12","text-center"],[1,"card","shadow-lg"],[1,"card-body","py-5"],[1,"text-secondary","mt-3"],["class","custom-checkbox",4,"ngIf"],[1,"card-body","px-0","pt-0","pb-2"],[1,"table-responsive","p-0"],[1,"table","align-items-center","mb-0"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","ps-2"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","cursor-pointer",3,"click"],[1,"ms-1"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7"],[1,"row","mt-3"],[1,"col-sm-6"],[1,"d-flex","align-items-center","ps-3"],[1,"text-sm","text-secondary"],["aria-label","Select page",3,"page","length","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"custom-checkbox"],["type","checkbox","id","accept",3,"change","checked"],[1,"hover-row"],[1,"d-flex","px-2","py-1"],[1,"d-flex","flex-column","justify-content-center"],[1,"mb-0","text-sm"],[1,"text-xs","text-secondary","mb-0"],[1,"fas","fa-barcode","me-1"],[1,"ps-2"],[1,"text-xs","text-secondary"],[1,"fas","fa-layer-group","me-1"],[1,"fas","fa-building","me-1"],[1,"fas","fa-truck","me-1"],[1,"text-center"],[1,"badge","badge-sm","bg-gradient-info"],[1,"text-secondary","text-xs","font-weight-bold"],[1,"badge","badge-sm"],[1,"d-flex","align-items-center","justify-content-center"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-link","text-secondary","p-0","dropdown-toggle"],[1,"fas","fa-ellipsis-v"],[1,"dropdown-menu"],[1,"dropdown-item","text-warning",3,"click"],[1,"dropdown-item","text-danger",3,"click"],[1,"avatar","avatar-xs","me-2"],[1,"avatar-initial","rounded-circle","bg-gradient-success"],[1,"d-flex","flex-column"],[1,"mb-0","text-xs"],[1,"fas","fa-user-slash","me-1"],["colspan","8",1,"text-center","py-4"],[1,"d-flex","flex-column","align-items-center"],[1,"fas","fa-inbox","text-muted","mb-3",2,"font-size","3rem"],[1,"text-muted","mb-2"]],template:function(p,s){if(p&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"h5",4),a(4),r(5,"translate"),i(),n(6,"span",5),a(7),r(8,"async"),r(9,"translate"),i()(),n(10,"p",6),a(11),r(12,"translate"),i()(),n(13,"div",7)(14,"div",8)(15,"button",9),y("click",function(){return s.declareMissing()}),c(16,"i",10),a(17),r(18,"translate"),i(),n(19,"button",11),y("click",function(){return s.declareBroken()}),c(20,"i",12),a(21),r(22,"translate"),i()()()(),n(23,"div",13)(24,"div",14)(25,"div",15)(26,"div",16)(27,"div",17)(28,"div",18)(29,"label",19),a(30),r(31,"translate"),i(),n(32,"div",20)(33,"span",21),c(34,"i",22),i(),c(35,"input",23),r(36,"translate"),i()(),n(37,"div",18)(38,"label",19),a(39),r(40,"translate"),i(),c(41,"ng-select",24),r(42,"async"),r(43,"translate"),i(),n(44,"div",25)(45,"label",19),a(46),r(47,"translate"),i(),n(48,"select",26)(49,"option",27),a(50),r(51,"translate"),i(),x(52,Fi,4,6,"option",28),i()(),n(53,"div",18)(54,"label",19),a(55),r(56,"translate"),i(),n(57,"ng-select",29),r(58,"async"),r(59,"translate"),x(60,Ti,6,2,"ng-template",30),i()(),n(61,"div",18)(62,"label",19),a(63),r(64,"translate"),i(),n(65,"ng-select",31),r(66,"async"),r(67,"translate"),x(68,Pi,6,4,"ng-template",30),i()(),n(69,"div",18)(70,"label",19),a(71),r(72,"translate"),i(),n(73,"select",32)(74,"option",27),a(75),r(76,"translate"),i(),x(77,Oi,3,4,"option",28),i()(),n(78,"div",18)(79,"label",33),a(80,"Reset"),i(),n(81,"button",34),y("click",function(){return s.resetFilters()}),c(82,"i",35),a(83),r(84,"translate"),i()()()()()()(),x(85,Vi,8,3,"div",36),r(86,"async"),x(87,zi,53,55,"div",37),r(88,"async")),p&2){let u;t(4),v(o(5,38,"InventoryManagement")),t(3),w("",((u=o(8,40,s.immobilisations$))==null?null:u.length)||0," ",o(9,42,"items"),""),t(4),v(o(12,44,"ManageInventoryDescription")),t(6),d(" ",o(18,46,"DeclareMissing")," "),t(4),d(" ",o(22,48,"DeclareBroken")," "),t(9),v(o(31,50,"Search")),t(5),R("placeholder",o(36,52,"SearchByNameOrCode")),b("formControl",s.searchCtrl),t(4),v(o(40,54,"Building")),t(2),b("items",o(42,56,s.buildings$))("placeholder",o(43,58,"SelectBuilding"))("formControl",s.buildingCtrl)("clearable",!0),t(5),v(o(47,60,"Floor")),t(2),b("formControl",s.floorCtrl)("disabled",!s.buildingCtrl.value),t(2),v(o(51,62,"All")),t(2),b("ngForOf",s.floorOptions),t(3),v(o(56,64,"Office")),t(2),b("items",o(58,66,s.offices$))("placeholder",o(59,68,"SelectOffice"))("formControl",s.officeCtrl)("clearable",!0)("disabled",!s.floorCtrl.value&&s.floorCtrl.value!==0),t(6),v(o(64,70,"Employee")),t(2),b("items",o(66,72,s.employees$))("placeholder",o(67,74,"SelectEmployee"))("formControl",s.employeeCtrl)("clearable",!0)("disabled",!s.officeCtrl.value),t(6),v(o(72,76,"Status")),t(2),b("formControl",s.statusCtrl),t(2),v(o(76,78,"All")),t(2),b("ngForOf",s.immobilisationStatusOptions),t(6),d(" ",o(84,80,"Reset")," "),t(2),I(o(86,82,s.loading$)?85:-1),t(2),I(o(88,84,s.loading$)?-1:87)}},dependencies:[Ct,ye,oe,le,H,re,Q,Ie,V,Re,Ne,be,P,St,O],styles:["ver[_ngcontent-%COMP%]{background-color:#00000005;transition:background-color .3s ease}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.form-select[_ngcontent-%COMP%]:disabled{background-color:#f8f9fa;opacity:.65}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:.375rem;margin-left:.25rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:first-child{margin-left:0}.table[_ngcontent-%COMP%]   th.cursor-pointer[_ngcontent-%COMP%]:hover{background-color:#0000000d}.badge.badge-sm[_ngcontent-%COMP%]{font-size:.75rem}.dropdown-toggle[_ngcontent-%COMP%]:after{display:none}.input-group-text[_ngcontent-%COMP%]{background-color:#f8f9fa;border-color:#dee2e6}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#5e72e4;box-shadow:0 0 0 .2rem #5e72e440}ng-select.ng-select-focused[_ngcontent-%COMP%]   .ng-select-container[_ngcontent-%COMP%]{border-color:#5e72e4;box-shadow:0 0 0 .2rem #5e72e440}.manage-inventory[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border:none;box-shadow:0 .125rem .25rem #00000013;transition:box-shadow .3s ease}.manage-inventory[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{box-shadow:0 .25rem .5rem #0000001a}"]})};function Ui(l,m){l&1&&(n(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5),c(4,"app-custom-spinner"),n(5,"p",6),a(6),r(7,"translate"),i()()()()()),l&2&&(t(6),d("",o(7,1,"LoadingInventoryDetails"),"..."))}function qi(l,m){if(l&1&&(n(0,"div",25)(1,"div",8)(2,"div",31)(3,"label",32),c(4,"i",71),a(5),r(6,"translate"),i(),n(7,"p",34),a(8),i()()()()),l&2){let e=g(2);t(5),d("",o(6,2,"Description")," "),t(3),v(e.inventory.description)}}function Hi(l,m){if(l&1&&(n(0,"div",38)(1,"span",39),c(2,"i",72),i(),n(3,"div",41)(4,"h6",42),a(5),r(6,"translate"),i(),n(7,"p",43),a(8),i()()()),l&2){let e=g(2);t(5),v(o(6,2,"EndDate")),t(3),d(" ",e.formatDate(e.inventory.end_date)," ")}}function Qi(l,m){if(l&1&&(n(0,"p",62),a(1),r(2,"translate"),i()),l&2){let e=g(2);t(),w(" ",o(2,2,"EndsOn"),": ",e.formatDate(e.inventory.end_date)," ")}}function Wi(l,m){l&1&&(n(0,"p",62),a(1),r(2,"translate"),i()),l&2&&(t(),d(" ",o(2,1,"NoEndDate")," "))}function Yi(l,m){if(l&1){let e=B();n(0,"div",7)(1,"div",8)(2,"div",9)(3,"div",10)(4,"div",11)(5,"div",12)(6,"div",13)(7,"div",14),c(8,"i",15),i(),n(9,"div")(10,"h3",16),a(11),i(),n(12,"p",17),c(13,"i",18),a(14),r(15,"translate"),i()()()(),n(16,"div",19)(17,"div",20)(18,"span",21),c(19,"i",22),a(20),r(21,"titlecase"),r(22,"translate"),i(),n(23,"button",23),y("click",function(){_(e);let s=g();return f(s.goBack())}),c(24,"i",24),a(25),r(26,"translate"),i()()()()()()()(),n(27,"div",25)(28,"div",26)(29,"div",27)(30,"div",28)(31,"h6",16),c(32,"i",29),a(33),r(34,"translate"),i()(),n(35,"div",10)(36,"div",25)(37,"div",30)(38,"div",31)(39,"label",32),c(40,"i",33),a(41),r(42,"translate"),i(),n(43,"p",34),a(44),i()()(),n(45,"div",30)(46,"div",31)(47,"label",32),c(48,"i",35),a(49),r(50,"translate"),i(),n(51,"p",34)(52,"span"),a(53),r(54,"titlecase"),r(55,"translate"),i()()()()(),x(56,qi,9,4,"div",25),i()(),n(57,"div",27)(58,"div",28)(59,"h6",16),c(60,"i",36),a(61),r(62,"translate"),i()(),n(63,"div",10)(64,"div",37)(65,"div",38)(66,"span",39),c(67,"i",40),i(),n(68,"div",41)(69,"h6",42),a(70),r(71,"translate"),i(),n(72,"p",43),a(73),i()()(),n(74,"div",38)(75,"span",39),c(76,"i",44),i(),n(77,"div",41)(78,"h6",42),a(79),r(80,"translate"),i(),n(81,"p",43),a(82),i()()(),x(83,Hi,9,4,"div",38),i()()()(),n(84,"div",45)(85,"div",27)(86,"div",28)(87,"h6",16),c(88,"i",46),a(89),r(90,"translate"),i()(),n(91,"div",10)(92,"div",47)(93,"button",48),y("click",function(){_(e);let s=g();return f(s.editInventory())}),c(94,"i",49),a(95),r(96,"translate"),i(),n(97,"button",50),c(98,"i",51),a(99),r(100,"translate"),i(),n(101,"button",52),y("click",function(){_(e);let s=g();return f(s.closeInventory())}),c(102,"i",53),a(103),r(104,"translate"),i(),n(105,"button",54),y("click",function(){_(e);let s=g();return f(s.deleteInventory())}),c(106,"i",55),a(107),r(108,"translate"),i(),c(109,"hr",56),n(110,"button",57),y("click",function(){_(e);let s=g();return f(s.goBack())}),c(111,"i",24),a(112),r(113,"translate"),i()()()(),n(114,"div",27)(115,"div",28)(116,"h6",16),c(117,"i",58),a(118),r(119,"translate"),i()(),n(120,"div",10)(121,"div",59)(122,"div",60),c(123,"i",61),i(),n(124,"div")(125,"h6",16),a(126),i(),n(127,"p",62),a(128),i()()()()(),n(129,"div",27)(130,"div",28)(131,"h6",16),c(132,"i",63),a(133),r(134,"translate"),i()(),n(135,"div",64)(136,"div",65),c(137,"i",66),i(),n(138,"h6",67),a(139),r(140,"translate"),i(),x(141,Qi,3,4,"p",62)(142,Wi,3,3,"p",62),i()()()(),n(143,"div",25)(144,"div",8)(145,"div",27)(146,"div",28)(147,"h6",16),c(148,"i",68),a(149),r(150,"translate"),i()(),n(151,"div",69),c(152,"app-manage-inventory",70),i()()()()}if(l&2){let e=g();t(8),S(e.getTypeIcon(e.inventory.type)),t(3),v(e.inventory.name),t(2),S(e.getStatusIcon()),t(),d("",o(15,45,e.getStatusText())," "),t(4),S(e.getTypeClass(e.inventory.type)),t(),S(e.getTypeIcon(e.inventory.type)),t(),d(" ",o(22,49,o(21,47,e.inventory.type))," "),t(5),d("",o(26,51,"Back")," "),t(8),d(" ",o(34,53,"BasicInformation")," "),t(8),d("",o(42,55,"Name")," "),t(3),v(e.inventory.name),t(5),d("",o(50,57,"Type")," "),t(3),S(e.getTypeClass(e.inventory.type)),t(),d(" ",o(55,61,o(54,59,e.inventory.type))," "),t(3),I(e.inventory.description?56:-1),t(5),d(" ",o(62,63,"Timeline")," "),t(9),v(o(71,65,"Created")),t(3),d(" ",e.formatDateTime(e.inventory.created_at)," "),t(6),v(o(80,67,"LastUpdated")),t(3),d(" ",e.formatDateTime(e.inventory.updated_at)," "),t(),I(e.inventory.end_date?83:-1),t(6),d(" ",o(90,69,"Actions")," "),t(6),d("",o(96,71,"EditInventory")," "),t(2),It("routerLink","/admin/inventories/report-inventory/",e.inventory.id,""),t(2),d("",o(100,73,"GenerateReport")," "),t(4),d("",o(104,75,"CloseInventory")," "),t(4),d("",o(108,77,"DeleteInventory")," "),t(5),d("",o(113,79,"BackToList")," "),t(6),d(" ",o(119,81,"CreatedBy")," "),t(8),w("",e.inventory.user.first_name," ",e.inventory.user.last_name,""),t(2),v(e.inventory.user.email),t(5),d(" ",o(134,83,"Status")," "),t(4),S(e.getStatusIcon()),t(2),v(o(140,85,e.getStatusText())),t(2),I(e.inventory.end_date?141:142),t(8),d(" ",o(150,87,"ManageInventory")," "),t(3),b("inventoryId",e.inventory.id)}}function Ki(l,m){if(l&1){let e=B();n(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5),c(4,"i",73),n(5,"h3",6),a(6),r(7,"translate"),i(),n(8,"p",74),a(9),r(10,"translate"),i(),n(11,"button",48),y("click",function(){_(e);let s=g();return f(s.goBack())}),c(12,"i",24),a(13),r(14,"translate"),i()()()()()}l&2&&(t(6),v(o(7,3,"InventoryNotFound")),t(3),v(o(10,5,"InventoryNotFoundDescription")),t(4),d("",o(14,7,"BackToList")," "))}var nt=class l{constructor(m,e,p,s,u){this.route=m;this.router=e;this.inventoryService=p;this.languageService=s;this.modalService=u;this.loading$=this.inventoryService.loading$}destroy$=new _t;inventory=null;loading$;inventoryId=null;ngOnInit(){this.inventoryId=this.route.snapshot.paramMap.get("id"),this.inventoryId&&this.loadInventoryDetail()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadInventoryDetail(){this.inventoryId&&this.inventoryService.getInventoryDetailFromServer(this.inventoryId).pipe(ft(this.destroy$)).subscribe({next:m=>{this.inventory=m},error:m=>{console.error("Error loading inventory detail:",m)}})}goBack(){window.history.back()}editInventory(){if(this.inventoryId){let m=this.modalService.open(Be,{centered:!0,backdrop:"static",size:"lg"});m.componentInstance.inventoryId=this.inventoryId,m.componentInstance.reload.subscribe(e=>{e&&this.loadInventoryDetail()})}}deleteInventory(){this.inventoryId&&this.inventory&&confirm(this.languageService.instant("ConfirmDelete"))&&this.inventoryService.deleteInventory(this.inventoryId).subscribe({next:()=>{this.goBack()},error:m=>{console.error("Error deleting inventory:",m)}})}closeInventory(){this.inventoryId&&this.inventory&&this.inventoryService.closeInventory(this.inventoryId)}generateReport(){this.inventoryId&&this.router.navigate(["/inventory/report-inventory",this.inventoryId])}formatDate(m){return new Date(m).toLocaleDateString()}formatDateTime(m){return new Date(m).toLocaleString()}getTypeIcon(m){switch(m){case"annual":return"fas fa-calendar-alt";case"half-yearly":return"fas fa-calendar";case"quarterly":return"fas fa-calendar-week";default:return"fas fa-list"}}getTypeClass(m){switch(m){case"annual":return"badge bg-gradient-primary";case"half-yearly":return"badge bg-gradient-info";case"quarterly":return"badge bg-gradient-warning";default:return"badge bg-gradient-secondary"}}isInventoryActive(){return!this.inventory||!this.inventory.end_date?!0:new Date(this.inventory.end_date)>new Date}getStatusIcon(){return this.isInventoryActive()?"fas fa-check-circle text-success":"fas fa-times-circle text-danger"}getStatusText(){return this.isInventoryActive()?"Active":"Expired"}static \u0275fac=function(e){return new(e||l)(h(U),h(q),h(M),h(j),h(Y))};static \u0275cmp=D({type:l,selectors:[["app-detail-inventory"]],standalone:!1,decls:8,vars:9,consts:[[1,"main-content","position-relative","max-height-vh-100","h-100","detail-inventory"],[1,"container-fluid","py-4"],[1,"row","justify-content-center"],[1,"col-12","text-center"],[1,"card","shadow-lg"],[1,"card-body","py-5"],[1,"text-secondary","mt-3"],[1,"row","mb-4"],[1,"col-12"],[1,"card","bg-gradient-primary","shadow-lg","border-0"],[1,"card-body","p-4"],[1,"row","align-items-center"],[1,"col-md-8"],[1,"d-flex","align-items-center","text-white"],[1,"icon","icon-shape","icon-lg","bg-white","shadow","text-center","me-3"],[1,"text-primary"],[1,"mb-0"],[1,"text-sm","opacity-8","mb-0"],[1,"me-2"],[1,"col-md-4","text-end"],[1,"d-flex","justify-content-end","align-items-center"],[1,"me-3"],[1,"me-1"],[1,"btn","btn-outline-light","btn-sm",3,"click"],[1,"fas","fa-arrow-left","me-2"],[1,"row"],[1,"col-lg-8"],[1,"card","shadow-lg","mb-4"],[1,"card-header","bg-gradient-light","p-4"],[1,"fas","fa-info-circle","me-2","text-primary"],[1,"col-md-6"],[1,"info-item","mb-3"],[1,"form-label","text-sm","text-secondary","mb-1"],[1,"fas","fa-tag","me-2"],[1,"text-dark","font-weight-600","mb-0"],[1,"fas","fa-layer-group","me-2"],[1,"fas","fa-history","me-2","text-primary"],[1,"timeline","timeline-one-side"],[1,"timeline-block","mb-3"],[1,"timeline-step"],[1,"fas","fa-plus","text-success"],[1,"timeline-content"],[1,"text-dark","text-sm","font-weight-bold","mb-0"],[1,"text-secondary","text-xs","mt-1","mb-0"],[1,"fas","fa-edit","text-warning"],[1,"col-lg-4"],[1,"fas","fa-cogs","me-2","text-primary"],[1,"d-grid","gap-3"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-edit","me-2"],[1,"btn","btn-info",3,"routerLink"],[1,"fas","fa-file-pdf","me-2"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-lock","me-2"],[1,"btn","btn-outline-danger",3,"click"],[1,"fas","fa-trash","me-2"],[1,"my-2"],[1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-user","me-2","text-primary"],[1,"d-flex","align-items-center"],[1,"avatar","avatar-lg","bg-gradient-secondary","me-3"],[1,"fas","fa-user","text-white"],[1,"text-sm","text-secondary","mb-0"],[1,"fas","fa-chart-line","me-2","text-primary"],[1,"card-body","p-4","text-center"],[1,"mb-3"],[2,"font-size","2rem"],[1,"mb-2"],[1,"fas","fa-tasks","me-2","text-primary"],[1,"card-body","p-0"],[3,"inventoryId"],[1,"fas","fa-file-alt","me-2"],[1,"fas","fa-calendar-times","text-danger"],[1,"fas","fa-exclamation-triangle","text-warning",2,"font-size","3rem"],[1,"text-muted","mb-4"]],template:function(e,p){e&1&&(n(0,"div",0)(1,"div",1),x(2,Ui,8,3,"div",2),r(3,"async"),x(4,Yi,153,89),r(5,"async"),x(6,Ki,15,9,"div",2),r(7,"async"),i()()),e&2&&(t(2),I(o(3,3,p.loading$)?2:-1),t(2),I(!o(5,5,p.loading$)&&p.inventory?4:-1),t(2),I(!o(7,7,p.loading$)&&!p.inventory?6:-1))},dependencies:[xe,V,it,P,Ke,O],encapsulation:2})};var At=(l,m)=>m.id;function Xi(l,m){if(l&1){let e=B();n(0,"div",51)(1,"button",52),y("click",function(){_(e);let s=g();return f(s.closeScan())}),a(2),r(3,"translate"),i()()}l&2&&(t(2),d(" ",o(3,1,"close scan barcode")," "))}function Ji(l,m){if(l&1){let e=B();n(0,"div",51)(1,"button",52),y("click",function(){_(e);let s=g();return f(s.scanCodeBarre())}),c(2,"i",53),a(3),r(4,"translate"),i()()}l&2&&(t(3),d(" ",o(4,1,"scan a barcode")," "))}function Zi(l,m){if(l&1&&(n(0,"option",33),a(1),i()),l&2){let e=m.$implicit;b("value",e.id),t(),w("",e.name," - ",e.building.name,"")}}function en(l,m){if(l&1&&(n(0,"option",33),a(1),i()),l&2){let e=m.$implicit;b("value",e.id),t(),v(e.name)}}function tn(l,m){if(l&1&&(n(0,"option",33),a(1),i()),l&2){let e=m.$implicit;b("value",e),t(),v(e)}}function nn(l,m){l&1&&(n(0,"div",50),c(1,"app-custom-spinner"),n(2,"p",54),a(3),r(4,"translate"),i()()),l&2&&(t(3),d("",o(4,1,"LoadingMissingItems"),"..."))}function an(l,m){if(l&1){let e=B();n(0,"div",50),c(1,"i",56),n(2,"h6",54),a(3),r(4,"translate"),i(),n(5,"p",57),a(6),r(7,"translate"),i(),n(8,"button",49),y("click",function(){_(e);let s=g(2);return f(s.createMissingInventory())}),c(9,"i",19),a(10),r(11,"translate"),i()()}l&2&&(t(3),v(o(4,3,"NoMissingItemsFound")),t(3),v(o(7,5,"CreateFirstMissingItem")),t(4),d("",o(11,7,"AddMissingItem")," "))}function rn(l,m){if(l&1&&(n(0,"div",76)(1,"div",81)(2,"div",93),a(3),i()(),n(4,"div",83)(5,"h6",84),a(6),i(),n(7,"p",69),a(8),i()()()),l&2){let e=g().$implicit;t(3),w(" ",e.immobilisation.employee_immo.employee.first_name.charAt(0),"",e.immobilisation.employee_immo.employee.last_name.charAt(0)," "),t(3),w("",e.immobilisation.employee_immo.employee.first_name," ",e.immobilisation.employee_immo.employee.last_name,""),t(2),v(e.immobilisation.employee_immo.employee.matricule)}}function on(l,m){l&1&&(n(0,"span",77),c(1,"i",94),a(2),r(3,"translate"),i()),l&2&&(t(2),d("",o(3,1,"NotAssigned")," "))}function ln(l,m){l&1&&(n(0,"span"),a(1,"..."),i())}function sn(l,m){if(l&1){let e=B();n(0,"tr")(1,"td")(2,"div",64)(3,"div")(4,"div",65),c(5,"i",66),i()(),n(6,"div",67)(7,"h6",68),a(8),i(),n(9,"p",69),a(10),i()()()(),n(11,"td")(12,"div",64)(13,"div")(14,"div",70),c(15,"i",71),i()(),n(16,"div",67)(17,"h6",68),a(18),i(),n(19,"p",69),a(20),i()()()(),n(21,"td")(22,"div",64)(23,"div")(24,"div",72),c(25,"i",73),i()(),n(26,"div",67)(27,"h6",68),a(28),i(),n(29,"p",69),a(30),r(31,"translate"),i()()()(),n(32,"td",74)(33,"span"),c(34,"i",75),a(35),r(36,"translate"),i()(),n(37,"td"),x(38,rn,9,5,"div",76)(39,on,4,3,"span",77),i(),n(40,"td")(41,"p",78),a(42),r(43,"slice"),x(44,ln,2,0,"span"),i()(),n(45,"td",79)(46,"div",80)(47,"div",81)(48,"div",82),a(49),i()(),n(50,"div",83)(51,"h6",84),a(52),i(),n(53,"span",85),a(54),i()()()(),n(55,"td",79)(56,"div",86)(57,"button",87),c(58,"i",88),i(),n(59,"ul",17)(60,"li")(61,"a",18),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.viewDetails(s.id))}),c(62,"i",89),a(63),r(64,"translate"),i()(),n(65,"li")(66,"a",18),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.updateMissingInventory(s.id))}),c(67,"i",90),a(68),r(69,"translate"),i()(),n(70,"li"),c(71,"hr",20),i(),n(72,"li")(73,"a",91),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.deleteMissingInventory(s.id))}),c(74,"i",92),a(75),r(76,"translate"),i()()()()()()}if(l&2){let e=m.$implicit,p=g(3);t(8),v(e.office.name),t(2),v(e.office.building.name),t(8),v(e.immobilisation.name),t(2),v(e.immobilisation.code),t(8),v(e.inventory.name),t(2),v(o(31,22,e.inventory.type)),t(3),S(p.getStatusClass(e.status)),t(),S(p.getStatusIcon(e.status)),t(),d(" ",o(36,24,e.status)," "),t(3),I(e.immobilisation.employee_immo!=null&&e.immobilisation.employee_immo.employee?38:39),t(3),b("title",e.comment),t(),d(" ",We(43,26,e.comment,0,50)," "),t(2),I(e.comment&&e.comment.length>50?44:-1),t(5),w(" ",e.user.first_name.charAt(0),"",e.user.last_name.charAt(0)," "),t(3),v(e.user.first_name),t(2),v(p.formatDate(e.created_at)),t(9),d(" ",o(64,30,"View")," "),t(5),d(" ",o(69,32,"Edit")," "),t(7),d(" ",o(76,34,"Delete")," ")}}function pn(l,m){if(l&1){let e=B();n(0,"div",55)(1,"table",58)(2,"thead")(3,"tr")(4,"th",59)(5,"a",60),y("click",function(){_(e);let s=g(2);return f(s.sortBy("office.name"))}),a(6),r(7,"translate"),c(8,"i"),i()(),n(9,"th",61)(10,"a",60),y("click",function(){_(e);let s=g(2);return f(s.sortBy("immobilisation.name"))}),a(11),r(12,"translate"),c(13,"i"),i()(),n(14,"th",61)(15,"a",60),y("click",function(){_(e);let s=g(2);return f(s.sortBy("inventory.name"))}),a(16),r(17,"translate"),c(18,"i"),i()(),n(19,"th",62)(20,"a",60),y("click",function(){_(e);let s=g(2);return f(s.sortBy("status"))}),a(21),r(22,"translate"),c(23,"i"),i()(),n(24,"th",61),a(25),r(26,"translate"),i(),n(27,"th",61),a(28),r(29,"translate"),i(),n(30,"th",62)(31,"a",60),y("click",function(){_(e);let s=g(2);return f(s.sortBy("created_at"))}),a(32),r(33,"translate"),c(34,"i"),i()(),n(35,"th",63),a(36),r(37,"translate"),i()()(),n(38,"tbody"),F(39,sn,77,36,"tr",null,He().trackByFn,!0),r(41,"async"),i()()()}if(l&2){let e=g(2);t(6),d(" ",o(7,18,"Office")," "),t(2),S(e.getSortIcon("office.name")),t(3),d(" ",o(12,20,"Immobilisation")," "),t(2),S(e.getSortIcon("immobilisation.name")),t(3),d(" ",o(17,22,"Inventory")," "),t(2),S(e.getSortIcon("inventory.name")),t(3),d(" ",o(22,24,"Status")," "),t(2),S(e.getSortIcon("status")),t(2),d(" ",o(26,26,"Employee")," "),t(3),d(" ",o(29,28,"Comment")," "),t(4),d(" ",o(33,30,"CreatedBy")," "),t(2),S(e.getSortIcon("created_at")),t(2),v(o(37,32,"Actions")),t(3),T(o(41,34,e.missingInventories$))}}function mn(l,m){if(l&1&&(x(0,an,12,9,"div",50),r(1,"async"),x(2,pn,42,36,"div",55)),l&2){let e,p=g();I(((e=o(1,1,p.missingInventories$))==null?null:e.length)===0?0:2)}}function dn(l,m){if(l&1){let e=B();n(0,"div",5)(1,"div",6)(2,"div",44)(3,"div",95)(4,"div",96)(5,"div",97),a(6),r(7,"translate"),r(8,"translate"),r(9,"translate"),r(10,"translate"),i(),n(11,"mat-paginator",98),y("page",function(s){_(e);let u=g();return f(u.pageChange(s))}),i()()()()()()}if(l&2){let e=g();t(6),fe(" ",o(7,11,"Showing")," ",(e.paginateData.current_page-1)*e.paginateData.per_page+1," ",o(8,13,"to")," ",e.Math.min(e.paginateData.current_page*e.paginateData.per_page,e.totaElement)," ",o(9,15,"of")," ",e.totaElement," ",o(10,17,"entries")," "),t(5),b("length",e.totaElement)("pageSize",e.itemsPerPage)("pageSizeOptions",e.pageArray)("pageIndex",e.paginateData.current_page-1)}}var at=class l extends z{constructor(e,p,s,u,E,C,oa){super();this.languageService=e;this.inventoryService=p;this.modalService=s;this.router=u;this.formBuilder=E;this.route=C;this.employeeService=oa}loading$;itemsPerPage=10;paginateData$;paginateData;totaElement=0;pageEvent;pageArray=[];searchCtrl;statusCtrl;inventoryCtrl;officeCtrl;itemsPerPage$=new G(this.itemsPerPage);page$=new G(1);missingInventories$;barcodeScanner;isActiveScan=!1;offices$;inventories$;inventoryStatusEnum=J;currentSortBy="created_at";sortDirection="desc";startDate="";endDate="";ngOnInit(){console.log("init list-missing-inventory"),this.loading$=this.inventoryService.loading$,this.searchCtrl=this.formBuilder.control(""),this.statusCtrl=this.formBuilder.control(""),this.inventoryCtrl=this.formBuilder.control(""),this.officeCtrl=this.formBuilder.control(""),this.missingInventories$=this.inventoryService.missingInventories$,this.inventoryService.getMissingInventoriesFromServer({current_page:1,per_page:this.itemsPerPage}),this.missingInventories$.subscribe(e=>{this.isActiveScan&&e.length==1&&(this.isActiveScan=!1,this.barcodeScanner.stop(),this.inventoryService.setSnackMesage("Inventaire manquant trouv\xE9 : "+e[0].id))}),this.offices$=this.employeeService.offices$,this.employeeService.getOfficesFullFromServer(),this.inventories$=this.inventoryService.inventories$,this.inventoryService.getInventoriesFromServer(),this.initSearchFilter(),this.paginateData$=this.inventoryService.paginateData$,this.paginateData$.subscribe(e=>{this.paginateData=e,this.totaElement=e.total??0,this.generatePageArray()})}getMissingInventorySearchOptions(e=[]){this.inventoryService.getMissingInventoriesFromServer(this.paginateData,e)}initSearchFilter(){this.searchCtrl.valueChanges.pipe(ge(300),_e()).subscribe(()=>{this.applyFilters()}),this.statusCtrl.valueChanges.subscribe(()=>{this.applyFilters()}),this.inventoryCtrl.valueChanges.subscribe(()=>{this.applyFilters()}),this.officeCtrl.valueChanges.subscribe(()=>{this.applyFilters()})}createMissingInventory(){let e=this.modalService.open(de,{centered:!0,backdrop:"static",size:"lg"});var p;p=e.componentInstance.reload,p.subscribe(s=>{s&&this.applyFilters()})}updateMissingInventory(e){let p=this.modalService.open(de,{centered:!0,backdrop:"static",size:"lg"});p.componentInstance.missingInventoryId=e;var s;s=p.componentInstance.reload,s.subscribe(u=>{u&&this.applyFilters()})}viewDetails(e){this.router.navigate(["detail",e],{relativeTo:this.route})}deleteMissingInventory(e){confirm(this.languageService.instant("ConfirmDelete"))&&this.inventoryService.deleteMissingInventory(e).subscribe(()=>{this.applyFilters()})}pageChange(e){return this.itemsPerPage=e.pageSize,this.paginateData.current_page=e.pageIndex+1,this.paginateData.per_page=this.itemsPerPage,this.applyFilters(),e}changeChoiceItemPage(){this.paginateData.per_page=this.itemsPerPage,this.paginateData.current_page=1,this.applyFilters()}applyFilters(){let e=[];this.searchCtrl.value&&this.searchCtrl.value.trim()!==""&&e.push(k("search",this.searchCtrl.value.trim())),this.statusCtrl.value&&this.statusCtrl.value!==""&&e.push(k("status",this.statusCtrl.value)),this.inventoryCtrl.value&&this.inventoryCtrl.value!==""&&e.push(k("inventory_id",this.inventoryCtrl.value)),this.officeCtrl.value&&this.officeCtrl.value!==""&&e.push(k("office_id",this.officeCtrl.value)),this.startDate&&e.push(k("start_date",this.startDate)),this.endDate&&e.push(k("end_date",this.endDate)),e.push(k("sort_by",this.currentSortBy)),e.push(k("sort_direction",this.sortDirection)),this.getMissingInventorySearchOptions(e)}resetFilters(){this.searchCtrl.setValue(""),this.statusCtrl.setValue(""),this.inventoryCtrl.setValue(""),this.officeCtrl.setValue(""),this.startDate="",this.endDate="",this.currentSortBy="created_at",this.sortDirection="desc",this.paginateData.current_page=1,this.getMissingInventorySearchOptions()}sortBy(e){this.currentSortBy===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.currentSortBy=e,this.sortDirection="asc"),this.applyFilters()}getSortIcon(e){return this.currentSortBy!==e?"fas fa-sort text-muted":this.sortDirection==="asc"?"fas fa-sort-up text-primary":"fas fa-sort-down text-primary"}formatDate(e){return new Date(e).toLocaleDateString()}getStatusIcon(e){switch(e){case"pending":return"fas fa-clock";case"terminated":return"fas fa-check-circle";default:return"fas fa-question-circle"}}getStatusClass(e){switch(e){case"pending":return"badge bg-gradient-warning";case"terminated":return"badge bg-gradient-success";default:return"badge bg-gradient-secondary"}}generatePageArray(){this.pageArray=[];for(let e=5;e<=50;e+=5)this.pageArray.push(e)}trackByFn(e,p){return p.id}get Math(){return Math}onValueChanges(e){console.log("valueChanges :",e.codeResult.code),e.codeResult.code.length>8&&(console.log("valueChanges 2 : ",e.codeResult.code),this.searchCtrl.setValue(e.codeResult.code),this.applyFilters())}scanCodeBarre(){this.barcodeScanner&&typeof this.barcodeScanner.start=="function"&&(this.barcodeScanner.start(),this.isActiveScan=!0)}closeScan(){this.barcodeScanner.stop(),this.isActiveScan=!1}onStarted(e){console.log("started :",e)}static \u0275fac=function(p){return new(p||l)(h(j),h(M),h(Y),h(q),h(W),h(U),h(he))};static \u0275cmp=D({type:l,selectors:[["app-list-missing-inventory"]],viewQuery:function(p,s){if(p&1&&Me(ie,5),p&2){let u;De(u=Fe())&&(s.barcodeScanner=u.first)}},standalone:!1,features:[ae],decls:145,vars:87,consts:[["barcodeScanner",""],[1,"row","col-6"],["type","code_128",3,"valueChanges","started"],["class","col-lg-8 col-md-6 col-12",4,"ngIf"],[1,"container-fluid","py-4"],[1,"row"],[1,"col-12"],[1,"card","mb-4"],[1,"card-header","pb-0","bg-gradient-primary"],[1,"row","align-items-center"],[1,"col-lg-6","col-7"],[1,"mb-0","text-white"],[1,"text-sm","mb-0","text-white","opacity-8"],[1,"col-lg-6","col-5","my-auto","text-end"],[1,"dropdown","float-lg-end","pe-4"],["href","#","role","button","data-bs-toggle","dropdown",1,"btn","bg-gradient-light","mb-0","dropdown-toggle"],[1,"fas","fa-plus"],[1,"dropdown-menu"],[1,"dropdown-item",3,"click"],[1,"fas","fa-plus","me-2"],[1,"dropdown-divider"],["routerLink","../",1,"dropdown-item"],[1,"fas","fa-clipboard-list","me-2"],[1,"fas","fa-filter","me-2"],[1,"card-body","px-0","pt-0","pb-2"],[1,"row","mt-3","px-3"],[1,"col-lg-4","col-md-6","col-12"],[1,"form-group","mb-3"],[1,"form-label","text-xs"],["type","text",1,"form-control",3,"formControl","placeholder"],[1,"col-lg-2","col-md-6","col-12"],[1,"form-select",3,"formControl"],["value",""],[3,"value"],[1,"col-lg-3","col-md-6","col-12"],[1,"form-select",3,"ngModelChange","change","ngModel"],[1,"col-lg-1","col-md-6","col-12"],[1,"form-label","text-xs","opacity-0"],[1,"btn","btn-outline-secondary","btn-sm","w-100",3,"click","title"],[1,"fas","fa-undo"],[1,"row","px-3"],[1,"form-group","mb-0"],["type","date",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-lg-6"],[1,"card"],[1,"card-header","pb-0"],[1,"col-8"],[1,"mb-0"],[1,"col-4","text-end"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"text-center","py-4"],[1,"col-lg-8","col-md-6","col-12"],[1,"btn","btn-outline-info","btn-sm","mb-1","me-2",3,"click"],[1,"fas","fa-barcode","me-2"],[1,"text-muted","mt-3"],[1,"table-responsive","p-0"],[1,"fas","fa-exclamation-triangle","text-muted",2,"font-size","3rem"],[1,"text-sm","text-muted"],[1,"table","align-items-center","mb-0"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","ps-2"],[1,"text-decoration-none","cursor-pointer",3,"click"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","text-center"],[1,"text-secondary","opacity-7","text-center"],[1,"d-flex","px-2","py-1"],[1,"avatar","avatar-sm","me-3","bg-gradient-secondary"],[1,"fas","fa-building","text-white"],[1,"d-flex","flex-column","justify-content-center"],[1,"mb-0","text-sm"],[1,"text-xs","text-secondary","mb-0"],[1,"avatar","avatar-sm","me-3","bg-gradient-info"],[1,"fas","fa-cube","text-white"],[1,"avatar","avatar-sm","me-3","bg-gradient-primary"],[1,"fas","fa-clipboard-list","text-white"],[1,"align-middle","text-center","text-sm"],[1,"me-1"],[1,"d-flex","align-items-center"],[1,"text-xs","text-secondary"],[1,"text-xs","font-weight-bold","mb-0",3,"title"],[1,"align-middle","text-center"],[1,"d-flex","align-items-center","justify-content-center"],[1,"avatar","avatar-xs","me-2"],[1,"avatar-initial","rounded-circle","bg-gradient-primary"],[1,"d-flex","flex-column"],[1,"mb-0","text-xs"],[1,"text-secondary","text-xs"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-link","text-secondary","mb-0"],[1,"fa","fa-ellipsis-v","text-xs"],[1,"fas","fa-eye","me-2"],[1,"fas","fa-edit","me-2"],[1,"dropdown-item","text-danger",3,"click"],[1,"fas","fa-trash","me-2"],[1,"avatar-initial","rounded-circle","bg-gradient-success"],[1,"fas","fa-user-slash","me-1"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-center"],[1,"text-muted"],["showFirstLastButtons","",3,"page","length","pageSize","pageSizeOptions","pageIndex"]],template:function(p,s){if(p&1){let u=B();n(0,"app-base")(1,"div",1)(2,"barcode-scanner-livestream",2,0),y("valueChanges",function(C){return _(u),f(s.onValueChanges(C))})("started",function(){return _(u),f(s.onStarted(!0))}),i(),x(4,Xi,4,3,"div",3),i(),x(5,Ji,5,3,"div",3),n(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"h6",11),a(14),r(15,"translate"),i(),n(16,"p",12),a(17),r(18,"translate"),i()(),n(19,"div",13)(20,"div",14)(21,"a",15),c(22,"i",16),a(23),r(24,"translate"),i(),n(25,"ul",17)(26,"li")(27,"a",18),y("click",function(){return _(u),f(s.createMissingInventory())}),c(28,"i",19),a(29),r(30,"translate"),i()(),n(31,"li"),c(32,"hr",20),i(),n(33,"li")(34,"a",21),c(35,"i",22),a(36),r(37,"translate"),i()(),n(38,"li"),c(39,"hr",20),i(),n(40,"li")(41,"a",18),y("click",function(){return _(u),f(s.resetFilters())}),c(42,"i",23),a(43),r(44,"translate"),i()()()()()()()()()(),n(45,"div",5)(46,"div",6)(47,"div",7)(48,"div",24)(49,"div",25)(50,"div",26)(51,"div",27)(52,"label",28),a(53),r(54,"translate"),i(),c(55,"input",29),r(56,"translate"),i()(),n(57,"div",30)(58,"div",27)(59,"label",28),a(60),r(61,"translate"),i(),n(62,"select",31)(63,"option",32),a(64),r(65,"translate"),i(),n(66,"option",33),a(67),r(68,"translate"),i(),n(69,"option",33),a(70),r(71,"translate"),i()()()(),n(72,"div",34)(73,"div",27)(74,"label",28),a(75),r(76,"translate"),i(),n(77,"select",31)(78,"option",32),a(79),r(80,"translate"),i(),F(81,Zi,2,3,"option",33,At),r(83,"async"),i()()(),n(84,"div",30)(85,"div",27)(86,"label",28),a(87),r(88,"translate"),i(),n(89,"select",31)(90,"option",32),a(91),r(92,"translate"),i(),F(93,en,2,2,"option",33,At),r(95,"async"),i()()(),n(96,"div",30)(97,"div",27)(98,"label",28),a(99),r(100,"translate"),i(),n(101,"select",35),te("ngModelChange",function(C){return _(u),ee(s.itemsPerPage,C)||(s.itemsPerPage=C),f(C)}),y("change",function(){return _(u),f(s.changeChoiceItemPage())}),F(102,tn,2,2,"option",33,Ce),i()()(),n(104,"div",36)(105,"div",27)(106,"label",37),a(107,"Action"),i(),n(108,"button",38),r(109,"translate"),y("click",function(){return _(u),f(s.resetFilters())}),c(110,"i",39),i()()()(),n(111,"div",40)(112,"div",34)(113,"div",41)(114,"label",28),a(115),r(116,"translate"),i(),n(117,"input",42),te("ngModelChange",function(C){return _(u),ee(s.startDate,C)||(s.startDate=C),f(C)}),y("change",function(){return _(u),f(s.applyFilters())}),i()()(),n(118,"div",34)(119,"div",41)(120,"label",28),a(121),r(122,"translate"),i(),n(123,"input",42),te("ngModelChange",function(C){return _(u),ee(s.endDate,C)||(s.endDate=C),f(C)}),y("change",function(){return _(u),f(s.applyFilters())}),i()()(),c(124,"div",43),i()()()()(),n(125,"div",5)(126,"div",6)(127,"div",44)(128,"div",45)(129,"div",9)(130,"div",46)(131,"h6",47),a(132),r(133,"translate"),i()(),n(134,"div",48)(135,"button",49),y("click",function(){return _(u),f(s.createMissingInventory())}),c(136,"i",19),a(137),r(138,"translate"),i()()()(),n(139,"div",24),x(140,nn,5,3,"div",50),r(141,"async"),x(142,mn,3,3),i()()()(),x(143,dn,12,19,"div",5),r(144,"async"),i()()}if(p&2){let u;t(4),b("ngIf",s.isActiveScan),t(),b("ngIf",!s.isActiveScan),t(9),v(o(15,35,"InventoryMissing")),t(3),v(o(18,37,"ManageMissingItems")),t(6),d("\xA0\xA0",o(24,39,"Actions")," "),t(6),d("",o(30,41,"AddMissingItem")," "),t(7),d("",o(37,43,"BackToInventories")," "),t(7),d("",o(44,45,"ResetFilters")," "),t(10),v(o(54,47,"Search")),t(2),R("placeholder",o(56,49,"SearchMissingItems")),b("formControl",s.searchCtrl),t(5),v(o(61,51,"Status")),t(2),b("formControl",s.statusCtrl),t(2),v(o(65,53,"AllStatuses")),t(2),b("value",s.inventoryStatusEnum.PENDING),t(),v(o(68,55,"Pending")),t(2),b("value",s.inventoryStatusEnum.TERMINATED),t(),v(o(71,57,"Terminated")),t(5),v(o(76,59,"Office")),t(2),b("formControl",s.officeCtrl),t(2),v(o(80,61,"SelectOffice")),t(2),T(o(83,63,s.offices$)),t(6),v(o(88,65,"Inventory")),t(2),b("formControl",s.inventoryCtrl),t(2),v(o(92,67,"AllInventories")),t(2),T(o(95,69,s.inventories$)),t(6),v(o(100,71,"ItemsPerPage")),t(2),Z("ngModel",s.itemsPerPage),t(),T(s.pageArray),t(6),R("title",o(109,73,"ResetFilters")),t(7),v(o(116,75,"DateFrom")),t(2),Z("ngModel",s.startDate),t(4),v(o(122,77,"DateTo")),t(2),Z("ngModel",s.endDate),t(9),v(o(133,79,"MissingItemsList")),t(5),d("",o(138,81,"Add")," "),t(3),I(o(141,83,s.loading$)?140:142),t(3),I((u=o(144,85,s.missingInventories$))!=null&&u.length&&s.totaElement>0?143:-1)}},dependencies:[ye,xe,z,oe,le,H,re,Q,Pe,Ie,V,be,ie,P,Xe,O],encapsulation:2})};function cn(l,m){l&1&&(n(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5),c(4,"app-custom-spinner"),n(5,"p",6),a(6),r(7,"translate"),i()()()()()),l&2&&(t(6),d("",o(7,1,"LoadingMissingItemDetails"),"..."))}function vn(l,m){if(l&1&&(n(0,"div",26)(1,"div",8)(2,"div",32)(3,"label",33),c(4,"i",64),a(5),r(6,"translate"),i(),n(7,"p",35),a(8),i()()()()),l&2){let e=g();t(5),d("",o(6,2,"Comment")," "),t(3),v(e.comment)}}function un(l,m){if(l&1&&(n(0,"div",42)(1,"span",43),c(2,"i",65),i(),n(3,"div",45)(4,"h6",46),a(5),r(6,"translate"),i(),n(7,"p",47),a(8),i(),n(9,"p",48),a(10),r(11,"translate"),i()()()),l&2){let e=g(),p=g(2);t(5),v(o(6,3,"Updated")),t(3),d(" ",p.formatDateTime(e.updated_at)," "),t(2),v(o(11,5,"MissingItemUpdated"))}}function gn(l,m){if(l&1){let e=B();n(0,"button",66),y("click",function(){_(e);let s=g(3);return f(s.editMissingInventory())}),c(1,"i",67),a(2),r(3,"translate"),i()}l&2&&(t(2),d(" ",o(3,1,"Edit")," "))}function _n(l,m){if(l&1){let e=B();n(0,"button",68),y("click",function(){_(e);let s=g(3);return f(s.deleteMissingInventory())}),c(1,"i",69),a(2),r(3,"translate"),i()}l&2&&(t(2),d(" ",o(3,1,"Delete")," "))}function fn(l,m){l&1&&(n(0,"span"),a(1),r(2,"translate"),i()),l&2&&(t(),v(o(2,1,"StatusPendingDescription")))}function yn(l,m){l&1&&(n(0,"span"),a(1),r(2,"translate"),i()),l&2&&(t(),v(o(2,1,"StatusTerminatedDescription")))}function xn(l,m){if(l&1){let e=B();n(0,"div",7)(1,"div",8)(2,"div",9)(3,"div",10)(4,"div",11)(5,"div",12)(6,"div",13)(7,"div",14),c(8,"i",15),i(),n(9,"div")(10,"h3",16),a(11),r(12,"translate"),i(),n(13,"p",17),c(14,"i",18),a(15),c(16,"i",19),a(17),i()()()(),n(18,"div",20)(19,"div",21)(20,"span",22),c(21,"i",23),a(22),r(23,"translate"),i(),n(24,"button",24),y("click",function(){_(e);let s=g(2);return f(s.goBack())}),c(25,"i",25),a(26),r(27,"translate"),i()()()()()()()(),n(28,"div",26)(29,"div",27)(30,"div",28)(31,"div",29)(32,"h6",16),c(33,"i",30),a(34),r(35,"translate"),i()(),n(36,"div",10)(37,"div",26)(38,"div",31)(39,"div",32)(40,"label",33),c(41,"i",34),a(42),r(43,"translate"),i(),n(44,"p",35),a(45),i(),n(46,"small",36),a(47),i()()(),n(48,"div",31)(49,"div",32)(50,"label",33),c(51,"i",37),a(52),r(53,"translate"),i(),n(54,"p",35),a(55),i(),n(56,"small",36),a(57),i()()()(),n(58,"div",26)(59,"div",31)(60,"div",32)(61,"label",33),c(62,"i",38),a(63),r(64,"translate"),i(),n(65,"p",35),a(66),i(),n(67,"small",36),a(68),r(69,"translate"),i()()(),n(70,"div",31)(71,"div",32)(72,"label",33),c(73,"i",39),a(74),r(75,"translate"),i(),n(76,"p",35)(77,"span"),a(78),r(79,"translate"),i()()()()(),x(80,vn,9,4,"div",26),i()(),n(81,"div",28)(82,"div",29)(83,"h6",16),c(84,"i",40),a(85),r(86,"translate"),i()(),n(87,"div",10)(88,"div",41)(89,"div",42)(90,"span",43),c(91,"i",44),i(),n(92,"div",45)(93,"h6",46),a(94),r(95,"translate"),i(),n(96,"p",47),a(97),i(),n(98,"p",48),a(99),r(100,"translate"),i()()(),x(101,un,12,7,"div",42),i()()()(),n(102,"div",49)(103,"div",28)(104,"div",29)(105,"h6",16),c(106,"i",50),a(107),r(108,"translate"),i()(),n(109,"div",10)(110,"div",51),x(111,gn,4,3,"button",52)(112,_n,4,3,"button",53),i()()(),n(113,"div",54)(114,"div",55)(115,"h6",56),c(116,"i",39),a(117),r(118,"translate"),i()(),n(119,"div",10)(120,"div",57)(121,"div",58)(122,"span",59),c(123,"i",39),a(124),r(125,"translate"),i()(),n(126,"div",36)(127,"small"),a(128),r(129,"translate"),x(130,fn,3,3,"span")(131,yn,3,3,"span"),i()()()()(),n(132,"div",4)(133,"div",29)(134,"h6",16),c(135,"i",30),a(136),r(137,"translate"),i()(),n(138,"div",10)(139,"div",32)(140,"label",33),c(141,"i",60),a(142,"ID "),i(),n(143,"p",35)(144,"code"),a(145),i()()(),n(146,"div",32)(147,"label",33),c(148,"i",61),a(149),r(150,"translate"),i(),n(151,"p",35),a(152),i()(),n(153,"div",62)(154,"label",33),c(155,"i",63),a(156),r(157,"translate"),i(),n(158,"p",35),a(159),i()()()()()()}if(l&2){let e=m,p=g(2);t(8),S(p.getStatusIcon(e.status)),t(3),v(o(12,54,"MissingInventoryDetails")),t(4),d("",e.office.name," - "),t(2),d("",e.immobilisation.name," "),t(3),S(p.getStatusClass(e.status)),t(),S(p.getStatusIcon(e.status)),t(),d(" ",o(23,56,e.status)," "),t(4),d("",o(27,58,"Back")," "),t(8),d(" ",o(35,60,"BasicInformation")," "),t(8),d("",o(43,62,"Office")," "),t(3),v(e.office.name),t(2),v(e.office.building.name),t(5),d("",o(53,64,"Immobilisation")," "),t(3),v(e.immobilisation.name),t(2),v(e.immobilisation.code),t(6),d("",o(64,66,"Inventory")," "),t(3),v(e.inventory.name),t(2),v(o(69,68,e.inventory.type)),t(5),S(p.getStatusIcon(e.status)),t(),d("",o(75,70,"Status")," "),t(3),S(p.getStatusClass(e.status)),t(),d(" ",o(79,72,e.status)," "),t(2),I(e.comment?80:-1),t(5),d(" ",o(86,74,"Timeline")," "),t(9),v(o(95,76,"Created")),t(3),d(" ",p.formatDateTime(e.created_at)," "),t(2),v(o(100,78,"MissingItemCreated")),t(2),I(e.updated_at!==e.created_at?101:-1),t(6),d(" ",o(108,80,"Actions")," "),t(4),I(p.canEdit()?111:-1),t(),I(p.canDelete()?112:-1),t(),b("ngClass",p.getStatusCardClass(e.status)),t(3),S(p.getStatusIcon(e.status)),t(),d(" ",o(118,82,"StatusInformation")," "),t(5),S(p.getStatusClass(e.status)),t(),S(p.getStatusIcon(e.status)),t(),d(" ",o(125,84,e.status)," "),t(4),d(" ",o(129,86,"StatusDescription"),": "),t(2),I(e.status===p.inventoryStatusEnum.PENDING?130:-1),t(),I(e.status===p.inventoryStatusEnum.TERMINATED?131:-1),t(5),d(" ",o(137,88,"SystemInformation")," "),t(9),v(e.id),t(4),d("",o(150,90,"CreatedAt")," "),t(3),v(p.formatDateTime(e.created_at)),t(4),d("",o(157,92,"UpdatedAt")," "),t(3),v(p.formatDateTime(e.updated_at))}}function In(l,m){if(l&1){let e=B();n(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5),c(4,"i",70),n(5,"h5",71),a(6),r(7,"translate"),i(),n(8,"p",36),a(9),r(10,"translate"),i(),n(11,"button",72),y("click",function(){_(e);let s=g(2);return f(s.goBack())}),c(12,"i",25),a(13),r(14,"translate"),i()()()()()}l&2&&(t(6),v(o(7,3,"MissingInventoryNotFound")),t(3),v(o(10,5,"MissingInventoryNotFoundDescription")),t(4),d(" ",o(14,7,"BackToList")," "))}function bn(l,m){if(l&1&&(x(0,xn,160,94),r(1,"async"),x(2,In,15,9,"div",2)),l&2){let e,p=g();I((e=o(1,1,p.missingInventory$))?0:2,e)}}var rt=class l{constructor(m,e,p,s,u){this.route=m;this.router=e;this.inventoryService=p;this.languageService=s;this.modalService=u}missingInventoryId;missingInventory$;loading$;currentMissingInventory;inventoryStatusEnum=J;ngOnInit(){this.missingInventoryId=this.route.snapshot.params.id,this.loading$=this.inventoryService.loading$,this.loadMissingInventoryDetail()}loadMissingInventoryDetail(){this.missingInventory$=this.inventoryService.getMissingInventoryDetailFromServer(this.missingInventoryId),this.missingInventory$.subscribe(m=>{this.currentMissingInventory=m})}editMissingInventory(){let m=this.modalService.open(de,{centered:!0,backdrop:"static",size:"lg"});m.componentInstance.missingInventoryId=this.missingInventoryId;var e;e=m.componentInstance.reload,e.subscribe(p=>{p&&this.loadMissingInventoryDetail()})}deleteMissingInventory(){confirm(this.languageService.instant("ConfirmDelete"))&&this.inventoryService.deleteMissingInventory(this.missingInventoryId).subscribe(()=>{this.router.navigate(["../"],{relativeTo:this.route})})}goBack(){window.history.back()}formatDate(m){return new Date(m).toLocaleDateString()}formatDateTime(m){return new Date(m).toLocaleString()}getStatusIcon(m){switch(m){case"pending":return"fas fa-clock";case"terminated":return"fas fa-check-circle";default:return"fas fa-question-circle"}}getStatusClass(m){switch(m){case"pending":return"badge bg-gradient-warning";case"terminated":return"badge bg-gradient-success";default:return"badge bg-gradient-secondary"}}getStatusCardClass(m){switch(m){case"pending":return"border-warning";case"terminated":return"border-success";default:return"border-secondary"}}canEdit(){return this.currentMissingInventory&&this.currentMissingInventory.status==="pending"}canDelete(){return!0}static \u0275fac=function(e){return new(e||l)(h(U),h(q),h(M),h(j),h(Y))};static \u0275cmp=D({type:l,selectors:[["app-detail-missing-inventory"]],standalone:!1,decls:6,vars:6,consts:[[1,"main-content","position-relative","max-height-vh-100","h-100","detail-missing-inventory"],[1,"container-fluid","py-4"],[1,"row","justify-content-center"],[1,"col-12","text-center"],[1,"card","shadow-lg"],[1,"card-body","py-5"],[1,"text-secondary","mt-3"],[1,"row","mb-4"],[1,"col-12"],[1,"card","bg-gradient-primary","shadow-lg","border-0"],[1,"card-body","p-4"],[1,"row","align-items-center"],[1,"col-md-8"],[1,"d-flex","align-items-center","text-white"],[1,"icon","icon-shape","icon-lg","bg-white","shadow","text-center","me-3"],[1,"text-primary"],[1,"mb-0"],[1,"text-sm","opacity-8","mb-0"],[1,"fas","fa-building","me-1"],[1,"fas","fa-cube","me-1"],[1,"col-md-4","text-end"],[1,"d-flex","justify-content-end","align-items-center"],[1,"me-3"],[1,"me-1"],[1,"btn","btn-outline-light","btn-sm",3,"click"],[1,"fas","fa-arrow-left","me-2"],[1,"row"],[1,"col-lg-8"],[1,"card","shadow-lg","mb-4"],[1,"card-header","bg-gradient-light","p-4"],[1,"fas","fa-info-circle","me-2","text-primary"],[1,"col-md-6"],[1,"info-item","mb-3"],[1,"form-label","text-sm","text-secondary","mb-1"],[1,"fas","fa-building","me-2"],[1,"text-dark","font-weight-600","mb-0"],[1,"text-muted"],[1,"fas","fa-cube","me-2"],[1,"fas","fa-clipboard-list","me-2"],[1,"me-2"],[1,"fas","fa-history","me-2","text-primary"],[1,"timeline","timeline-one-side"],[1,"timeline-block","mb-3"],[1,"timeline-step"],[1,"fas","fa-plus","text-success"],[1,"timeline-content"],[1,"text-dark","text-sm","font-weight-bold","mb-0"],[1,"text-secondary","font-weight-bold","text-xs","mt-1","mb-0"],[1,"text-sm","mt-3","mb-2"],[1,"col-lg-4"],[1,"fas","fa-cogs","me-2","text-primary"],[1,"d-grid","gap-2"],["type","button",1,"btn","btn-outline-primary","btn-sm"],["type","button",1,"btn","btn-outline-danger","btn-sm"],[1,"card","shadow-lg","mb-4",3,"ngClass"],[1,"card-header","p-4"],[1,"mb-0","text-white"],[1,"text-center"],[1,"mb-3"],[2,"font-size","1.1rem"],[1,"fas","fa-fingerprint","me-2"],[1,"fas","fa-calendar-plus","me-2"],[1,"info-item"],[1,"fas","fa-calendar-edit","me-2"],[1,"fas","fa-comment","me-2"],[1,"fas","fa-edit","text-info"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"fas","fa-edit","me-2"],["type","button",1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"fas","fa-trash","me-2"],[1,"fas","fa-exclamation-triangle","text-warning",2,"font-size","3rem"],[1,"mt-3"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(e,p){e&1&&(n(0,"div",0)(1,"div",1),x(2,cn,8,3,"div",2),r(3,"async"),x(4,bn,3,3),r(5,"async"),i()()),e&2&&(t(2),I(o(3,2,p.loading$)?2:-1),t(2),I(o(5,4,p.loading$)?-1:4))},dependencies:[Ye,V,P,O],encapsulation:2})};var hn=(l,m)=>m.id;function Cn(l,m){if(l&1){let e=B();n(0,"div",51)(1,"button",52),y("click",function(){_(e);let s=g();return f(s.closeScan())}),a(2),r(3,"translate"),i()()}l&2&&(t(2),d(" ",o(3,1,"close scan barcode")," "))}function Sn(l,m){if(l&1){let e=B();n(0,"div",51)(1,"button",52),y("click",function(){_(e);let s=g();return f(s.scanCodeBarre())}),c(2,"i",53),a(3),r(4,"translate"),i()()}l&2&&(t(3),d(" ",o(4,1,"scan a barcode")," "))}function En(l,m){if(l&1&&(n(0,"option",33),a(1),i()),l&2){let e=m.$implicit;b("value",e.id),t(),v(e.name)}}function Bn(l,m){if(l&1&&(n(0,"option",33),a(1),i()),l&2){let e=m.$implicit;b("value",e),t(),v(e)}}function kn(l,m){l&1&&(n(0,"div",50),c(1,"app-custom-spinner"),n(2,"p",54),a(3),r(4,"translate"),i()()),l&2&&(t(3),d("",o(4,1,"LoadingBrokenItems"),"..."))}function wn(l,m){if(l&1){let e=B();n(0,"div",50),c(1,"i",56),n(2,"h6",54),a(3),r(4,"translate"),i(),n(5,"p",57),a(6),r(7,"translate"),i(),n(8,"button",49),y("click",function(){_(e);let s=g(2);return f(s.createBrokenInventory())}),c(9,"i",19),a(10),r(11,"translate"),i()()}l&2&&(t(3),v(o(4,3,"NoBrokenItemsFound")),t(3),v(o(7,5,"CreateFirstBrokenItem")),t(4),d("",o(11,7,"AddBrokenItem")," "))}function Mn(l,m){if(l&1&&(n(0,"div",74)(1,"div",79)(2,"div",91),a(3),i()(),n(4,"div",81)(5,"h6",82),a(6),i(),n(7,"p",69),a(8),i()()()),l&2){let e=g().$implicit;t(3),w(" ",e.immobilisation.employee_immo.employee.first_name.charAt(0),"",e.immobilisation.employee_immo.employee.last_name.charAt(0)," "),t(3),w("",e.immobilisation.employee_immo.employee.first_name," ",e.immobilisation.employee_immo.employee.last_name,""),t(2),v(e.immobilisation.employee_immo.employee.matricule)}}function Dn(l,m){l&1&&(n(0,"span",75),c(1,"i",92),a(2),r(3,"translate"),i()),l&2&&(t(2),d("",o(3,1,"NotAssigned")," "))}function Fn(l,m){l&1&&(n(0,"span"),a(1,"..."),i())}function Tn(l,m){if(l&1){let e=B();n(0,"tr")(1,"td")(2,"div",64)(3,"div")(4,"div",65),c(5,"i",66),i()(),n(6,"div",67)(7,"h6",68),a(8),i(),n(9,"p",69),a(10),i()()()(),n(11,"td")(12,"div",64)(13,"div")(14,"div",70),c(15,"i",71),i()(),n(16,"div",67)(17,"h6",68),a(18),i(),n(19,"p",69),a(20),r(21,"translate"),i()()()(),n(22,"td",72)(23,"span"),c(24,"i",73),a(25),r(26,"translate"),i()(),n(27,"td"),x(28,Mn,9,5,"div",74)(29,Dn,4,3,"span",75),i(),n(30,"td")(31,"p",76),a(32),r(33,"slice"),x(34,Fn,2,0,"span"),i()(),n(35,"td",77)(36,"div",78)(37,"div",79)(38,"div",80),a(39),i()(),n(40,"div",81)(41,"h6",82),a(42),i(),n(43,"span",83),a(44),i()()()(),n(45,"td",77)(46,"div",84)(47,"button",85),c(48,"i",86),i(),n(49,"ul",17)(50,"li")(51,"a",18),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.viewDetails(s.id))}),c(52,"i",87),a(53),r(54,"translate"),i()(),n(55,"li")(56,"a",18),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.updateBrokenInventory(s.id))}),c(57,"i",88),a(58),r(59,"translate"),i()(),n(60,"li"),c(61,"hr",20),i(),n(62,"li")(63,"a",89),y("click",function(){let s=_(e).$implicit,u=g(3);return f(u.deleteBrokenInventory(s.id))}),c(64,"i",90),a(65),r(66,"translate"),i()()()()()()}if(l&2){let e=m.$implicit,p=g(3);t(8),v(e.immobilisation.name),t(2),v(e.immobilisation.code),t(8),v(e.inventory.name),t(2),v(o(21,20,e.inventory.type)),t(3),S(p.getStatusClass(e.status)),t(),S(p.getStatusIcon(e.status)),t(),d(" ",o(26,22,e.status)," "),t(3),I(e.immobilisation.employee_immo!=null&&e.immobilisation.employee_immo.employee?28:29),t(3),b("title",e.comment),t(),d(" ",We(33,24,e.comment,0,50)," "),t(2),I(e.comment&&e.comment.length>50?34:-1),t(5),w(" ",e.user.first_name.charAt(0),"",e.user.last_name.charAt(0)," "),t(3),v(e.user.first_name),t(2),v(p.formatDate(e.created_at)),t(9),d(" ",o(54,28,"View")," "),t(5),d(" ",o(59,30,"Edit")," "),t(7),d(" ",o(66,32,"Delete")," ")}}function Pn(l,m){if(l&1){let e=B();n(0,"div",55)(1,"table",58)(2,"thead")(3,"tr")(4,"th",59)(5,"a",60),y("click",function(){_(e);let s=g(2);return f(s.sortBy("immobilisation.name"))}),a(6),r(7,"translate"),c(8,"i"),i()(),n(9,"th",61)(10,"a",60),y("click",function(){_(e);let s=g(2);return f(s.sortBy("inventory.name"))}),a(11),r(12,"translate"),c(13,"i"),i()(),n(14,"th",62)(15,"a",60),y("click",function(){_(e);let s=g(2);return f(s.sortBy("status"))}),a(16),r(17,"translate"),c(18,"i"),i()(),n(19,"th",61),a(20),r(21,"translate"),i(),n(22,"th",61),a(23),r(24,"translate"),i(),n(25,"th",62)(26,"a",60),y("click",function(){_(e);let s=g(2);return f(s.sortBy("created_at"))}),a(27),r(28,"translate"),c(29,"i"),i()(),n(30,"th",63),a(31),r(32,"translate"),i()()(),n(33,"tbody"),F(34,Tn,67,34,"tr",null,He().trackByFn,!0),r(36,"async"),i()()()}if(l&2){let e=g(2);t(6),d(" ",o(7,15,"Immobilisation")," "),t(2),S(e.getSortIcon("immobilisation.name")),t(3),d(" ",o(12,17,"Inventory")," "),t(2),S(e.getSortIcon("inventory.name")),t(3),d(" ",o(17,19,"Status")," "),t(2),S(e.getSortIcon("status")),t(2),d(" ",o(21,21,"Employee")," "),t(3),d(" ",o(24,23,"Comment")," "),t(4),d(" ",o(28,25,"CreatedBy")," "),t(2),S(e.getSortIcon("created_at")),t(2),v(o(32,27,"Actions")),t(3),T(o(36,29,e.brokenInventories$))}}function On(l,m){if(l&1&&(x(0,wn,12,9,"div",50),r(1,"async"),x(2,Pn,37,31,"div",55)),l&2){let e,p=g();I(((e=o(1,1,p.brokenInventories$))==null?null:e.length)===0?0:2)}}function Vn(l,m){if(l&1){let e=B();n(0,"div",5)(1,"div",6)(2,"div",44)(3,"div",93)(4,"div",94)(5,"div",95),a(6),r(7,"translate"),r(8,"translate"),r(9,"translate"),r(10,"translate"),i(),n(11,"mat-paginator",96),y("page",function(s){_(e);let u=g();return f(u.pageChange(s))}),i()()()()()()}if(l&2){let e=g();t(6),fe(" ",o(7,11,"Showing")," ",(e.paginateData.current_page-1)*e.paginateData.per_page+1," ",o(8,13,"to")," ",e.Math.min(e.paginateData.current_page*e.paginateData.per_page,e.totaElement)," ",o(9,15,"of")," ",e.totaElement," ",o(10,17,"entries")," "),t(5),b("length",e.totaElement)("pageSize",e.itemsPerPage)("pageSizeOptions",e.pageArray)("pageIndex",e.paginateData.current_page-1)}}var ot=class l extends z{constructor(e,p,s,u,E,C){super();this.languageService=e;this.inventoryService=p;this.modalService=s;this.router=u;this.formBuilder=E;this.route=C}loading$;itemsPerPage=10;paginateData$;paginateData;totaElement=0;pageEvent;pageArray=[];searchCtrl;statusCtrl;inventoryCtrl;itemsPerPage$=new G(this.itemsPerPage);page$=new G(1);brokenInventories$;barcodeScanner;isActiveScan=!1;inventories$;inventoryStatusEnum=J;currentSortBy="created_at";sortDirection="desc";startDate="";endDate="";Math=Math;ngOnInit(){console.log("init list-broken-inventory"),this.loading$=this.inventoryService.loading$,this.searchCtrl=this.formBuilder.control(""),this.statusCtrl=this.formBuilder.control(""),this.inventoryCtrl=this.formBuilder.control(""),this.brokenInventories$=this.inventoryService.brokenInventories$,this.inventoryService.getBrokenInventoriesFromServer({current_page:1,per_page:this.itemsPerPage}),this.brokenInventories$.subscribe(e=>{this.isActiveScan&&e.length==1&&(this.isActiveScan=!1,this.barcodeScanner.stop(),this.inventoryService.setSnackMesage("Inventaire cass\xE9 trouv\xE9 : "+e[0].id))}),this.inventories$=this.inventoryService.inventories$,this.inventoryService.getInventoriesFromServer(),this.initSearchFilter(),this.paginateData$=this.inventoryService.paginateData$,this.paginateData$.subscribe(e=>{this.paginateData=e,this.totaElement=e.total??0,this.generatePageArray()})}getBrokenInventorySearchOptions(e=[]){this.inventoryService.getBrokenInventoriesFromServer(this.paginateData,e)}initSearchFilter(){this.searchCtrl.valueChanges.pipe(ge(300),_e()).subscribe(()=>{this.applyFilters()}),this.statusCtrl.valueChanges.subscribe(()=>{this.applyFilters()}),this.inventoryCtrl.valueChanges.subscribe(()=>{this.applyFilters()})}generatePageArray(){this.pageArray=[];for(let e=5;e<=50;e+=5)this.pageArray.push(e)}trackByFn(e,p){return p.id}pageChange(e){this.paginateData.current_page=e.pageIndex+1,e.pageSize!==this.itemsPerPage?(this.itemsPerPage=e.pageSize,this.paginateData.per_page=this.itemsPerPage,this.paginateData.current_page=1):this.paginateData.current_page=e.pageIndex+1,this.applyFilters()}changeChoiceItemPage(){this.paginateData.per_page=this.itemsPerPage,this.paginateData.current_page=1,this.applyFilters()}applyFilters(){let e=[];this.searchCtrl.value&&this.searchCtrl.value.trim()!==""&&e.push(k("search",this.searchCtrl.value.trim())),this.statusCtrl.value&&this.statusCtrl.value!==""&&e.push(k("status",this.statusCtrl.value)),this.inventoryCtrl.value&&this.inventoryCtrl.value!==""&&e.push(k("inventory_id",this.inventoryCtrl.value)),this.startDate&&e.push(k("start_date",this.startDate)),this.endDate&&e.push(k("end_date",this.endDate)),e.push(k("sort_by",this.currentSortBy)),e.push(k("sort_direction",this.sortDirection)),this.getBrokenInventorySearchOptions(e)}resetFilters(){this.searchCtrl.setValue(""),this.statusCtrl.setValue(""),this.inventoryCtrl.setValue(""),this.startDate="",this.endDate="",this.currentSortBy="created_at",this.sortDirection="desc",this.paginateData.current_page=1,this.getBrokenInventorySearchOptions()}sortBy(e){this.currentSortBy===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.currentSortBy=e,this.sortDirection="desc"),this.applyFilters()}getSortIcon(e){return this.currentSortBy!==e?"fas fa-sort text-muted":this.sortDirection==="asc"?"fas fa-sort-up text-primary":"fas fa-sort-down text-primary"}createBrokenInventory(){this.modalService.open(ce,{size:"lg",backdrop:"static",keyboard:!1}).result.then(p=>{p&&this.applyFilters()},p=>{})}updateBrokenInventory(e){let p=this.modalService.open(ce,{size:"lg",backdrop:"static",keyboard:!1});p.componentInstance.brokenInventoryId=e,p.componentInstance.isEditMode=!0,p.result.then(s=>{s&&this.applyFilters()},s=>{})}viewDetails(e){this.router.navigate(["../detail",e],{relativeTo:this.route})}deleteBrokenInventory(e){confirm("\xCAtes-vous s\xFBr de vouloir supprimer cet \xE9l\xE9ment cass\xE9 ?")&&this.inventoryService.deleteBrokenInventory(e).subscribe({next:p=>{p.success&&this.applyFilters()},error:p=>{console.error("Error deleting broken inventory:",p)}})}getStatusClass(e){switch(e){case"pending":return"badge bg-gradient-warning";case"terminated":return"badge bg-gradient-success";default:return"badge bg-gradient-secondary"}}getStatusIcon(e){switch(e){case"pending":return"fas fa-clock";case"terminated":return"fas fa-check";default:return"fas fa-question"}}formatDate(e){return e?new Date(e).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):""}onValueChanges(e){console.log("valueChanges :",e.codeResult.code),e.codeResult.code.length>8&&(console.log("valueChanges 2 : ",e.codeResult.code),this.searchCtrl.setValue(e.codeResult.code),this.applyFilters())}scanCodeBarre(){this.barcodeScanner&&typeof this.barcodeScanner.start=="function"&&(this.barcodeScanner.start(),this.isActiveScan=!0)}closeScan(){this.barcodeScanner.stop(),this.isActiveScan=!1}onStarted(e){console.log("started :",e)}static \u0275fac=function(p){return new(p||l)(h(j),h(M),h(Y),h(q),h(W),h(U))};static \u0275cmp=D({type:l,selectors:[["app-list-broken-inventory"]],viewQuery:function(p,s){if(p&1&&Me(ie,5),p&2){let u;De(u=Fe())&&(s.barcodeScanner=u.first)}},standalone:!1,features:[ae],decls:133,vars:78,consts:[["barcodeScanner",""],[1,"row","col-6"],["type","code_128",3,"valueChanges","started"],["class","col-lg-8 col-md-6 col-12",4,"ngIf"],[1,"container-fluid","py-4"],[1,"row"],[1,"col-12"],[1,"card","mb-4"],[1,"card-header","pb-0","bg-gradient-primary"],[1,"row","align-items-center"],[1,"col-lg-6","col-7"],[1,"mb-0","text-white"],[1,"text-sm","mb-0","text-white","opacity-8"],[1,"col-lg-6","col-5","my-auto","text-end"],[1,"dropdown","float-lg-end","pe-4"],["href","#","role","button","data-bs-toggle","dropdown",1,"btn","bg-gradient-light","mb-0","dropdown-toggle"],[1,"fas","fa-plus"],[1,"dropdown-menu"],[1,"dropdown-item",3,"click"],[1,"fas","fa-plus","me-2"],[1,"dropdown-divider"],["routerLink","../",1,"dropdown-item"],[1,"fas","fa-clipboard-list","me-2"],[1,"fas","fa-filter","me-2"],[1,"card-body","px-0","pt-0","pb-2"],[1,"row","mt-3","px-3"],[1,"col-lg-4","col-md-6","col-12"],[1,"form-group","mb-3"],[1,"form-label","text-xs"],["type","text",1,"form-control",3,"formControl","placeholder"],[1,"col-lg-2","col-md-6","col-12"],[1,"form-select",3,"formControl"],["value",""],[3,"value"],[1,"form-select",3,"ngModelChange","change","ngModel"],[1,"col-lg-1","col-md-6","col-12"],[1,"form-label","text-xs","opacity-0"],[1,"btn","btn-outline-secondary","btn-sm","w-100",3,"click","title"],[1,"fas","fa-undo"],[1,"row","px-3"],[1,"col-lg-3","col-md-6","col-12"],[1,"form-group","mb-0"],["type","date",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-lg-6"],[1,"card"],[1,"card-header","pb-0"],[1,"col-8"],[1,"mb-0"],[1,"col-4","text-end"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"text-center","py-4"],[1,"col-lg-8","col-md-6","col-12"],[1,"btn","btn-outline-info","btn-sm","mb-1","me-2",3,"click"],[1,"fas","fa-barcode","me-2"],[1,"text-muted","mt-3"],[1,"table-responsive","p-0"],[1,"fas","fa-wrench","text-muted",2,"font-size","3rem"],[1,"text-sm","text-muted"],[1,"table","align-items-center","mb-0"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","ps-2"],[1,"text-decoration-none","cursor-pointer",3,"click"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","text-center"],[1,"text-secondary","opacity-7","text-center"],[1,"d-flex","px-2","py-1"],[1,"avatar","avatar-sm","me-3","bg-gradient-info"],[1,"fas","fa-cube","text-white"],[1,"d-flex","flex-column","justify-content-center"],[1,"mb-0","text-sm"],[1,"text-xs","text-secondary","mb-0"],[1,"avatar","avatar-sm","me-3","bg-gradient-primary"],[1,"fas","fa-clipboard-list","text-white"],[1,"align-middle","text-center","text-sm"],[1,"me-1"],[1,"d-flex","align-items-center"],[1,"text-xs","text-secondary"],[1,"text-xs","font-weight-bold","mb-0",3,"title"],[1,"align-middle","text-center"],[1,"d-flex","align-items-center","justify-content-center"],[1,"avatar","avatar-xs","me-2"],[1,"avatar-initial","rounded-circle","bg-gradient-primary"],[1,"d-flex","flex-column"],[1,"mb-0","text-xs"],[1,"text-secondary","text-xs"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-link","text-secondary","mb-0"],[1,"fa","fa-ellipsis-v","text-xs"],[1,"fas","fa-eye","me-2"],[1,"fas","fa-edit","me-2"],[1,"dropdown-item","text-danger",3,"click"],[1,"fas","fa-trash","me-2"],[1,"avatar-initial","rounded-circle","bg-gradient-success"],[1,"fas","fa-user-slash","me-1"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-center"],[1,"text-muted"],["showFirstLastButtons","",3,"page","length","pageSize","pageSizeOptions","pageIndex"]],template:function(p,s){if(p&1){let u=B();n(0,"app-base")(1,"div",1)(2,"barcode-scanner-livestream",2,0),y("valueChanges",function(C){return _(u),f(s.onValueChanges(C))})("started",function(){return _(u),f(s.onStarted(!0))}),i(),x(4,Cn,4,3,"div",3),i(),x(5,Sn,5,3,"div",3),n(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"h6",11),a(14),r(15,"translate"),i(),n(16,"p",12),a(17),r(18,"translate"),i()(),n(19,"div",13)(20,"div",14)(21,"a",15),c(22,"i",16),a(23),r(24,"translate"),i(),n(25,"ul",17)(26,"li")(27,"a",18),y("click",function(){return _(u),f(s.createBrokenInventory())}),c(28,"i",19),a(29),r(30,"translate"),i()(),n(31,"li"),c(32,"hr",20),i(),n(33,"li")(34,"a",21),c(35,"i",22),a(36),r(37,"translate"),i()(),n(38,"li"),c(39,"hr",20),i(),n(40,"li")(41,"a",18),y("click",function(){return _(u),f(s.resetFilters())}),c(42,"i",23),a(43),r(44,"translate"),i()()()()()()()()()(),n(45,"div",5)(46,"div",6)(47,"div",7)(48,"div",24)(49,"div",25)(50,"div",26)(51,"div",27)(52,"label",28),a(53),r(54,"translate"),i(),c(55,"input",29),r(56,"translate"),i()(),n(57,"div",30)(58,"div",27)(59,"label",28),a(60),r(61,"translate"),i(),n(62,"select",31)(63,"option",32),a(64),r(65,"translate"),i(),n(66,"option",33),a(67),r(68,"translate"),i(),n(69,"option",33),a(70),r(71,"translate"),i()()()(),n(72,"div",30)(73,"div",27)(74,"label",28),a(75),r(76,"translate"),i(),n(77,"select",31)(78,"option",32),a(79),r(80,"translate"),i(),F(81,En,2,2,"option",33,hn),r(83,"async"),i()()(),n(84,"div",30)(85,"div",27)(86,"label",28),a(87),r(88,"translate"),i(),n(89,"select",34),te("ngModelChange",function(C){return _(u),ee(s.itemsPerPage,C)||(s.itemsPerPage=C),f(C)}),y("change",function(){return _(u),f(s.changeChoiceItemPage())}),F(90,Bn,2,2,"option",33,Ce),i()()(),n(92,"div",35)(93,"div",27)(94,"label",36),a(95,"Action"),i(),n(96,"button",37),r(97,"translate"),y("click",function(){return _(u),f(s.resetFilters())}),c(98,"i",38),i()()()(),n(99,"div",39)(100,"div",40)(101,"div",41)(102,"label",28),a(103),r(104,"translate"),i(),n(105,"input",42),te("ngModelChange",function(C){return _(u),ee(s.startDate,C)||(s.startDate=C),f(C)}),y("change",function(){return _(u),f(s.applyFilters())}),i()()(),n(106,"div",40)(107,"div",41)(108,"label",28),a(109),r(110,"translate"),i(),n(111,"input",42),te("ngModelChange",function(C){return _(u),ee(s.endDate,C)||(s.endDate=C),f(C)}),y("change",function(){return _(u),f(s.applyFilters())}),i()()(),c(112,"div",43),i()()()()(),n(113,"div",5)(114,"div",6)(115,"div",44)(116,"div",45)(117,"div",9)(118,"div",46)(119,"h6",47),a(120),r(121,"translate"),i()(),n(122,"div",48)(123,"button",49),y("click",function(){return _(u),f(s.createBrokenInventory())}),c(124,"i",19),a(125),r(126,"translate"),i()()()(),n(127,"div",24),x(128,kn,5,3,"div",50),r(129,"async"),x(130,On,3,3),i()()()(),x(131,Vn,12,19,"div",5),r(132,"async"),i()()}if(p&2){let u;t(4),b("ngIf",s.isActiveScan),t(),b("ngIf",!s.isActiveScan),t(9),v(o(15,32,"InventoryBroken")),t(3),v(o(18,34,"ManageBrokenItems")),t(6),d("\xA0\xA0",o(24,36,"Actions")," "),t(6),d("",o(30,38,"AddBrokenItem")," "),t(7),d("",o(37,40,"BackToInventories")," "),t(7),d("",o(44,42,"ResetFilters")," "),t(10),v(o(54,44,"Search")),t(2),R("placeholder",o(56,46,"SearchBrokenItems")),b("formControl",s.searchCtrl),t(5),v(o(61,48,"Status")),t(2),b("formControl",s.statusCtrl),t(2),v(o(65,50,"AllStatuses")),t(2),b("value",s.inventoryStatusEnum.PENDING),t(),v(o(68,52,"Pending")),t(2),b("value",s.inventoryStatusEnum.TERMINATED),t(),v(o(71,54,"Terminated")),t(5),v(o(76,56,"Inventory")),t(2),b("formControl",s.inventoryCtrl),t(2),v(o(80,58,"AllInventories")),t(2),T(o(83,60,s.inventories$)),t(6),v(o(88,62,"ItemsPerPage")),t(2),Z("ngModel",s.itemsPerPage),t(),T(s.pageArray),t(6),R("title",o(97,64,"ResetFilters")),t(7),v(o(104,66,"DateFrom")),t(2),Z("ngModel",s.startDate),t(4),v(o(110,68,"DateTo")),t(2),Z("ngModel",s.endDate),t(9),v(o(121,70,"BrokenItemsList")),t(5),d("",o(126,72,"Add")," "),t(3),I(o(129,74,s.loading$)?128:130),t(3),I((u=o(132,76,s.brokenInventories$))!=null&&u.length&&s.totaElement>0?131:-1)}},dependencies:[ye,xe,z,oe,le,H,re,Q,Pe,Ie,V,be,ie,P,Xe,O],encapsulation:2})};function Ln(l,m){l&1&&(n(0,"div",1),c(1,"app-custom-spinner"),n(2,"p",3),a(3),r(4,"translate"),i()()),l&2&&(t(3),d("",o(4,1,"LoadingBrokenItemDetails"),"..."))}function An(l,m){if(l&1){let e=B();n(0,"div",2)(1,"div",4)(2,"div",5)(3,"div",6),c(4,"i",7),n(5,"h4",8),a(6),r(7,"translate"),i(),n(8,"p",9),a(9),r(10,"translate"),i(),n(11,"button",10),y("click",function(){_(e);let s=g();return f(s.goBack())}),c(12,"i",11),a(13),r(14,"translate"),i()()()()()}l&2&&(t(6),v(o(7,3,"BrokenItemNotFound")),t(3),v(o(10,5,"BrokenItemNotFoundDescription")),t(4),d("",o(14,7,"BackToBrokenItems")," "))}function $n(l,m){if(l&1){let e=B();n(0,"div",2)(1,"div",4)(2,"div",12)(3,"div",13)(4,"div",14)(5,"div",15)(6,"h6",16),a(7),r(8,"translate"),i(),n(9,"p",17),a(10),r(11,"translate"),i()(),n(12,"div",18)(13,"div",19)(14,"a",20),c(15,"i",21),a(16),r(17,"translate"),i(),n(18,"ul",22)(19,"li")(20,"a",23),y("click",function(){_(e);let s=g();return f(s.editBrokenInventory())}),c(21,"i",24),a(22),r(23,"translate"),i()(),n(24,"li"),c(25,"hr",25),i(),n(26,"li")(27,"a",26),y("click",function(){_(e);let s=g();return f(s.deleteBrokenInventory())}),c(28,"i",27),a(29),r(30,"translate"),i()(),n(31,"li"),c(32,"hr",25),i(),n(33,"li")(34,"a",23),y("click",function(){_(e);let s=g();return f(s.goBack())}),c(35,"i",11),a(36),r(37,"translate"),i()()()()()()()()()(),n(38,"div",2)(39,"div",28)(40,"div",29)(41,"div",2)(42,"div",30)(43,"div",31)(44,"div",32),c(45,"i",33),i()()(),n(46,"div",34)(47,"div",35)(48,"h5",36),a(49),r(50,"translate"),i(),n(51,"p",37)(52,"span"),c(53,"i",38),a(54),r(55,"translate"),i()()()()(),n(56,"div",39)(57,"div",2)(58,"div",40)(59,"div",41)(60,"div",42)(61,"span",43),a(62),i(),n(63,"span",44),a(64),r(65,"translate"),i()()()()(),n(66,"div",45)(67,"button",46),y("click",function(){_(e);let s=g();return f(s.editBrokenInventory())}),c(68,"i",24),a(69),r(70,"translate"),i(),n(71,"button",47),y("click",function(){_(e);let s=g();return f(s.goBack())}),c(72,"i",11),a(73),r(74,"translate"),i()()()()(),n(75,"div",48)(76,"div",5)(77,"div",49)(78,"div",50)(79,"p",51),a(80),r(81,"translate"),i()()(),n(82,"div",52)(83,"div",2)(84,"div",53)(85,"div",54)(86,"label",55),a(87),r(88,"translate"),i(),n(89,"div",56)(90,"div",57)(91,"div",58)(92,"div")(93,"div",59),c(94,"i",60),i()(),n(95,"div",61)(96,"h6",62),a(97),i(),n(98,"p",63),a(99),i()()()()()()(),n(100,"div",53)(101,"div",54)(102,"label",55),a(103),r(104,"translate"),i(),n(105,"div",64)(106,"span"),c(107,"i",38),a(108),r(109,"translate"),i()()()(),n(110,"div",65)(111,"div",54)(112,"label",55),a(113),r(114,"translate"),i(),n(115,"div",56)(116,"div",57)(117,"div",58)(118,"div")(119,"div",66),c(120,"i",67),i()(),n(121,"div",61)(122,"h6",62),a(123),i(),n(124,"p",63),a(125),r(126,"translate"),r(127,"translate"),i()()()()()()(),n(128,"div",65)(129,"div",54)(130,"label",55),a(131),r(132,"translate"),i(),n(133,"div",56)(134,"div",57)(135,"div",58)(136,"div")(137,"div",68),c(138,"i",69),i()(),n(139,"div",61)(140,"h6",62),a(141),i(),n(142,"p",63),a(143),r(144,"translate"),r(145,"translate"),i()()()()()()(),n(146,"div",65)(147,"div",54)(148,"label",55),a(149),r(150,"translate"),i(),n(151,"div",5)(152,"div",52)(153,"p",70),a(154),i()()()()(),n(155,"div",53)(156,"div",54)(157,"label",55),a(158),r(159,"translate"),i(),n(160,"p",71),a(161),i()()(),n(162,"div",53)(163,"div",54)(164,"label",55),a(165),r(166,"translate"),i(),n(167,"p",71),a(168),i()()()()()()()()}if(l&2){let e=g();t(7),v(o(8,43,"BrokenItemDetails")),t(3),v(o(11,45,"BrokenItemInformation")),t(6),d("\xA0\xA0",o(17,47,"Actions")," "),t(6),d("",o(23,49,"Edit")," "),t(7),d("",o(30,51,"Delete")," "),t(7),d("",o(37,53,"BackToBrokenItems")," "),t(13),v(o(50,55,"BrokenItem")),t(3),S(e.getStatusClass(e.brokenInventory.status)),t(),S(e.getStatusIcon(e.brokenInventory.status)),t(),d(" ",o(55,57,e.brokenInventory.status)," "),t(8),v(e.formatDate(e.brokenInventory.created_at)),t(2),v(o(65,59,"CreatedAt")),t(5),d("",o(70,61,"Edit")," "),t(4),d("",o(74,63,"Back")," "),t(7),v(o(81,65,"BrokenItemInformation")),t(7),v(o(88,67,"User")),t(10),w("",e.brokenInventory.user.first_name," ",e.brokenInventory.user.last_name,""),t(2),v(e.brokenInventory.user.email),t(4),v(o(104,69,"Status")),t(3),S(e.getStatusClass(e.brokenInventory.status)),t(),S(e.getStatusIcon(e.brokenInventory.status)),t(),d(" ",o(109,71,e.brokenInventory.status)," "),t(5),v(o(114,73,"Immobilisation")),t(10),v(e.brokenInventory.immobilisation.name),t(2),bt(" ",o(126,75,"Code"),": ",e.brokenInventory.immobilisation.code," | ",o(127,77,"Mark"),": ",e.brokenInventory.immobilisation.mark," "),t(6),v(o(132,79,"Inventory")),t(10),v(e.brokenInventory.inventory.name),t(2),w(" ",o(144,81,"Type"),": ",o(145,83,e.brokenInventory.inventory.type)," "),t(6),v(o(150,85,"Comment")),t(5),v(e.brokenInventory.comment),t(4),v(o(159,87,"CreatedAt")),t(3),v(e.formatDate(e.brokenInventory.created_at)),t(4),v(o(166,89,"UpdatedAt")),t(3),v(e.formatDate(e.brokenInventory.updated_at))}}var lt=class l extends z{constructor(e,p,s,u){super();this.route=e;this.router=p;this.inventoryService=s;this.modalService=u}brokenInventoryId;brokenInventory;loading$;inventoryStatusEnum=J;ngOnInit(){this.loading$=this.inventoryService.loading$,this.route.params.subscribe(e=>{this.brokenInventoryId=e.id,this.brokenInventoryId&&this.loadBrokenInventoryDetails()})}loadBrokenInventoryDetails(){this.inventoryService.getBrokenInventoryDetailFromServer(this.brokenInventoryId).subscribe({next:e=>{this.brokenInventory=e},error:e=>{console.error("Error loading broken inventory details:",e),this.router.navigate(["../"],{relativeTo:this.route})}})}editBrokenInventory(){let e=this.modalService.open(ce,{size:"lg",backdrop:"static",keyboard:!1});e.componentInstance.brokenInventoryId=this.brokenInventoryId,e.componentInstance.isEditMode=!0,e.result.then(p=>{p&&this.loadBrokenInventoryDetails()},p=>{})}deleteBrokenInventory(){confirm("\xCAtes-vous s\xFBr de vouloir supprimer cet \xE9l\xE9ment cass\xE9 ?")&&this.inventoryService.deleteBrokenInventory(this.brokenInventoryId).subscribe({next:e=>{e.success&&this.router.navigate(["../"],{relativeTo:this.route})},error:e=>{console.error("Error deleting broken inventory:",e)}})}goBack(){this.router.navigate(["../"],{relativeTo:this.route})}getStatusClass(e){switch(e){case"pending":return"badge bg-gradient-warning";case"terminated":return"badge bg-gradient-success";default:return"badge bg-gradient-secondary"}}getStatusIcon(e){switch(e){case"pending":return"fas fa-clock";case"terminated":return"fas fa-check";default:return"fas fa-question"}}formatDate(e){return e?new Date(e).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}static \u0275fac=function(p){return new(p||l)(h(U),h(q),h(M),h(Y))};static \u0275cmp=D({type:l,selectors:[["app-detail-broken-inventory"]],standalone:!1,features:[ae],decls:6,vars:3,consts:[[1,"container-fluid","py-4"],[1,"text-center","py-5"],[1,"row"],[1,"text-muted","mt-3"],[1,"col-12"],[1,"card"],[1,"card-body","text-center","py-5"],[1,"fas","fa-exclamation-triangle","text-warning",2,"font-size","3rem"],[1,"mt-3"],[1,"text-muted"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-arrow-left","me-2"],[1,"card","mb-4"],[1,"card-header","pb-0","bg-gradient-primary"],[1,"row","align-items-center"],[1,"col-lg-6","col-7"],[1,"mb-0","text-white"],[1,"text-sm","mb-0","text-white","opacity-8"],[1,"col-lg-6","col-5","my-auto","text-end"],[1,"dropdown","float-lg-end","pe-4"],["href","#","role","button","data-bs-toggle","dropdown",1,"btn","bg-gradient-light","mb-0","dropdown-toggle"],[1,"fas","fa-cog"],[1,"dropdown-menu"],[1,"dropdown-item",3,"click"],[1,"fas","fa-edit","me-2"],[1,"dropdown-divider"],[1,"dropdown-item","text-danger",3,"click"],[1,"fas","fa-trash","me-2"],[1,"col-xl-4","col-lg-5"],[1,"card","card-profile"],[1,"col-4"],[1,"card-profile-image"],[1,"avatar","avatar-xl","bg-gradient-danger","shadow-sm"],[1,"fas","fa-wrench","text-white",2,"font-size","1.5rem"],[1,"col-8","my-auto"],[1,"card-body","text-left"],[1,"font-weight-bolder","mb-0"],[1,"text-sm","font-weight-light","mb-0"],[1,"me-1"],[1,"card-body","pt-0"],[1,"col"],[1,"d-flex","justify-content-center"],[1,"d-grid","text-center"],[1,"text-lg","font-weight-bolder"],[1,"text-sm","opacity-8"],[1,"text-center","mt-4"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"btn","btn-outline-secondary","btn-sm","ms-2",3,"click"],[1,"col-xl-8","col-lg-7"],[1,"card-header","pb-0"],[1,"d-flex","align-items-center"],[1,"mb-0"],[1,"card-body"],[1,"col-md-6"],[1,"form-group"],[1,"form-control-label"],[1,"card","mb-3"],[1,"card-body","p-3"],[1,"d-flex"],[1,"avatar","avatar-sm","me-3","bg-gradient-secondary"],[1,"fas","fa-user","text-white"],[1,"d-flex","flex-column","justify-content-center"],[1,"mb-0","text-sm"],[1,"text-xs","text-secondary","mb-0"],[1,"mt-2"],[1,"col-md-12"],[1,"avatar","avatar-sm","me-3","bg-gradient-info"],[1,"fas","fa-cube","text-white"],[1,"avatar","avatar-sm","me-3","bg-gradient-primary"],[1,"fas","fa-clipboard-list","text-white"],[1,"text-sm","mb-0"],[1,"form-control-static"]],template:function(p,s){p&1&&(n(0,"app-base")(1,"div",0),x(2,Ln,5,3,"div",1),r(3,"async"),x(4,An,15,9,"div",2)(5,$n,169,91),i()()),p&2&&(t(2),I(o(3,1,s.loading$)?2:s.brokenInventory?5:4))},dependencies:[z,V,P,O],encapsulation:2})};var pt=(l,m)=>m.id;function Nn(l,m){l&1&&(n(0,"div",2)(1,"div",5)(2,"div",6)(3,"div",7)(4,"div",8)(5,"span",9),a(6),r(7,"translate"),i()(),n(8,"p",10),a(9),r(10,"translate"),i()()()()()),l&2&&(t(6),d("",o(7,2,"Loading"),"..."),t(3),d("",o(10,4,"LoadingInventoryDetails"),"..."))}function Rn(l,m){if(l&1&&(n(0,"span",15),a(1),i()),l&2){let e=g(2);t(),v(e.currentInventory.name)}}function jn(l,m){if(l&1&&(n(0,"div",13)(1,"div",59)(2,"span",60),a(3),i()(),n(4,"span",56),a(5),i()()),l&2){let e=g().$implicit;t(3),w("",(e.immobilisation.employee_immo==null||e.immobilisation.employee_immo.employee==null||e.immobilisation.employee_immo.employee.first_name==null?null:e.immobilisation.employee_immo.employee.first_name.charAt(0))||"","",(e.immobilisation.employee_immo==null||e.immobilisation.employee_immo.employee==null||e.immobilisation.employee_immo.employee.last_name==null?null:e.immobilisation.employee_immo.employee.last_name.charAt(0))||"",""),t(2),w("",e.immobilisation.employee_immo==null||e.immobilisation.employee_immo.employee==null?null:e.immobilisation.employee_immo.employee.first_name," ",e.immobilisation.employee_immo==null||e.immobilisation.employee_immo.employee==null?null:e.immobilisation.employee_immo.employee.last_name,"")}}function zn(l,m){l&1&&(n(0,"span",54),a(1),r(2,"translate"),i()),l&2&&(t(),v(o(2,1,"NotAssigned")))}function Gn(l,m){if(l&1&&(n(0,"tr")(1,"td")(2,"div",47)(3,"div",48),c(4,"i",49),i(),n(5,"div",50)(6,"h6",51),a(7),i(),n(8,"p",52),a(9),i()()()(),n(10,"td")(11,"span",53),a(12),i()(),n(13,"td"),x(14,jn,6,4,"div",13)(15,zn,3,3,"span",54),i(),n(16,"td")(17,"span",55),a(18),i()(),n(19,"td")(20,"span",56),a(21),i()(),n(22,"td")(23,"span",57),a(24),i()(),n(25,"td")(26,"span",58),a(27),i()()()),l&2){let e=m.$implicit,p=g(4);t(7),v(e.immobilisation.name),t(2),w("",e.immobilisation.mark," ",e.immobilisation.model,""),t(3),v(e.immobilisation.code),t(2),I(e.immobilisation.employee_immo!=null&&e.immobilisation.employee_immo.employee?14:15),t(4),v(e.immobilisation.quantity),t(3),v(p.formatCurrency(e.immobilisation.unit_price||0)),t(3),v(p.formatCurrency(e.immobilisation.unit_price||0)),t(3),v(e.comment||"-")}}function Un(l,m){if(l&1&&(n(0,"table",44)(1,"thead")(2,"tr")(3,"th",46),a(4),r(5,"translate"),i(),n(6,"th",46),a(7),r(8,"translate"),i(),n(9,"th",46),a(10),r(11,"translate"),i(),n(12,"th",46),a(13),r(14,"translate"),i(),n(15,"th",46),a(16),r(17,"translate"),i(),n(18,"th",46),a(19),r(20,"translate"),i(),n(21,"th",46),a(22),r(23,"translate"),i()()(),n(24,"tbody"),F(25,Gn,28,9,"tr",null,pt),i()()),l&2){let e=g(3);t(4),d(" ",o(5,7,"Immobilisation")," "),t(3),d(" ",o(8,9,"Code")," "),t(3),d(" ",o(11,11,"Employee")," "),t(3),d(" ",o(14,13,"Quantity")," "),t(3),d(" ",o(17,15,"UnitPrice")," "),t(3),d(" ",o(20,17,"TotalValue")," "),t(3),d(" ",o(23,19,"Comment")," "),t(3),T(e.missingItems)}}function qn(l,m){l&1&&(n(0,"div",45),c(1,"i",61),n(2,"h5"),a(3),r(4,"translate"),i(),n(5,"p",62),a(6),r(7,"translate"),i()()),l&2&&(t(3),v(o(4,2,"NoMissingItems")),t(3),v(o(7,4,"AllItemsAccountedFor")))}function Hn(l,m){if(l&1&&(n(0,"div",43),x(1,Un,27,21,"table",44)(2,qn,8,6,"div",45),i()),l&2){let e=g(2);t(),I(e.missingItems.length>0?1:2)}}function Qn(l,m){if(l&1&&(n(0,"div",13)(1,"div",59)(2,"span",60),a(3),i()(),n(4,"span",56),a(5),i()()),l&2){let e=g().$implicit;t(3),w("",(e.immobilisation.employee_immo==null||e.immobilisation.employee_immo.employee==null||e.immobilisation.employee_immo.employee.first_name==null?null:e.immobilisation.employee_immo.employee.first_name.charAt(0))||"","",(e.immobilisation.employee_immo==null||e.immobilisation.employee_immo.employee==null||e.immobilisation.employee_immo.employee.last_name==null?null:e.immobilisation.employee_immo.employee.last_name.charAt(0))||"",""),t(2),w("",e.immobilisation.employee_immo==null||e.immobilisation.employee_immo.employee==null?null:e.immobilisation.employee_immo.employee.first_name," ",e.immobilisation.employee_immo==null||e.immobilisation.employee_immo.employee==null?null:e.immobilisation.employee_immo.employee.last_name,"")}}function Wn(l,m){l&1&&(n(0,"span",54),a(1),r(2,"translate"),i()),l&2&&(t(),v(o(2,1,"NotAssigned")))}function Yn(l,m){if(l&1&&(n(0,"tr")(1,"td")(2,"div",47)(3,"div",63),c(4,"i",64),i(),n(5,"div",50)(6,"h6",51),a(7),i(),n(8,"p",52),a(9),i()()()(),n(10,"td")(11,"span",53),a(12),i()(),n(13,"td"),x(14,Qn,6,4,"div",13)(15,Wn,3,3,"span",54),i(),n(16,"td")(17,"span",55),a(18),i()(),n(19,"td")(20,"span",56),a(21),i()(),n(22,"td")(23,"span",65),a(24),i()(),n(25,"td")(26,"span",58),a(27),i()()()),l&2){let e=m.$implicit,p=g(4);t(7),v(e.immobilisation.name),t(2),w("",e.immobilisation.mark," ",e.immobilisation.model,""),t(3),v(e.immobilisation.code),t(2),I(e.immobilisation.employee_immo!=null&&e.immobilisation.employee_immo.employee?14:15),t(4),v(1),t(3),v(p.formatCurrency(e.immobilisation.unit_price||0)),t(3),v(p.formatCurrency(e.immobilisation.unit_price||0)),t(3),v(e.comment||"-")}}function Kn(l,m){if(l&1&&(n(0,"table",44)(1,"thead")(2,"tr")(3,"th",46),a(4),r(5,"translate"),i(),n(6,"th",46),a(7),r(8,"translate"),i(),n(9,"th",46),a(10),r(11,"translate"),i(),n(12,"th",46),a(13),r(14,"translate"),i(),n(15,"th",46),a(16),r(17,"translate"),i(),n(18,"th",46),a(19),r(20,"translate"),i(),n(21,"th",46),a(22),r(23,"translate"),i()()(),n(24,"tbody"),F(25,Yn,28,9,"tr",null,pt),i()()),l&2){let e=g(3);t(4),d(" ",o(5,7,"Immobilisation")," "),t(3),d(" ",o(8,9,"Code")," "),t(3),d(" ",o(11,11,"Employee")," "),t(3),d(" ",o(14,13,"Quantity")," "),t(3),d(" ",o(17,15,"UnitPrice")," "),t(3),d(" ",o(20,17,"TotalValue")," "),t(3),d(" ",o(23,19,"Comment")," "),t(3),T(e.brokenItems)}}function Xn(l,m){l&1&&(n(0,"div",45),c(1,"i",61),n(2,"h5"),a(3),r(4,"translate"),i(),n(5,"p",62),a(6),r(7,"translate"),i()()),l&2&&(t(3),v(o(4,2,"NoBrokenItems")),t(3),v(o(7,4,"AllItemsInGoodCondition")))}function Jn(l,m){if(l&1&&(n(0,"div",43),x(1,Kn,27,21,"table",44)(2,Xn,8,6,"div",45),i()),l&2){let e=g(2);t(),I(e.brokenItems.length>0?1:2)}}function Zn(l,m){if(l&1){let e=B();n(0,"div",11)(1,"div",12)(2,"div",13)(3,"h4",14),a(4),r(5,"translate"),i(),x(6,Rn,2,1,"span",15),i(),n(7,"p",16),a(8),r(9,"translate"),i()(),n(10,"div",17)(11,"button",18),y("click",function(){_(e);let s=g();return f(s.togglePreview())}),c(12,"i",19),a(13),r(14,"translate"),r(15,"translate"),i(),n(16,"button",20),y("click",function(){_(e);let s=g();return f(s.printOrDownloadPDF())}),c(17,"i",21),a(18),r(19,"translate"),i()()(),n(20,"div",11)(21,"div",22)(22,"div",23)(23,"div",24)(24,"div",2)(25,"div",25)(26,"div",26)(27,"p",27),a(28),r(29,"translate"),i(),n(30,"h5",28),a(31),i()()(),n(32,"div",29)(33,"div",30),c(34,"i",31),i()()()()()(),n(35,"div",22)(36,"div",32)(37,"div",24)(38,"div",2)(39,"div",25)(40,"div",26)(41,"p",27),a(42),r(43,"translate"),i(),n(44,"h5",28),a(45),i()()(),n(46,"div",29)(47,"div",30),c(48,"i",33),i()()()()()(),n(49,"div",22)(50,"div",34)(51,"div",24)(52,"div",2)(53,"div",25)(54,"div",26)(55,"p",27),a(56),r(57,"translate"),i(),n(58,"h5",28),a(59),i()()(),n(60,"div",29)(61,"div",30),c(62,"i",35),i()()()()()()(),n(63,"div",11)(64,"div",5)(65,"div",6)(66,"div",36)(67,"ul",37)(68,"li",38)(69,"button",39),y("click",function(){_(e);let s=g();return f(s.setActiveTab("missing"))}),c(70,"i",40),a(71),r(72,"translate"),i()(),n(73,"li",38)(74,"button",39),y("click",function(){_(e);let s=g();return f(s.setActiveTab("broken"))}),c(75,"i",41),a(76),r(77,"translate"),i()()()(),n(78,"div",42),x(79,Hn,3,1,"div",43)(80,Jn,3,1,"div",43),i()()()()}if(l&2){let e=g();t(4),v(o(5,21,"InventoryReport")),t(2),I(e.currentInventory?6:-1),t(2),d(" ",o(9,23,"ManageInventoryDescription")," "),t(5),d(" ",e.showPreview?o(14,25,"Hide"):o(15,27,"Preview")," "),t(5),d(" ",o(19,29,"PrintPDF")," "),t(10),d(" ",o(29,31,"MissingItems")," "),t(3),d(" ",e.missingItems.length," "),t(11),d(" ",o(43,33,"BrokenItems")," "),t(3),d(" ",e.brokenItems.length," "),t(11),d(" ",o(57,35,"EstimatedValue")," "),t(3),d(" ",e.formatCurrency(e.getTotalValue())," "),t(10),N("active",e.activeTab==="missing"),t(2),w(" ",o(72,37,"MissingItems")," (",e.missingItems.length,") "),t(3),N("active",e.activeTab==="broken"),t(2),w(" ",o(77,39,"BrokenItems")," (",e.brokenItems.length,") "),t(3),I(e.activeTab==="missing"?79:-1),t(),I(e.activeTab==="broken"?80:-1)}}function ea(l,m){if(l&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),r(9,"translate"),i(),n(10,"td"),a(11),i(),n(12,"td"),a(13),i(),n(14,"td"),a(15),i(),n(16,"td"),a(17),i()()),l&2){let e=m.$implicit,p=m.$index,s=g(3);t(2),v(p+1),t(2),v(e.immobilisation.code),t(2),v(e.immobilisation.name),t(2),v(s.getEmployeeName(e)||o(9,8,"NotAssigned")),t(3),v(e.immobilisation.quantity||0),t(2),v(s.formatCurrency(e.immobilisation.unit_price||0)),t(2),v(s.formatCurrency(e.immobilisation.unit_price||0)),t(2),v(e.comment||"-")}}function ta(l,m){if(l&1&&(n(0,"div",83)(1,"h5",93),a(2),r(3,"translate"),i(),n(4,"table",94)(5,"thead")(6,"tr")(7,"th"),a(8),r(9,"translate"),i(),n(10,"th"),a(11),r(12,"translate"),i(),n(13,"th"),a(14),r(15,"translate"),i(),n(16,"th"),a(17),r(18,"translate"),i(),n(19,"th"),a(20),r(21,"translate"),i(),n(22,"th"),a(23),r(24,"translate"),i(),n(25,"th"),a(26),r(27,"translate"),i(),n(28,"th"),a(29),r(30,"translate"),i()()(),n(31,"tbody"),F(32,ea,18,10,"tr",null,pt),i(),n(34,"tfoot")(35,"tr",95)(36,"td",96)(37,"strong"),a(38),r(39,"translate"),i()(),n(40,"td")(41,"strong"),a(42),i()(),n(43,"td",97)(44,"strong"),a(45),i()(),c(46,"td"),i()()()()),l&2){let e=g(2);t(2),v(o(3,12,"MissingItems")),t(6),v(o(9,14,"Number")),t(3),v(o(12,16,"Code")),t(3),v(o(15,18,"Designation")),t(3),v(o(18,20,"Employee")),t(3),v(o(21,22,"Quantity")),t(3),v(o(24,24,"UnitValue")),t(3),v(o(27,26,"TotalValue")),t(3),v(o(30,28,"Comment")),t(3),T(e.missingItems),t(6),v(o(39,30,"Total")),t(4),v(e.getTotalMissingQuantity()),t(3),v(e.formatCurrency(e.getTotalMissingValue()))}}function ia(l,m){if(l&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),r(9,"translate"),i(),n(10,"td"),a(11),i(),n(12,"td"),a(13),i(),n(14,"td"),a(15),i(),n(16,"td"),a(17),i()()),l&2){let e=m.$implicit,p=m.$index,s=g(3);t(2),v(p+1),t(2),v(e.immobilisation.code),t(2),v(e.immobilisation.name),t(2),v(s.getEmployeeName(e)||o(9,8,"NotAssigned")),t(3),v(e.immobilisation.quantity||0),t(2),v(s.formatCurrency(e.immobilisation.unit_price||0)),t(2),v(s.formatCurrency(e.immobilisation.unit_price||0)),t(2),v(e.comment||"-")}}function na(l,m){if(l&1&&(n(0,"div",83)(1,"h5",93),a(2),r(3,"translate"),i(),n(4,"table",94)(5,"thead")(6,"tr")(7,"th"),a(8),r(9,"translate"),i(),n(10,"th"),a(11),r(12,"translate"),i(),n(13,"th"),a(14),r(15,"translate"),i(),n(16,"th"),a(17),r(18,"translate"),i(),n(19,"th"),a(20),r(21,"translate"),i(),n(22,"th"),a(23),r(24,"translate"),i(),n(25,"th"),a(26),r(27,"translate"),i(),n(28,"th"),a(29),r(30,"translate"),i()()(),n(31,"tbody"),F(32,ia,18,10,"tr",null,pt),i(),n(34,"tfoot")(35,"tr",95)(36,"td",96)(37,"strong"),a(38),r(39,"translate"),i()(),n(40,"td")(41,"strong"),a(42),i()(),n(43,"td",97)(44,"strong"),a(45),i()(),c(46,"td"),i()()()()),l&2){let e=g(2);t(2),v(o(3,12,"BrokenItems")),t(6),v(o(9,14,"Number")),t(3),v(o(12,16,"Code")),t(3),v(o(15,18,"Designation")),t(3),v(o(18,20,"Employee")),t(3),v(o(21,22,"Quantity")),t(3),v(o(24,24,"UnitValue")),t(3),v(o(27,26,"TotalValue")),t(3),v(o(30,28,"Comment")),t(3),T(e.brokenItems),t(6),v(o(39,30,"Total")),t(4),v(e.getTotalBrokenQuantity()),t(3),v(e.formatCurrency(e.getTotalBrokenValue()))}}function aa(l,m){if(l&1&&(n(0,"div",4)(1,"div",66)(2,"div",11)(3,"div",67)(4,"div",68)(5,"p",69),a(6,"REPUBLIQUE DU CAMEROUN"),i(),n(7,"p",70),a(8,"PAIX-TRAVAIL-PATRIE"),i(),c(9,"div",71),n(10,"p",72),a(11,"PORT AUTONOME DE DOUALA"),i()()(),n(12,"div",73),c(13,"img",74),r(14,"translate"),i(),n(15,"div",67)(16,"div",75)(17,"p",69),a(18),r(19,"translate"),i(),n(20,"p",70),a(21),r(22,"translate"),i(),c(23,"div",71),n(24,"p",72),a(25),r(26,"translate"),i()()()(),n(27,"div",76)(28,"div",77)(29,"h4",78),a(30),r(31,"translate"),i(),n(32,"h5",79),a(33),r(34,"translate"),i()()()(),n(35,"div",80)(36,"div",2)(37,"div",81)(38,"p")(39,"strong"),a(40),r(41,"translate"),i(),a(42),i(),n(43,"p")(44,"strong"),a(45),r(46,"translate"),i(),a(47),r(48,"translate"),i(),n(49,"p")(50,"strong"),a(51),r(52,"translate"),i(),a(53),i()(),n(54,"div",82)(55,"p")(56,"strong"),a(57),r(58,"translate"),i(),a(59),i(),n(60,"p")(61,"strong"),a(62),r(63,"translate"),i(),a(64),i(),n(65,"p")(66,"strong"),a(67),r(68,"translate"),i(),a(69),i()()()(),x(70,ta,47,32,"div",83)(71,na,47,32,"div",83),n(72,"div",84)(73,"div",2)(74,"div",85)(75,"div",86)(76,"p",87),a(77),r(78,"translate"),i(),c(79,"div",88),n(80,"p",89),a(81,"________________________"),i(),n(82,"p",90),a(83),r(84,"translate"),i()()(),n(85,"div",85)(86,"div",86)(87,"p",87),a(88),r(89,"translate"),i(),c(90,"div",88),n(91,"p",89),a(92,"________________________"),i(),n(93,"p",90),a(94),r(95,"translate"),i()()(),n(96,"div",85)(97,"div",86)(98,"p",87),a(99),r(100,"translate"),i(),c(101,"div",88),n(102,"p",89),a(103,"________________________"),i(),n(104,"p",90),a(105),r(106,"translate"),i()()()()(),n(107,"div",91)(108,"p",92)(109,"small"),a(110),r(111,"translate"),r(112,"translate"),i()()()()),l&2){let e=g();t(13),R("alt",o(14,30,"LogoPAD")),t(5),v(o(19,32,"RepublicOfCameroon")),t(3),v(o(22,34,"PeaceWorkFatherland")),t(4),v(o(26,36,"PortAuthorityOfDouala")),t(5),v(o(31,38,"InventoryReport")),t(3),w("",o(34,40,e.currentInventory.type)," - ",e.currentInventory.name,""),t(7),d("",o(41,42,"InventoryName"),":"),t(2),d(" ",e.currentInventory.name,""),t(3),d("",o(46,44,"InventoryType"),":"),t(2),d(" ",o(48,46,e.currentInventory.type),""),t(4),d("",o(52,48,"ReportDate"),":"),t(2),d(" ",e.getCurrentDate(),""),t(4),d("",o(58,50,"TotalMissingItems"),":"),t(2),d(" ",e.missingItems.length,""),t(3),d("",o(63,52,"TotalBrokenItems"),":"),t(2),d(" ",e.brokenItems.length,""),t(3),d("",o(68,54,"EstimatedValue"),":"),t(2),d(" ",e.formatCurrency(e.getTotalValue()),""),t(),I(e.missingItems.length>0?70:-1),t(),I(e.brokenItems.length>0?71:-1),t(6),v(o(78,56,"AssetManager")),t(6),d("",o(84,58,"Date"),": ___________"),t(5),v(o(89,60,"PatrimonyManager")),t(6),d("",o(95,62,"Date"),": ___________"),t(5),v(o(100,64,"GeneralManager")),t(6),d("",o(106,66,"Date"),": ___________"),t(5),Qe(" ",o(111,68,"ReportGeneratedOn")," ",e.getCurrentDate()," - ",o(112,70,"InventoryManagement")," ")}}var st=class l{constructor(m,e,p){this.route=m;this.inventoryService=e;this.languageService=p}inventoryId=null;inventory$;loading$;missingInventories$;brokenInventories$;currentInventory=null;missingItems=[];brokenItems=[];activeTab="missing";showPreview=!1;ngOnInit(){this.inventoryId=this.route.snapshot.paramMap.get("id"),this.inventoryId&&(this.loadInventoryData(),this.loadInventoryReportData())}loadInventoryData(){this.loading$=this.inventoryService.loading$,this.inventoryId&&(this.inventory$=this.inventoryService.getInventoryDetailFromServer(this.inventoryId),this.inventory$.subscribe(m=>{this.currentInventory=m}))}loadInventoryReportData(){this.inventoryId&&(this.missingInventories$=this.inventoryService.missingInventories$,this.inventoryService.getMissingInventoriesFromServer({current_page:1,per_page:1e3},[k("inventory_id",this.inventoryId)]),this.missingInventories$.subscribe(m=>{this.missingItems=m}),this.brokenInventories$=this.inventoryService.brokenInventories$,this.inventoryService.getBrokenInventoriesFromServer({current_page:1,per_page:1e3},[k("inventory_id",this.inventoryId)]),this.brokenInventories$.subscribe(m=>{this.brokenItems=m}))}setActiveTab(m){this.activeTab=m}togglePreview(){this.showPreview=!this.showPreview}printOrDownloadPDF(){window.print()}getTotalItems(){return this.missingItems.length+this.brokenItems.length}getTotalValue(){let m=0;return this.missingItems.forEach(e=>{e.immobilisation&&e.immobilisation.unit_price&&e.immobilisation.quantity&&(m+=e.immobilisation.unit_price)}),this.brokenItems.forEach(e=>{e.immobilisation&&e.immobilisation.unit_price&&e.immobilisation.quantity&&(m+=e.immobilisation.unit_price)}),m}getTotalMissingQuantity(){return this.missingItems.reduce((m,e)=>m+(e.immobilisation?.quantity||0),0)}getTotalBrokenQuantity(){return this.brokenItems.reduce((m,e)=>m+(e.immobilisation?.quantity||0),0)}getTotalMissingValue(){return this.missingItems.reduce((m,e)=>e.immobilisation&&e.immobilisation.unit_price&&e.immobilisation.quantity?m+e.immobilisation.unit_price*e.immobilisation.quantity:m,0)}getTotalBrokenValue(){return this.brokenItems.reduce((m,e)=>e.immobilisation&&e.immobilisation.unit_price&&e.immobilisation.quantity?m+e.immobilisation.unit_price*e.immobilisation.quantity:m,0)}formatDate(m){return new Date(m).toLocaleDateString("fr-FR")}getCurrentDate(){return new Date().toLocaleDateString("fr-FR")}getEmployeeName(m){if(m.immobilisation?.employee_immo?.employee){let e=m.immobilisation.employee_immo.employee;return`${e.first_name} ${e.last_name}`}return""}formatCurrency(m){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(m)}static \u0275fac=function(e){return new(e||l)(h(U),h(M),h(j))};static \u0275cmp=D({type:l,selectors:[["app-report-inventory"]],standalone:!1,decls:7,vars:6,consts:[[1,"container-fluid","py-4"],[1,"no-print"],[1,"row"],["id","inventoryReport",1,"print-section"],[1,"report-container"],[1,"col-12"],[1,"card"],[1,"card-body","text-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"text-muted","mt-3"],[1,"row","mb-4"],[1,"col-lg-8","col-md-6","col-12"],[1,"d-flex","align-items-center"],[1,"mb-0","text-dark"],[1,"badge","bg-gradient-info","ms-2"],[1,"text-sm","text-secondary","mb-0"],[1,"col-lg-4","col-md-6","col-12","text-end"],[1,"btn","btn-outline-primary","btn-sm","me-2",3,"click"],[1,"fas","fa-eye","me-2"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-print","me-2"],[1,"col-md-4"],[1,"card","bg-gradient-warning"],[1,"card-body","p-3"],[1,"col-8"],[1,"numbers"],[1,"text-white","text-sm","mb-0","text-capitalize","font-weight-bold"],[1,"text-white","font-weight-bolder","mb-0"],[1,"col-4","text-end"],[1,"icon","icon-shape","bg-white","shadow","text-center","border-radius-md"],[1,"fas","fa-exclamation-triangle","text-warning","text-lg","opacity-10"],[1,"card","bg-gradient-danger"],[1,"fas","fa-tools","text-danger","text-lg","opacity-10"],[1,"card","bg-gradient-info"],[1,"fas","fa-coins","text-info","text-lg","opacity-10"],[1,"card-header"],["role","tablist",1,"nav","nav-tabs","card-header-tabs"],["role","presentation",1,"nav-item"],["type","button",1,"nav-link",3,"click"],[1,"fas","fa-exclamation-triangle","text-warning","me-2"],[1,"fas","fa-tools","text-danger","me-2"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-hover","align-items-center","mb-0"],[1,"text-center","py-4"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7"],[1,"d-flex","px-2","py-1"],[1,"avatar","avatar-sm","bg-gradient-warning","me-3"],[1,"fas","fa-exclamation-triangle","text-white"],[1,"d-flex","flex-column","justify-content-center"],[1,"mb-0","text-sm"],[1,"text-xs","text-secondary","mb-0"],[1,"badge","bg-gradient-secondary"],[1,"text-muted","text-sm"],[1,"text-sm","font-weight-bold"],[1,"text-sm"],[1,"text-sm","font-weight-bold","text-warning"],[1,"text-xs"],[1,"avatar","avatar-xs","bg-gradient-info","me-2"],[1,"text-white","text-xs"],[1,"fas","fa-check-circle","text-success","fa-3x","mb-3"],[1,"text-muted"],[1,"avatar","avatar-sm","bg-gradient-danger","me-3"],[1,"fas","fa-tools","text-white"],[1,"text-sm","font-weight-bold","text-danger"],[1,"report-header"],[1,"col-3"],[1,"header-left"],[1,"header-country"],[1,"header-motto"],[1,"separator-line-small"],[1,"header-org"],[1,"col-6","text-center"],["src","/assets/img/logo-port.png",1,"report-logo-center",3,"alt"],[1,"header-right"],[1,"row","mt-4"],[1,"col-12","text-center"],[1,"report-title"],[1,"report-subtitle"],[1,"report-info","mb-4"],[1,"col-6"],[1,"col-6","text-end"],[1,"report-section","mb-5"],[1,"report-signatures","mt-5"],[1,"col-4","text-center"],[1,"signature-box"],[1,"signature-title"],[1,"signature-line"],[1,"signature-name"],[1,"signature-date"],[1,"report-footer","mt-4"],[1,"text-center"],[1,"section-title"],[1,"report-table"],[1,"total-row"],["colspan","4"],["colspan","2"]],template:function(e,p){e&1&&(n(0,"div",0)(1,"div",1),x(2,Nn,11,6,"div",2),r(3,"async"),x(4,Zn,81,41),i(),n(5,"div",3),x(6,aa,113,72,"div",4),i()()),e&2&&(t(2),I(o(3,4,p.loading$)?2:4),t(3),N("d-none",!p.showPreview),t(),I(p.currentInventory?6:-1))},dependencies:[P,O],styles:[".no-print[_ngcontent-%COMP%]{display:block!important}.print-section[_ngcontent-%COMP%]{display:none}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{border:none;background:transparent;color:#8392ab;padding:.75rem 1rem;border-radius:.5rem;margin-right:.5rem;transition:all .3s ease}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{background-color:#ffffff1a;color:#344767}.nav-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background:linear-gradient(310deg,#17ad37,#98ec2d);color:#fff;border:none;box-shadow:0 4px 6px #17ad374d}.report-container[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif;background:#fff;padding:2rem;border:1px solid #ddd;border-radius:8px;box-shadow:0 4px 15px #0000001a}.report-header[_ngcontent-%COMP%]{border-bottom:2px solid #2c5aa0;padding-bottom:1rem;margin-bottom:2rem}.header-left[_ngcontent-%COMP%], .header-right[_ngcontent-%COMP%]{text-align:center;font-size:.75rem;line-height:1.2}.header-country[_ngcontent-%COMP%]{font-weight:700;color:#2c5aa0;margin-bottom:.2rem}.header-motto[_ngcontent-%COMP%]{font-style:italic;color:#666;margin-bottom:.5rem}.header-org[_ngcontent-%COMP%]{font-weight:700;color:#2c5aa0;margin-bottom:.1rem}.header-abbr[_ngcontent-%COMP%]{color:#2c5aa0;font-weight:700;margin-bottom:.5rem}.header-direction[_ngcontent-%COMP%], .header-department[_ngcontent-%COMP%], .header-office[_ngcontent-%COMP%]{color:#444;font-size:.7rem;margin-bottom:.1rem}.separator-line-small[_ngcontent-%COMP%]{border-bottom:1px solid #2c5aa0;margin:.3rem auto;width:80%}.report-logo-center[_ngcontent-%COMP%]{max-height:80px;width:auto}.report-title[_ngcontent-%COMP%]{color:#2c5aa0;font-weight:700;font-size:1.5rem;text-transform:uppercase;letter-spacing:1px;margin-bottom:.5rem}.report-subtitle[_ngcontent-%COMP%]{color:#666;font-size:1.1rem;font-weight:400;margin-bottom:0}.report-info[_ngcontent-%COMP%]{background-color:#f8f9fa;padding:1rem;border-radius:5px;border-left:4px solid #2c5aa0}.report-section[_ngcontent-%COMP%]{margin-bottom:2rem}.section-title[_ngcontent-%COMP%]{color:#2c5aa0;font-weight:700;font-size:1.1rem;border-bottom:2px solid #2c5aa0;padding-bottom:.5rem;margin-bottom:1rem}.report-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:1rem;font-size:.85rem;border:1px solid #ddd}.report-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:linear-gradient(310deg,#2c5aa0,#4169e1);color:#fff;padding:8px 6px;text-align:center;font-weight:700;font-size:.75rem;text-transform:uppercase;border:1px solid #2c5aa0}.report-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:6px 4px;border:1px solid #ddd;text-align:center;font-size:.8rem}.report-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f8f9fa}.report-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e3f2fd}.report-table[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{background-color:#e8f4f8!important;font-weight:700;border-top:2px solid #2c5aa0}.report-table[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#e8f4f8;font-weight:700;color:#2c5aa0}.report-signatures[_ngcontent-%COMP%]{margin-top:3rem;padding-top:2rem;border-top:1px solid #ddd}.signature-box[_ngcontent-%COMP%]{padding:1rem}.signature-title[_ngcontent-%COMP%]{font-weight:700;color:#2c5aa0;margin-bottom:2rem;text-transform:uppercase;font-size:.9rem}.signature-line[_ngcontent-%COMP%]{height:60px;border-bottom:1px solid #666;margin-bottom:.5rem}.signature-name[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.5rem}.signature-date[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.report-footer[_ngcontent-%COMP%]{border-top:1px solid #ddd;padding-top:1rem;color:#666;font-size:.8rem}@media print{.no-print[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%], .nav-tabs[_ngcontent-%COMP%], .card-header[_ngcontent-%COMP%]{display:none!important}.print-section[_ngcontent-%COMP%]{display:block!important}@page{size:A4;margin:1cm}body[_ngcontent-%COMP%]{background:#fff!important;color:#000!important;font-size:12px;line-height:1.4}.container-fluid[_ngcontent-%COMP%]{padding:0!important;max-width:none!important}.report-container[_ngcontent-%COMP%]{box-shadow:none;border:none;padding:0;background:#fff}.report-table[_ngcontent-%COMP%]{font-size:10px!important;page-break-inside:avoid}.report-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:9px!important;padding:4px 2px!important}.report-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:9px!important;padding:3px 2px!important}.report-section[_ngcontent-%COMP%]{page-break-inside:avoid}.report-signatures[_ngcontent-%COMP%]{page-break-inside:avoid;margin-top:2rem}.report-header[_ngcontent-%COMP%]{margin-bottom:1rem}.header-left[_ngcontent-%COMP%], .header-right[_ngcontent-%COMP%]{font-size:8px!important}.report-title[_ngcontent-%COMP%]{font-size:16px!important}.report-subtitle[_ngcontent-%COMP%]{font-size:12px!important}.report-logo-center[_ngcontent-%COMP%]{max-height:60px}.signature-box[_ngcontent-%COMP%]{padding:.5rem}.signature-line[_ngcontent-%COMP%]{height:40px}.signature-title[_ngcontent-%COMP%]{font-size:10px!important;margin-bottom:1rem}.signature-name[_ngcontent-%COMP%], .signature-date[_ngcontent-%COMP%]{font-size:9px!important}}@media (max-width: 768px){.report-container[_ngcontent-%COMP%]{padding:1rem}.report-table[_ngcontent-%COMP%]{font-size:.75rem}.report-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .report-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:4px 2px;font-size:.7rem}.header-left[_ngcontent-%COMP%], .header-right[_ngcontent-%COMP%]{font-size:.65rem}.report-title[_ngcontent-%COMP%]{font-size:1.2rem}.report-subtitle[_ngcontent-%COMP%]{font-size:1rem}}"]})};var ra=[{path:"",component:tt},{path:"detail/:id",component:nt},{path:"report-inventory/:id",component:st},{path:"missing-inventory",component:at},{path:"missing-inventory/detail/:id",component:rt},{path:"broken-inventory",component:ot},{path:"broken-inventory/detail/:id",component:lt}],mt=class l{static \u0275fac=function(e){return new(e||l)};static \u0275mod=qe({type:l});static \u0275inj=Ue({imports:[dt.forChild(ra),dt]})};var $t=class l{static \u0275fac=function(e){return new(e||l)};static \u0275mod=qe({type:l});static \u0275inj=Ue({providers:[j],imports:[Et,mt,Tt,Ft,kt.forRoot({loader:{provide:Bt,useFactory:Pt,deps:[Je]}}),Dt]})};export{$t as InventoryModule};
