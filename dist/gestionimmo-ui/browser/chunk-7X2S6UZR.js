import{a as jt}from"./chunk-3D2ISESY.js";import{a as ze}from"./chunk-ZQ2JTUCM.js";import{a as Be,b as Ee,d as Ie,e as P,f as je,h as we,i as Nt}from"./chunk-6A4UEKQR.js";import{$ as F,$a as K,A as tt,Ab as wt,Ba as w,Bc as z,Cb as M,D as St,Db as kt,E as it,Ea as Ve,Eb as O,Fa as Ae,G as Ze,Ga as $e,Gc as Vt,Hc as Ue,Ia as r,Ja as d,Jc as Ge,Ka as f,Kc as At,La as E,Lc as oe,M as h,Ma as Bt,Mc as $t,N as x,Oa as ve,Pa as ee,Pc as zt,Q as yt,Qa as te,Qc as Ut,Ra as ie,S as ue,Sc as Gt,Ta as rt,X as i,Xa as a,Ya as o,Z as y,Za as be,_a as ne,aa as nt,ac as Ft,bc as Dt,ca as ge,da as C,ec as N,f as Re,g as Te,ga as S,gc as T,ha as V,hb as Y,hc as j,ia as D,ib as Ne,ic as he,jb as Q,k as A,kc as ot,la as B,lb as R,lc as Me,mc as xe,na as Le,nb as _e,nc as Mt,oa as H,oc as Ce,pa as W,pb as re,pc as Se,qa as n,qb as ae,qc as ye,ra as t,rb as Et,rc as Ot,s as ce,sa as c,sc as Pt,tb as at,tc as Rt,ub as J,v as fe,va as I,vb as G,vc as Tt,wb as It,wc as q,xa as v,xb as _t,ya as _,yc as Lt,zb as $}from"./chunk-SPLMNZOI.js";var k=class m extends Dt{constructor(e,l,s,u){super(e,l,u);this.https=e;this.snak=l;this.router=s;this.injector_=u}_entreprises$=new Te([]);get entreprises$(){return this._entreprises$.asObservable()}_buyers$=new Te([]);get buyers$(){return this._buyers$.asObservable()}_reformeBrokens$=new Te([]);get reformeBrokens$(){return this._reformeBrokens$.asObservable()}_cessions$=new Te([]);get cessions$(){return this._cessions$.asObservable()}_sales$=new Te([]);get sales$(){return this._sales$.asObservable()}getEntreprisesFromServer(e=this.emptyPaginate,l=[]){let s=this.getHearder(),u=this.explosePaginationOption(e),b=je(l);u+=b?`&${b}`:"",this.setLoadStatus(!0),this.https.get(`${$.apiUrlFirst}/admin/entreprises/all?${u}`,s).pipe(A(g=>{this.setLoadStatus(!1),this._entreprises$.next(g.data?.data??[]),this._paginateData$.next({current_page:g.data?.current_page??0,per_page:g.data?.per_page??10})})).subscribe()}getEntrepriseDetailFromServer(e){let l=this.getHearder();return this.setLoadStatus(!0),this.https.get(`${$.apiUrlFirst}/admin/entreprises/${e}`,l).pipe(A(s=>(this.setLoadStatus(!1),s.data)))}createEntreprise(e){let l=this.getHearder();this.setLoadStatus(!0),this.https.post(`${$.apiUrlFirst}/admin/entreprises/create`,e,l).pipe(A(s=>{this.setLoadStatus(!1),s.success?(this.setSnackMesage(s.message,"success"),this.setConfirmSubmit(!0)):this.setSnackMesage(s.error,"btn-warning")})).subscribe()}updateEntreprise(e,l){let s=this.getHearder();this.setLoadStatus(!0),this.https.put(`${$.apiUrlFirst}/admin/entreprises/update/${e}`,l,s).pipe(A(u=>{this.setLoadStatus(!1),u.success?(this.setSnackMesage(u.message,"btn-success"),this.setConfirmSubmit(!0)):this.setSnackMesage(u.error,"btn-warning")})).subscribe()}getBuyerFromServer(e=this.emptyPaginate,l=[]){let s=this.getHearder(),u=this.explosePaginationOption(e),b=je(l);u+=b?`&${b}`:"",this.setLoadStatus(!0),this.https.get(`${$.apiUrlFirst}/admin/buyers/all?${u}`,s).pipe(A(g=>{this.setLoadStatus(!1),this._buyers$.next(g.data?.data??[]),this._paginateData$.next({current_page:g.data?.current_page??0,per_page:g.data?.per_page??10})})).subscribe()}getBuyerDetailFromServer(e){let l=this.getHearder();return this.setLoadStatus(!0),this.https.get(`${$.apiUrlFirst}/admin/buyers/${e}`,l).pipe(A(s=>(this.setLoadStatus(!1),s.data)))}createBuyer(e){let l=this.getHearder();this.setLoadStatus(!0),this.https.post(`${$.apiUrlFirst}/admin/buyers/create`,e,l).pipe(A(s=>{this.setLoadStatus(!1),s.success?(this.setSnackMesage(s.message,"success"),this.setConfirmSubmit(!0)):this.setSnackMesage(s.error,"btn-warning")})).subscribe()}updateBuyer(e,l){let s=this.getHearder();this.setLoadStatus(!0),this.https.put(`${$.apiUrlFirst}/admin/buyers/update/${e}`,l,s).pipe(A(u=>{this.setLoadStatus(!1),u.success?(this.setSnackMesage(u.message,"btn-success"),this.setConfirmSubmit(!0)):this.setSnackMesage(u.error,"btn-warning")})).subscribe()}getBuyersFullFromServer(e=[]){let l=this.getHearder();this.setLoadStatus(!0),this.https.get(`${$.apiUrlFirst}/admin/buyers/full-all`,l).pipe(A(s=>{this.setLoadStatus(!1),console.log(s),this._buyers$.next(s.data??[])})).subscribe()}getReformeBrokenFromServer(e=this.emptyPaginate,l=[]){let s=this.getHearder(),u=this.explosePaginationOption(e),b=je(l);u+=b?`&${b}`:"",this.setLoadStatus(!0),this.https.get(`${$.apiUrlFirst}/admin/reformes/brokens?${u}`,s).pipe(A(g=>{this.setLoadStatus(!1),this._reformeBrokens$.next(g.data?.data??[]),this._paginateData$.next({current_page:g.data?.current_page??0,per_page:g.data?.per_page??10})})).subscribe()}getReformeBrokenDetailFromServer(e){let l=this.getHearder();return this.setLoadStatus(!0),this.https.get(`${$.apiUrlFirst}/admin/reformes/broken/${e}`,l).pipe(A(s=>(this.setLoadStatus(!1),s.data)))}createReformeBroken(e){let l=this.getHearder();this.setLoadStatus(!0),this.https.post(`${$.apiUrlFirst}/admin/reformes/broken`,e,l).pipe(A(s=>{this.setLoadStatus(!1),s.success?(this.setSnackMesage(s.message,"success"),this.setConfirmSubmit(!0)):this.setSnackMesage(s.error,"btn-warning")})).subscribe()}updateReformeBroken(e,l){let s=this.getHearder();this.setLoadStatus(!0),this.https.put(`${$.apiUrlFirst}/admin/reformes/broken/update/${e}`,l,s).pipe(A(u=>{this.setLoadStatus(!1),u.success?(this.setSnackMesage(u.message,"btn-success"),this.setConfirmSubmit(!0)):this.setSnackMesage(u.error,"btn-warning")})).subscribe()}getCessionFromServer(e=this.emptyPaginate,l=[]){let s=this.getHearder(),u=this.explosePaginationOption(e),b=je(l);u+=b?`&${b}`:"",this.setLoadStatus(!0),this.https.get(`${$.apiUrlFirst}/admin/reformes/cessions?${u}`,s).pipe(A(g=>{this.setLoadStatus(!1),this._cessions$.next(g.data?.data??[]),this._paginateData$.next({current_page:g.data?.current_page??0,per_page:g.data?.per_page??10})})).subscribe()}getCessionDetailFromServer(e){let l=this.getHearder();return this.setLoadStatus(!0),this.https.get(`${$.apiUrlFirst}/admin/reformes/cession/${e}`,l).pipe(A(s=>(this.setLoadStatus(!1),s.data)))}createCession(e){let l=this.getHearder();this.setLoadStatus(!0),this.https.post(`${$.apiUrlFirst}/admin/re
formes/cession`,e,l).pipe(A(s=>{this.setLoadStatus(!1),s.success?(this.setSnackMesage(s.message,"success"),this.setConfirmSubmit(!0)):this.setSnackMesage(s.error,"btn-warning")})).subscribe()}getReformeSaleFromServer(e=this.emptyPaginate,l=[]){let s=this.getHearder(),u=this.explosePaginationOption(e),b=je(l);u+=b?`&${b}`:"",this.setLoadStatus(!0),this.https.get(`${$.apiUrlFirst}/admin/reformes/sales?${u}`,s).pipe(A(g=>{this.setLoadStatus(!1),this._sales$.next(g.data?.data??[]),this._paginateData$.next({current_page:g.data?.current_page??0,per_page:g.data?.per_page??10})})).subscribe()}getReformeSaleDetailFromServer(e){let l=this.getHearder();return this.setLoadStatus(!0),this.https.get(`${$.apiUrlFirst}/admin/reformes/sale/${e}`,l).pipe(A(s=>(this.setLoadStatus(!1),s.data)))}createReformeSale(e){let l=this.getHearder();this.setLoadStatus(!0),this.https.post(`${$.apiUrlFirst}/admin/reformes/sale`,e,l).pipe(A(s=>{this.setLoadStatus(!1),s.success?(this.setSnackMesage(s.message,"success"),this.setConfirmSubmit(!0)):this.setSnackMesage(s.error,"btn-warning")})).subscribe()}static \u0275fac=function(l){return new(l||m)(Ze(at),Ze(Ft),Ze(G),Ze(yt))};static \u0275prov=St({token:m,factory:m.\u0275fac,providedIn:"root"})};function Xt(m,p){if(m&1&&(n(0,"div",48)(1,"div",2),c(2,"i",49),n(3,"span"),r(4),t()(),c(5,"button",50),t()),m&2){let e=_();i(4),d(e.message)}}function Yt(m,p){m&1&&C(0,Xt,6,1,"div",48),m&2&&B(p.status?0:-1)}function Jt(m,p){if(m&1&&(n(0,"div",20),c(1,"i",51),r(2),t()),m&2){let e=_();i(2),f(" ",e.getFormControlErrorText(e.entrepriseForm.get("name"))," ")}}function Kt(m,p){if(m&1&&(n(0,"div",20),c(1,"i",51),r(2),t()),m&2){let e=_();i(2),f(" ",e.getFormControlErrorText(e.entrepriseForm.get("nui"))," ")}}function Zt(m,p){if(m&1&&(n(0,"div",20),c(1,"i",51),r(2),t()),m&2){let e=_();i(2),f(" ",e.getFormControlErrorText(e.entrepriseForm.get("tel"))," ")}}function ei(m,p){if(m&1&&(n(0,"div",20),c(1,"i",51),r(2),t()),m&2){let e=_();i(2),f(" ",e.getFormControlErrorText(e.entrepriseForm.get("adresse"))," ")}}function ti(m,p){if(m&1&&(n(0,"div",20),c(1,"i",51),r(2),t()),m&2){let e=_();i(2),f(" ",e.getFormControlErrorText(e.entrepriseForm.get("is_physic"))," ")}}function ii(m,p){m&1&&(n(0,"div",46)(1,"span",52),r(2),a(3,"translate"),t()()),m&2&&(i(2),d(o(3,1,"Loading")))}function ni(m,p){if(m&1&&c(0,"i",53),m&2){let e=_();D(e.entrepriseId?"fa-edit":"fa-plus")}}var ke=class m{constructor(p,e,l,s){this.languageService=p;this.activeModal=e;this.formBuilder=l;this.reformeService=s}reload=new ue;entrepriseId;loading$;entrepriseForm;btnSubmit=!1;error$;confirmSubmit$;ngOnInit(){this.loading$=this.reformeService.loading$,this.reformeService.setLoadStatus(!1),this.initForm()}confirm(){this.activeModal&&this.activeModal.close()}dismiss(){this.activeModal&&this.activeModal.dismiss()}initForm(){this.error$=this.reformeService.error$,this.confirmSubmit$=this.reformeService.confirmSubmit$,this.confirmSubmit$.subscribe(p=>{this.btnSubmit&&p&&(this.reload.emit(!0),this.dismiss())}),this.entrepriseId?this.entrepriseForm=this.formBuilder.group({name:[""],nui:[""],tel:[""],adresse:[""],is_physic:[!1]}):this.entrepriseForm=this.formBuilder.group({name:["",T.required],nui:["",T.required],tel:["",T.required],adresse:["",T.required],is_physic:[!1,T.required]}),console.log("Entreprise ID:",this.entrepriseId),this.entrepriseId&&this.reformeService.getEntrepriseDetailFromServer(this.entrepriseId).subscribe(e=>{console.log("Entreprise detail:",e),this.entrepriseForm.patchValue(e)})}submitForm(){this.entrepriseForm.valid?(this.btnSubmit=!0,console.log(this.entrepriseForm.value),this.entrepriseId?this.reformeService.updateEntreprise(this.entrepriseId,this.entrepriseForm.value):this.reformeService.createEntreprise(this.entrepriseForm.value)):(console.log("Form is invalid:",this.entrepriseForm.value),this.btnSubmit=!0)}getFormControlErrorText(p){return p?.hasError("required")?this.languageService.instant("FieldRequired"):p?.hasError("minlength")?this.languageService.instant("FieldTooShort"):p?.hasError("maxlength")?this.languageService.instant("FieldTooLong"):""}static \u0275fac=function(e){return new(e||m)(y(O),y(Be,8),y(q),y(k))};static \u0275cmp=F({type:m,selectors:[["app-create-entreprise"]],inputs:{entrepriseId:"entrepriseId"},outputs:{reload:"reload"},standalone:!1,decls:113,vars:90,consts:[[1,"modal-content"],[1,"modal-header","bg-gradient-primary","text-white","border-0"],[1,"d-flex","align-items-center"],[1,"icon","icon-shape","icon-sm","bg-white","text-primary","rounded-circle","me-3"],[1,"fas","fa-building"],[1,"modal-title","mb-0","text-white"],[1,"text-white-50","mb-0","text-sm"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close","btn-close-white",3,"click"],[1,"modal-body","p-3"],["novalidate","",1,"needs-validation",3,"formGroup"],[1,"row"],[1,"col-12","mb-3"],[1,"form-group"],[1,"form-label","text-dark","font-weight-bold"],[1,"fas","fa-building","text-primary","me-2"],[1,"text-danger"],[1,"input-group"],[1,"input-group-text","bg-light"],[1,"fas","fa-tag","text-muted"],["type","text","id","name","formControlName","name",1,"form-control",3,"placeholder"],[1,"invalid-feedback","d-block"],[1,"col-md-6","mb-3"],[1,"fas","fa-id-card","text-primary","me-2"],[1,"fas","fa-hashtag","text-muted"],["type","text","id","nui","formControlName","nui",1,"form-control",3,"placeholder"],[1,"fas","fa-phone","text-primary","me-2"],[1,"fas","fa-phone","text-muted"],["type","tel","id","tel","formControlName","tel",1,"form-control",3,"placeholder"],[1,"fas","fa-map-marker-alt","text-primary","me-2"],[1,"fas","fa-location-arrow","text-muted"],["id","adresse","rows","2","formControlName","adresse",1,"form-control",3,"placeholder"],[1,"col-12","mb-2"],[1,"fas","fa-users","text-primary","me-2"],[1,"position-relative"],["formControlName","is_physic",1,"form-select"],["value","","disabled","","selected",""],[3,"value"],[1,"fas","fa-building","me-2"],[1,"fas","fa-user","me-2"],[1,"form-text","text-muted"],[1,"fas","fa-info-circle","me-1"],[1,"modal-footer","bg-light","border-0"],[1,"d-flex","w-100","gap-2"],["type","button",1,"btn","btn-outline-secondary","flex-fill",3,"click"],[1,"fas","fa-times","me-2"],["type","submit",1,"btn","flex-fill",3,"click"],["role","status",1,"spinner-border","spinner-border-sm","me-2"],[1,"me-2",3,"class"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button","data-bs-dismiss","alert",1,"btn-close"],[1,"fas","fa-exclamation-circle","me-1"],[1,"visually-hidden"],[1,"me-2"]],template:function(e,l){if(e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),c(4,"i",4),t(),n(5,"div")(6,"h5",5),r(7),a(8,"translate"),a(9,"translate"),t(),n(10,"p",6),r(11),a(12,"translate"),t()()(),n(13,"button",7),v("click",function(){return l.dismiss()}),t()(),n(14,"div",8),C(15,Yt,1,1),a(16,"async"),n(17,"form",9)(18,"div",10)(19,"div",11)(20,"div",12)(21,"label",13),c(22,"i",14),r(23),a(24,"translate"),n(25,"span",15),r(26,"*"),t()(),n(27,"div",16)(28,"span",17),c(29,"i",18),t(),c(30,"input",19),a(31,"translate"),t(),C(32,Jt,3,1,"div",20),t()(),n(33,"div",21)(34,"div",12)(35,"label",13),c(36,"i",22),r(37),a(38,"translate"),n(39,"span",15),r(40,"*"),t()(),n(41,"div",16)(42,"span",17),c(43,"i",23),t(),c(44,"input",24),a(45,"translate"),t(),C(46,Kt,3,1,"div",20),t()(),n(47,"div",21)(48,"div",12)(49,"label",13),c(50,"i",25),r(51),a(52,"translate"),n(53,"span",15),r(54,"*"),t()(),n(55,"div",16)(56,"span",17),c(57,"i",26),t(),c(58,"input",27),a(59,"translate"),t(),C(60,Zt,3,1,"div",20),t()(),n(61,"div",11)(62,"div",12)(63,"label",13),c(64,"i",28),r(65),a(66,"translate"),n(67,"span",15),r(68,"*"),t()(),n(69,"div",16)(70,"span",17),c(71,"i",29),t(),c(72,"textarea",30),a(73,"translate"),t(),C(74,ei,3,1,"div",20),t()(),n(75,"div",31)(76,"div",12)(77,"label",13),c(78,"i",32),r(79),a(80,"translate"),n(81,"span",15),r(82,"*"),t()(),n(83,"div",33)(84,"select",34)(85,"option",35),r(86),a(87,"translate"),t(),n(88,"option",36),c(89,"i",37),r(90),a(91,"translate"),t(),n(92,"option",36),c(93,"i",38),r(94),a(95,"translate"),t()()(),C(96,ti,3,1,"div",20),n(97,"div",39),c(98,"i",40),r(99),a(100,"translate"),t()()()()()(),n(101,"div",41)(102,"div",42)(103,"button",43),v("click",function(){return l.dismiss()}),c(104,"i",44),r(105),a(106,"translate"),t(),n(107,"button",45),v("click",function(){return l.submitForm()}),C(108,ii,4,3,"div",46),a(109,"async"),C(110,ni,1,2,"i",47),r(111),a(112,"translate"),t()()()()),e&2){let s,u,b,g,L,U,pe,We,Qe,Xe,Ye,Je,Ke,ht,xt,Ct;i(7),E(" ",l.entrepriseId?"Update":o(8,50,"Create")," ",o(9,52,"Company")," "),i(4),f(" ",l.entrepriseId?"ModifyCompanyDetails":o(12,54,"AddNewCompanyToSystem")," "),i(4),B((s=o(16,56,l.error$))?15:-1,s),i(2),S("formGroup",l.entrepriseForm),i(6),f(" ",o(24,58,"CompanyName")," "),i(7),V("is-invalid",l.btnSubmit&&((u=l.entrepriseForm.get("name"))==null?null:u.invalid))("is-valid",(b=l.entrepriseForm.get("name"))==null?null:b.valid),w("placeholder",o(31,60,"EnterCompanyName")),i(2),B(l.btnSubmit&&l.entrepriseForm.invalid&&((g=l.entrepriseForm.get("name"))!=null&&g.invalid)?32:-1),i(5),f(" ",o(38,62,"NUI")," "),i(7),V("is-invalid",l.btnSubmit&&((L=l.entrepriseForm.get("nui"))==null?null:L.invalid))("is-valid",(U=l.entrepriseForm.get("nui"))==null?null:U.valid),w("placeholder",o(45,64,"EnterNUI")),i(2),B(l.btnSubmit&&l.entrepriseForm.invalid&&((pe=l.entrepriseForm.get("nui"))!=null&&pe.invalid)?46:-1),i(5),f(" ",o(52,66,"Phone")," "),i(7),V("is-invalid",l.btnSubmit&&((We=l.entrepriseForm.get("tel"))==null?null:We.invalid))("is-valid",(Qe=l.entrepriseForm.get("tel"))==null?null:Qe.valid),w("placeholder",o(59,68,"EnterPhoneNumber")),i(2),B(l.btnSubmit&&l.entrepriseForm.invalid&&((Xe=l.entrepriseForm.get("tel"))!=null&&Xe.invalid)?60:-1),i(5),f(" ",o(66,70,"Address")," "),i(7),V("is-invalid",l.btnSubmit&&((Ye=l.entrepriseForm.get("adresse"))==null?null:Ye.invalid))("is-valid",(Je=l.entrepriseForm.get("adresse"))==null?null:Je.valid),w("placeholder",o(73,72,"EnterAddress")),i(2),B(l.btnSubmit&&l.entrepriseForm.invalid&&((Ke=l.entrepriseForm.get("adresse"))!=null&&Ke.invalid)?74:-1),i(5),f(" ",o(80,74,"CompanyType")," "),i(5),V("is-invalid",l.btnSubmit&&((ht=l.entrepriseForm.get("is_physic"))==null?null:ht.invalid))("is-valid",(xt=l.entrepriseForm.get("is_physic"))==null?null:xt.valid),i(2),d(o(87,76,"SelectCompanyType")),i(2),S("value",0),i(2),f(" ",o(91,78,"LegalEntity")," "),i(2),S("value",1),i(2),f(" ",o(95,80,"Individual")," "),i(2),B(l.btnSubmit&&l.entrepriseForm.invalid&&((Ct=l.entrepriseForm.get("is_physic"))!=null&&Ct.invalid)?96:-1),i(3),f(" ",o(100,82,"SelectCompanyTypeInfo")," "),i(6),f(" ",o(106,84,"Cancel")," "),i(2),D(l.entrepriseId?"btn-warning":"btn-primary"),i(),B(o(109,86,l.loading$)?108:110),i(3),f(" ",l.entrepriseId?"Update":o(112,88,"Create")," ")}},dependencies:[xe,Pt,Rt,N,Ot,j,he,Se,ye,R,M],styles:[".modal-content[_ngcontent-%COMP%]{border-radius:15px;border:none;box-shadow:0 10px 40px #00000026}.modal-header[_ngcontent-%COMP%]{border-radius:15px 15px 0 0;padding:1.5rem}.modal-body[_ngcontent-%COMP%]{padding:2rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-label[_ngcontent-%COMP%]{font-weight:600;color:#344767;margin-bottom:.5rem;display:flex;align-items:center}.input-group[_ngcontent-%COMP%]{position:relative}.input-group-text[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #dee2e6;border-right:none;color:#6c757d}.form-control[_ngcontent-%COMP%]{border-left:none;padding-left:.75rem;transition:all .2s ease}.form-control[_ngcontent-%COMP%]:focus{border-color:#5e72e4;box-shadow:0 0 0 .2rem #5e72e440}.form-control.is-valid[_ngcontent-%COMP%]{border-color:#28a745}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.form-select[_ngcontent-%COMP%]{transition:all .2s ease}.form-select[_ngcontent-%COMP%]:focus{border-color:#5e72e4;box-shadow:0 0 0 .2rem #5e72e440}.invalid-feedback[_ngcontent-%COMP%]{display:block;width:100%;margin-top:.25rem;font-size:.875rem;color:#dc3545}.form-text[_ngcontent-%COMP%]{font-size:.875rem;color:#6c757d;margin-top:.25rem}.alert[_ngcontent-%COMP%]{border-radius:10px;border:none;margin-bottom:1.5rem}.alert-danger[_ngcontent-%COMP%]{background-color:#dc35451a;color:#721c24}.btn[_ngcontent-%COMP%]{border-radius:8px;padding:.75rem 1.5rem;font-weight:600;transition:all .2s ease}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(87deg,#5e72e4 0,#825ee4);border:none}.btn-warning[_ngcontent-%COMP%]{background:linear-gradient(87deg,#fb6340 0,#fbb140);border:none}.btn-outline-secondary[_ngcontent-%COMP%]{border:2px solid #dee2e6;color:#6c757d}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#6c757d;border-color:#6c757d}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem}.icon-shape[_ngcontent-%COMP%]{width:3rem;height:3rem;display:flex;align-items:center;justify-content:center}.bg-gradient-primary[_ngcontent-%COMP%]{background:linear-gradient(87deg,#5e72e4 0,#825ee4)}.text-white-50[_ngcontent-%COMP%]{color:#ffffff80!important}@media (max-width: 768px){.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.875rem}}"]})};var ri=(m,p)=>p.id;function ai(m,p){if(m&1){let e=I();n(0,"tr",64)(1,"td",65),c(2,"input",45),t(),n(3,"td")(4,"div",66)(5,"div",67)(6,"h6",68),r(7),t(),n(8,"p",69),c(9,"i",70),r(10),a(11,"translate"),t()()()(),n(12,"td",65)(13,"div",67)(14,"span",71),c(15,"i",72),r(16),t(),n(17,"span",71),c(18,"i",73),r(19),t()()(),n(20,"td",74)(21,"span",75),r(22),a(23,"translate"),t()(),n(24,"td",74)(25,"div",76)(26,"div",77)(27,"div",78),r(28),t()(),n(29,"div",79)(30,"h6",80),r(31),t(),n(32,"p",69),r(33),a(34,"date"),t()()()(),n(35,"td",74)(36,"div",33)(37,"button",81),c(38,"i",82),t(),n(39,"ul",36)(40,"li")(41,"a",83),v("click",function(){let s=h(e).$implicit,u=_(2);return x(u.updateEntreprise(s.id))}),c(42,"i",84),r(43),a(44,"translate"),t()(),n(45,"li")(46,"a",85),v("click",function(){let s=h(e).$implicit,u=_(2);return x(u.deleteEntreprise(s.id))}),c(47,"i",86),r(48),a(49,"translate"),t()()()()()()}if(m&2){let e=p.$implicit,l=_(2);i(7),d(e.name),i(3),E("",o(11,12,"NUI"),": ",e.nui," "),i(6),f("",e.adresse," "),i(3),f("",e.tel," "),i(2),S("ngClass",l.getCompanyTypeBadgeClass(e.is_physic)),i(),f(" ",o(23,14,l.getCompanyTypeLabel(e.is_physic))," "),i(6),f(" ",e.name.charAt(0)," "),i(3),d(e.name),i(2),d(be(34,16,e.created_at,"shortDate")),i(10),f("",o(44,19,"Edit")," "),i(5),f("",o(49,21,"Delete")," ")}}function oi(m,p){m&1&&H(0,ai,50,23,"tr",64,ri),m&2&&W(p)}function li(m,p){m&1&&(n(0,"tr")(1,"td",87)(2,"div",88),c(3,"i",89),n(4,"h6",90),r(5),a(6,"translate"),t(),n(7,"p",52),r(8),a(9,"translate"),t(),n(10,"button",91),c(11,"i",10),r(12),a(13,"translate"),t()()()()),m&2&&(i(5),d(o(6,3,"NoDataFound")),i(3),d(o(9,5,"NoCompaniesAvailable")),i(4),f("",o(13,7,"AddFirst")," "))}var lt=class m extends z{constructor(e,l,s,u,b,g){super();this.languageService=e;this.reformService=l;this.modalService=s;this.router=u;this.formBuilder=b;this.route=g}loading$;itemsPerPage=10;paginateData$;paginateData;totaElement=0;pageEvent;pageArray=[];searchCtrl;entreprises$;Math=Math;currentSortBy="created_at";sortDirection="desc";startDate="";endDate="";ngOnInit(){console.log("init"),this.loading$=this.reformService.loading$,this.searchCtrl=this.formBuilder.control(""),this.entreprises$=this.reformService.entreprises$,this.paginateData$=this.reformService.paginateData$,this.paginateData$.subscribe(e=>{this.paginateData=e,this.totaElement=e.total??0,this.changeChoiceItemPage()}),this.searchCtrl.valueChanges.pipe(ce(300),fe()).subscribe(()=>{this.applyFilters()}),this.applyFilters()}pageChange(e){return this.paginateData.current_page=e.pageIndex+1,this.paginateData.per_page=e.pageSize,this.applyFilters(),console.log(this.paginateData),e}changeChoiceItemPage(){let e=[];if(console.log(this.pageArray),this.totaElement<=2)console.log("total",this.totaElement),e.push(this.totaElement);else{for(let l=1;l<this.totaElement/2;l++)e.push(l*2);this.totaElement%2>0&&e.push(this.totaElement)}console.log(e),this.pageArray=e}createEntreprise(){let e=this.modalService.open(ke,{centered:!0,backdrop:"static"});var l;l=e.componentInstance.reload,l.subscribe(s=>{s&&this.reformService.getEntreprisesFromServer(this.paginateData)})}updateEntreprise(e){let l=this.modalService.open(ke,{centered:!0,backdrop:"static"});l.componentInstance.entrepriseId=e;var s;s=l.componentInstance.reload,s.subscribe(u=>{u&&this.reformService.getEntreprisesFromServer(this.paginateData)})}applyFilters(){let e=[];this.searchCtrl.value&&e.push(Ie(this.searchCtrl.value)),this.startDate&&e.push(P("start_date",this.startDate)),this.endDate&&e.push(P("end_date",this.endDate)),e.push(P("sort_by",this.currentSortBy)),e.push(P("sort_direction",this.sortDirection)),this.reformService.getEntreprisesFromServer(this.paginateData,e)}sortBy(e){this.currentSortBy===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.currentSortBy=e,this.sortDirection="asc"),this.applyFilters()}getSortIcon(e){return this.currentSortBy!==e?"fas fa-sort text-muted":this.sortDirection==="asc"?"fas fa-sort-up text-primary":"fas fa-sort-down text-primary"}resetFilters(){this.searchCtrl.reset(),this.startDate="",this.endDate="",this.currentSortBy="created_at",this.sortDirection="desc",this.applyFilters()}getCompanyTypeLabel(e){return e?"PersonnePhysique":"PersonneMorale"}getCompanyTypeBadgeClass(e){return e?"bg-gradient-info":"bg-gradient-primary"}viewDetails(e){this.router.navigate(["/admin/reformes/entreprises/detail",e])}editEntreprise(e){this.router.navigate(["/admin/reformes/entreprises/edit",e])}deleteEntreprise(e){}onSearchChange(e){let l=e.target;this.searchCtrl.setValue(l.value)}onStartDateChange(e){let l=e.target;this.startDate=l.value,this.applyFilters()}onEndDateChange(e){let l=e.target;this.endDate=l.value,this.applyFilters()}static \u0275fac=function(l){return new(l||m)(y(O),y(k),y(Ee),y(G),y(q),y(J))};static \u0275cmp=F({type:m,selectors:[["app-list-entreprise"]],standalone:!1,features:[ge],decls:145,vars:103,consts:[["paginator",""],["nameOption","Entreprises"],[1,"row","mb-4"],[1,"col-lg-8","col-md-6","col-12"],[1,"d-flex","align-items-center"],[1,"mb-0","text-dark"],[1,"badge","bg-gradient-info","ms-2"],[1,"text-sm","text-secondary","mb-0"],[1,"col-lg-4","col-md-6","col-12","text-end"],[1,"btn","btn-primary","btn-sm","mb-0",3,"click"],[1,"fas","fa-plus","me-2"],[1,"col-12"],[1,"card"],[1,"card-body","p-3"],[1,"row","align-items-center"],[1,"col-lg-4","col-md-6","col-12"],[1,"form-group","mb-0"],[1,"form-label","text-xs"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text",1,"form-control",3,"placeholder","formControl"],[1,"col-lg-2","col-md-6","col-12"],["type","date",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-lg-1","col-md-6","col-12"],[1,"form-label","text-xs","opacity-0"],[1,"btn","btn-outline-secondary","btn-sm","w-100",3,"click","title"],[1,"fas","fa-undo"],[1,"row"],[1,"card-header","pb-0"],[1,"col-lg-6","col-7"],[1,"mb-0"],[1,"col-lg-6","col-5","text-end"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-sm","btn-outline-primary","dropdown-toggle"],[1,"fas","fa-download","me-1"],[1,"dropdown-menu"],[1,"dropdown-item"],[1,"fas","fa-file-excel","me-2"],[1,"fas","fa-file-pdf","me-2"],[1,"fas","fa-file-csv","me-2"],[1,"card-body","px-0","pt-0","pb-2"],[1,"table-responsive","p-0"],[1,"table","align-items-center","mb-0"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","ps-2"],["type","checkbox",1,"form-check-input"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","cursor-pointer",3,"click"],[1,"ms-1"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","cursor-pointer",3,"click"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7"],[1,"row","mt-3"],[1,"col-sm-6"],[1,"text-sm","text-secondary"],["aria-label","Select page",3,"page","length","pageSize","pageSizeOptions","showFirstLastButtons"],["id","bulkActionsModal","tabindex","-1",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn-close"],[1,"modal-body"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary"],[1,"hover-row"],[1,"ps-2"],[1,"d-flex","px-2","py-1"],[1,"d-flex","flex-column","justify-content-center"],[1,"mb-0","text-sm"],[1,"text-xs","text-secondary","mb-0"],[1,"fas","fa-id-card","me-1"],[1,"text-xs","text-secondary"],[1,"fas","fa-map-marker-alt","me-1"],[1,"fas","fa-phone","me-1"],[1,"text-center"],[1,"badge","badge-sm",3,"ngClass"],[1,"d-flex","align-items-center","justify-content-center"],[1,"avatar","avatar-xs","me-2"],[1,"avatar-initial","rounded-circle","bg-gradient-primary"],[1,"d-flex","flex-column"],[1,"mb-0","text-xs"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-link","text-secondary","p-0","dropdown-toggle"],[1,"fas","fa-ellipsis-v"],[1,"dropdown-item",3,"click"],[1,"fas","fa-edit","me-2"],[1,"dropdown-item","text-danger",3,"click"],[1,"fas","fa-trash","me-2"],["colspan","6",1,"text-center","py-4"],[1,"d-flex","flex-column","align-items-center"],[1,"fas","fa-building","text-muted","mb-3",2,"font-size","3rem"],[1,"text-muted","mb-2"],["routerLink","create",1,"btn","btn-primary","btn-sm"]],template:function(l,s){if(l&1){let u=I();n(0,"app-base",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h4",5),r(5),a(6,"translate"),t(),n(7,"span",6),r(8),a(9,"async"),a(10,"translate"),t()(),n(11,"p",7),r(12),a(13,"translate"),t()(),n(14,"div",8)(15,"button",9),v("click",function(){return h(u),x(s.createEntreprise())}),c(16,"i",10),r(17),a(18,"translate"),a(19,"translate"),t()()(),n(20,"div",2)(21,"div",11)(22,"div",12)(23,"div",13)(24,"div",14)(25,"div",15)(26,"div",16)(27,"label",17),r(28),a(29,"translate"),t(),n(30,"div",18)(31,"span",19),c(32,"i",20),t(),c(33,"input",21),a(34,"translate"),t()()(),n(35,"div",22)(36,"div",16)(37,"label",17),r(38),a(39,"translate"),t(),n(40,"input",23),ie("ngModelChange",function(g){return h(u),te(s.startDate,g)||(s.startDate=g),x(g)}),v("change",function(){return h(u),x(s.applyFilters())}),t()()(),n(41,"div",22)(42,"div",16)(43,"label",17),r(44),a(45,"translate"),t(),n(46,"input",23),ie("ngModelChange",function(g){return h(u),te(s.endDate,g)||(s.endDate=g),x(g)}),v("change",function(){return h(u),x(s.applyFilters())}),t()()(),n(47,"div",24)(48,"div",16)(49,"label",25),r(50,"Action"),t(),n(51,"button",26),a(52,"translate"),v("click",function(){return h(u),x(s.resetFilters())}),c(53,"i",27),t()()()()()()()(),n(54,"div",28)(55,"div",11)(56,"div",12)(57,"div",29)(58,"div",14)(59,"div",30)(60,"h6",31),r(61),a(62,"translate"),t()(),n(63,"div",32)(64,"div",33)(65,"button",34),c(66,"i",35),r(67),a(68,"translate"),t(),n(69,"ul",36)(70,"li")(71,"a",37),c(72,"i",38),r(73,"Excel"),t()(),n(74,"li")(75,"a",37),c(76,"i",39),r(77,"PDF"),t()(),n(78,"li")(79,"a",37),c(80,"i",40),r(81,"CSV"),t()()()()()()(),n(82,"div",41)(83,"div",42)(84,"table",43)(85,"thead")(86,"tr")(87,"th",44),c(88,"input",45),t(),n(89,"th",46),v("click",function(){return h(u),x(s.sortBy("name"))}),r(90),a(91,"translate"),c(92,"i",47),t(),n(93,"th",44),r(94),a(95,"translate"),t(),n(96,"th",48),v("click",function(){return h(u),x(s.sortBy("is_physic"))}),r(97),a(98,"translate"),c(99,"i",47),t(),n(100,"th",48),v("click",function(){return h(u),x(s.sortBy("created_at"))}),r(101),a(102,"translate"),c(103,"i",47),t(),n(104,"th",49),r(105),a(106,"translate"),t()()(),n(107,"tbody"),C(108,oi,2,0),a(109,"async"),C(110,li,14,9,"tr"),t()()(),n(111,"div",50)(112,"div",51)(113,"div",4)(114,"span",52),r(115),a(116,"translate"),a(117,"async"),a(118,"translate"),a(119,"async"),a(120,"translate"),a(121,"async"),a(122,"translate"),t()()(),n(123,"div",51)(124,"mat-paginator",53,0),v("page",function(g){return h(u),x(s.pageEvent=s.pageChange(g))}),t()()()()()()(),n(126,"div",54)(127,"div",55)(128,"div",56)(129,"div",57)(130,"h5",58),r(131),a(132,"translate"),t(),c(133,"button",59),t(),n(134,"div",60)(135,"p"),r(136),a(137,"translate"),t()(),n(138,"div",61)(139,"button",62),r(140),a(141,"translate"),t(),n(142,"button",63),r(143),a(144,"translate"),t()()()()()()}if(l&2){let u,b,g;i(5),d(o(6,43,"Companies")),i(3),E("",((u=o(9,45,s.entreprises$))==null?null:u.length)||0," ",o(10,47,"items"),""),i(4),d(o(13,49,"ManageCompaniesForReforms")),i(5),E(" ",o(18,51,"Add")," ",o(19,53,"Company")," "),i(11),d(o(29,55,"Search")),i(5),w("placeholder",o(34,57,"SearchByNameOrNUI")),S("formControl",s.searchCtrl),i(5),d(o(39,59,"DateFrom")),i(2),ee("ngModel",s.startDate),i(4),d(o(45,61,"DateTo")),i(2),ee("ngModel",s.endDate),i(5),w("title",o(52,63,"ResetFilters")),i(10),d(o(62,65,"CompaniesList")),i(6),f("",o(68,67,"Export")," "),i(23),f(" ",o(91,69,"Company")," "),i(2),D(s.getSortIcon("name")),i(2),f(" ",o(95,71,"Contact")," "),i(3),f(" ",o(98,73,"Type")," "),i(2),D(s.getSortIcon("is_physic")),i(2),f(" ",o(102,75,"CreatedAt")," "),i(2),D(s.getSortIcon("created_at")),i(2),f(" ",o(106,77,"Actions")," "),i(3),B((b=o(109,79,s.entreprises$))?108:110,b),i(7),ve(" ",o(116,81,"Showing")," ",((g=o(117,83,s.paginateData$))==null?null:g.current_page)||0," ",o(118,85,"to")," ",((g=o(119,87,s.paginateData$))==null?null:g.per_page)||0," ",o(120,89,"of")," ",((g=o(121,91,s.paginateData$))==null?null:g.total)||0," ",o(122,93,"entries")," "),i(9),S("length",s.totaElement)("pageSize",s.itemsPerPage)("pageSizeOptions",s.pageArray)("showFirstLastButtons",!0),i(7),d(o(132,95,"BulkActions")),i(5),d(o(137,97,"SelectBulkAction")),i(4),d(o(141,99,"Cancel")),i(3),d(o(144,101,"Apply"))}},dependencies:[Y,It,N,j,Ce,z,Me,we,R,_e,M],styles:[`.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none}.cursor-pointer[_ngcontent-%COMP%]:hover{background-color:#0000000d}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.75rem;opacity:.7;transition:all .2s ease}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{opacity:1}.hover-row[_ngcontent-%COMP%]:hover{background-color:#5e72e40d;transform:translateY(-1px);transition:all .2s ease}.avatar-initial[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:600;color:#fff;text-transform:uppercase}.form-select[_ngcontent-%COMP%]{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .75rem center;background-size:16px 12px;-webkit-appearance:none;-moz-appearance:none;appearance:none}.badge-company-type[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem;border-radius:.375rem}.dropdown-toggle[_ngcontent-%COMP%]:after{display:none}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;padding:.75rem .5rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem .5rem;border-bottom:1px solid #f8f9fa;vertical-align:middle}.btn-action[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem;border-radius:.375rem;border:none;cursor:pointer;transition:all .2s ease}.btn-action[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 8px #0000001a}.search-input[_ngcontent-%COMP%]{border:1px solid #d2d6da;border-radius:.5rem;padding:.5rem 1rem;font-size:.875rem;transition:all .2s ease}.search-input[_ngcontent-%COMP%]:focus{border-color:#5e72e4;box-shadow:0 0 0 .2rem #5e72e440;outline:none}.empty-state[_ngcontent-%COMP%]{padding:3rem 2rem;text-align:center;color:#6c757d}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem;opacity:.5}.card-header[_ngcontent-%COMP%]{background-color:#fff;border-bottom:1px solid #f8f9fa;padding:1rem 1.5rem}.filters-section[_ngcontent-%COMP%]{background-color:#f8f9fa;border-radius:.75rem;padding:1.5rem;margin-bottom:1.5rem}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{font-size:.875rem}.btn-action[_ngcontent-%COMP%]{font-size:.75rem;padding:.125rem .25rem}.badge[_ngcontent-%COMP%]{font-size:.625rem}}.btn[_ngcontent-%COMP%]{transition:all .2s ease}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 16px #0000001a}.mat-paginator[_ngcontent-%COMP%]{border-radius:.5rem;background-color:#fff}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#5e72e4;border-color:#5e72e4}.form-check-input[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .25rem #5e72e440}.company-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.company-contact[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.125rem}.company-type-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .5rem;border-radius:.375rem;font-size:.75rem;font-weight:500}.company-type-badge.legal-entity[_ngcontent-%COMP%]{background-color:#0d6efd1a;color:#0d6efd}.company-type-badge.individual[_ngcontent-%COMP%]{background-color:#6f42c11a;color:#6f42c1}.pagination[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{border:1px solid #dee2e6;color:#6c757d;padding:.375rem .75rem;margin:0 .125rem;border-radius:.375rem}.pagination[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]:hover{background-color:#e9ecef;border-color:#dee2e6}.pagination[_ngcontent-%COMP%]   .page-item.active[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{background-color:#5e72e4;border-color:#5e72e4}.pagination[_ngcontent-%COMP%]   .page-item.disabled[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{color:#6c757d;background-color:#f8f9fa;border-color:#dee2e6;cursor:not-allowed}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.input-group-text[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #dee2e6;border-right:0;color:#6c757d}.form-control[_ngcontent-%COMP%]{border-left:0}.form-control[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #5e72e440;border-color:#5e72e4}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:2px solid #dee2e6;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #f1f3f4;vertical-align:middle}.spinner-border[_ngcontent-%COMP%]{width:2rem;height:2rem}`]})};function si(m,p){if(m&1&&(n(0,"div",35)(1,"div",2),c(2,"i",36),n(3,"span"),r(4),t()(),c(5,"button",37),t()),m&2){let e=_();i(4),d(e.message)}}function mi(m,p){m&1&&C(0,si,6,1,"div",35),m&2&&B(p.status?0:-1)}function pi(m,p){if(m&1&&(n(0,"div",20),c(1,"i",38),r(2),t()),m&2){let e=_();i(2),f(" ",e.getFormControlErrorText(e.buyerForm.get("first_name"))," ")}}function di(m,p){if(m&1&&(n(0,"div",20),c(1,"i",38),r(2),t()),m&2){let e=_();i(2),f(" ",e.getFormControlErrorText(e.buyerForm.get("last_name"))," ")}}function ci(m,p){if(m&1&&(n(0,"div",20),c(1,"i",38),r(2),t()),m&2){let e=_();i(2),f(" ",e.getFormControlErrorText(e.buyerForm.get("cni"))," ")}}function fi(m,p){if(m&1&&(n(0,"div",20),c(1,"i",38),r(2),t()),m&2){let e=_();i(2),f(" ",e.getFormControlErrorText(e.buyerForm.get("tel"))," ")}}function ui(m,p){m&1&&(n(0,"div",33)(1,"span",39),r(2),a(3,"translate"),t()()),m&2&&(i(2),d(o(3,1,"Loading")))}function gi(m,p){if(m&1&&c(0,"i",40),m&2){let e=_();D(e.buyerId?"fa-edit":"fa-plus")}}var et=class m{constructor(p,e,l,s){this.languageService=p;this.activeModal=e;this.formBuilder=l;this.reformeService=s}reload=new ue;buyerId;loading$;buyerForm;btnSubmit=!1;error$;confirmSubmit$;ngOnInit(){this.loading$=this.reformeService.loading$,this.reformeService.setLoadStatus(!1),this.initForm()}confirm(){this.activeModal&&this.activeModal.close()}dismiss(){this.activeModal&&this.activeModal.dismiss()}initForm(){this.error$=this.reformeService.error$,this.confirmSubmit$=this.reformeService.confirmSubmit$,this.confirmSubmit$.subscribe(p=>{this.btnSubmit&&p&&(this.reload.emit(!0),this.dismiss())}),this.buyerForm=this.formBuilder.group({first_name:["",T.required],last_name:["",T.required],cni:["",T.required],tel:["",T.required]}),this.buyerId&&this.reformeService.getBuyerDetailFromServer(this.buyerId).subscribe(e=>{this.buyerForm.patchValue(e)})}submitForm(){this.buyerForm.valid?(this.btnSubmit=!0,console.log(this.buyerForm.value),this.buyerId?this.reformeService.updateBuyer(this.buyerId,this.buyerForm.value):this.reformeService.createBuyer(this.buyerForm.value)):(console.log("Form is invalid:",this.buyerForm.value),this.btnSubmit=!0)}getFormControlErrorText(p){return p?.hasError("required")?this.languageService.instant("FieldRequired"):p?.hasError("minlength")?this.languageService.instant("FieldTooShort"):p?.hasError("maxlength")?this.languageService.instant("FieldTooLong"):""}static \u0275fac=function(e){return new(e||m)(y(O),y(Be,8),y(q),y(k))};static \u0275cmp=F({type:m,selectors:[["app-create-buyer"]],outputs:{reload:"reload"},standalone:!1,decls:87,vars:68,consts:[[1,"modal-content"],[1,"modal-header","bg-gradient-info","text-white","border-0"],[1,"d-flex","align-items-center"],[1,"icon","icon-shape","icon-sm","bg-white","text-info","rounded-circle","me-3"],[1,"fas","fa-user-plus"],[1,"modal-title","mb-0","text-white"],[1,"text-white-50","mb-0","text-sm"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close","btn-close-white",3,"click"],[1,"modal-body","p-3"],["novalidate","",1,"needs-validation",3,"formGroup"],[1,"row"],[1,"col-md-6","mb-3"],[1,"form-group"],[1,"form-label","text-dark","font-weight-bold"],[1,"fas","fa-user","text-info","me-2"],[1,"text-danger"],[1,"input-group"],[1,"input-group-text","bg-light"],[1,"fas","fa-user","text-muted"],["type","text","id","first_name","formControlName","first_name",1,"form-control",3,"placeholder"],[1,"invalid-feedback","d-block"],["type","text","id","last_name","formControlName","last_name",1,"form-control",3,"placeholder"],[1,"fas","fa-id-card","text-info","me-2"],[1,"fas","fa-id-card","text-muted"],["type","text","id","cni","formControlName","cni",1,"form-control",3,"placeholder"],[1,"fas","fa-phone","text-info","me-2"],[1,"fas","fa-phone","text-muted"],["type","tel","id","tel","formControlName","tel",1,"form-control",3,"placeholder"],[1,"modal-footer","bg-light","border-0"],[1,"d-flex","w-100","gap-2"],["type","button",1,"btn","btn-outline-secondary","flex-fill",3,"click"],[1,"fas","fa-times","me-2"],["type","submit",1,"btn","flex-fill",3,"click"],["role","status",1,"spinner-border","spinner-border-sm","me-2"],[1,"me-2",3,"class"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button","data-bs-dismiss","alert",1,"btn-close"],[1,"fas","fa-exclamation-circle","me-1"],[1,"visually-hidden"],[1,"me-2"]],template:function(e,l){if(e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),c(4,"i",4),t(),n(5,"div")(6,"h5",5),r(7),a(8,"translate"),a(9,"translate"),t(),n(10,"p",6),r(11),a(12,"translate"),t()()(),n(13,"button",7),v("click",function(){return l.dismiss()}),t()(),n(14,"div",8),C(15,mi,1,1),a(16,"async"),n(17,"form",9)(18,"div",10)(19,"div",11)(20,"div",12)(21,"label",13),c(22,"i",14),r(23),a(24,"translate"),n(25,"span",15),r(26,"*"),t()(),n(27,"div",16)(28,"span",17),c(29,"i",18),t(),c(30,"input",19),a(31,"translate"),t(),C(32,pi,3,1,"div",20),t()(),n(33,"div",11)(34,"div",12)(35,"label",13),c(36,"i",14),r(37),a(38,"translate"),n(39,"span",15),r(40,"*"),t()(),n(41,"div",16)(42,"span",17),c(43,"i",18),t(),c(44,"input",21),a(45,"translate"),t(),C(46,di,3,1,"div",20),t()(),n(47,"div",11)(48,"div",12)(49,"label",13),c(50,"i",22),r(51),a(52,"translate"),n(53,"span",15),r(54,"*"),t()(),n(55,"div",16)(56,"span",17),c(57,"i",23),t(),c(58,"input",24),a(59,"translate"),t(),C(60,ci,3,1,"div",20),t()(),n(61,"div",11)(62,"div",12)(63,"label",13),c(64,"i",25),r(65),a(66,"translate"),n(67,"span",15),r(68,"*"),t()(),n(69,"div",16)(70,"span",17),c(71,"i",26),t(),c(72,"input",27),a(73,"translate"),t(),C(74,fi,3,1,"div",20),t()()()()(),n(75,"div",28)(76,"div",29)(77,"button",30),v("click",function(){return l.dismiss()}),c(78,"i",31),r(79),a(80,"translate"),t(),n(81,"button",32),v("click",function(){return l.submitForm()}),C(82,ui,4,3,"div",33),a(83,"async"),C(84,gi,1,2,"i",34),r(85),a(86,"translate"),t()()()()),e&2){let s,u,b,g,L,U,pe,We,Qe,Xe,Ye,Je,Ke;i(7),E(" ",l.buyerId?"Update":o(8,38,"Create")," ",o(9,40,"Buyer")," "),i(4),f(" ",l.buyerId?"ModifyBuyerDetails":o(12,42,"AddNewBuyerToSystem")," "),i(4),B((s=o(16,44,l.error$))?15:-1,s),i(2),S("formGroup",l.buyerForm),i(6),f(" ",o(24,46,"FirstName")," "),i(7),V("is-invalid",l.btnSubmit&&((u=l.buyerForm.get("first_name"))==null?null:u.invalid))("is-valid",(b=l.buyerForm.get("first_name"))==null?null:b.valid),w("placeholder",o(31,48,"EnterFirstName")),i(2),B(l.btnSubmit&&l.buyerForm.invalid&&((g=l.buyerForm.get("first_name"))!=null&&g.invalid)?32:-1),i(5),f(" ",o(38,50,"LastName")," "),i(7),V("is-invalid",l.btnSubmit&&((L=l.buyerForm.get("last_name"))==null?null:L.invalid))("is-valid",(U=l.buyerForm.get("last_name"))==null?null:U.valid),w("placeholder",o(45,52,"EnterLastName")),i(2),B(l.btnSubmit&&l.buyerForm.invalid&&((pe=l.buyerForm.get("last_name"))!=null&&pe.invalid)?46:-1),i(5),f(" ",o(52,54,"CNI")," "),i(7),V("is-invalid",l.btnSubmit&&((We=l.buyerForm.get("cni"))==null?null:We.invalid))("is-valid",(Qe=l.buyerForm.get("cni"))==null?null:Qe.valid),w("placeholder",o(59,56,"EnterCNI")),i(2),B(l.btnSubmit&&l.buyerForm.invalid&&((Xe=l.buyerForm.get("cni"))!=null&&Xe.invalid)?60:-1),i(5),f(" ",o(66,58,"Phone")," "),i(7),V("is-invalid",l.btnSubmit&&((Ye=l.buyerForm.get("tel"))==null?null:Ye.invalid))("is-valid",(Je=l.buyerForm.get("tel"))==null?null:Je.valid),w("placeholder",o(73,60,"EnterPhoneNumber")),i(2),B(l.btnSubmit&&l.buyerForm.invalid&&((Ke=l.buyerForm.get("tel"))!=null&&Ke.invalid)?74:-1),i(5),f(" ",o(80,62,"Cancel")," "),i(2),D(l.buyerId?"btn-warning":"btn-info"),i(),B(o(83,64,l.loading$)?82:84),i(3),f(" ",l.buyerId?"Update":o(86,66,"Create")," ")}},dependencies:[xe,N,j,he,Se,ye,R,M],styles:[".modal-content[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 10px 30px #00000026;border:none}.modal-header[_ngcontent-%COMP%]{border-radius:12px 12px 0 0;padding:1.5rem}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-footer[_ngcontent-%COMP%]{border-radius:0 0 12px 12px;padding:1rem 1.5rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-label[_ngcontent-%COMP%]{margin-bottom:.5rem;font-weight:600;color:#344767}.input-group[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden}.input-group-text[_ngcontent-%COMP%]{border:1px solid #d2d6da;border-right:none;background:linear-gradient(180deg,#f8f9fa,#e9ecef)}.form-control[_ngcontent-%COMP%]{border-left:none;border-radius:0 8px 8px 0;border-color:#d2d6da;transition:all .3s ease}.form-control[_ngcontent-%COMP%]:focus{border-color:#17a2b8;box-shadow:0 0 0 .2rem #17a2b840}.form-control.is-valid[_ngcontent-%COMP%]{border-color:#28a745}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.invalid-feedback[_ngcontent-%COMP%]{display:block;width:100%;margin-top:.25rem;font-size:.875rem;color:#dc3545}.btn[_ngcontent-%COMP%]{border-radius:8px;font-weight:600;padding:.75rem 1.5rem;transition:all .3s ease}.btn-info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#17a2b8,#138496);border:none;color:#fff}.btn-info[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#138496,#117a8b);transform:translateY(-2px);box-shadow:0 4px 12px #17a2b84d}.btn-warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffc107,#e0a800);border:none;color:#212529}.btn-warning[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#e0a800,#d39e00);transform:translateY(-2px);box-shadow:0 4px 12px #ffc1074d}.btn-outline-secondary[_ngcontent-%COMP%]{border:2px solid #6c757d;color:#6c757d;background:transparent}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background:#6c757d;color:#fff;transform:translateY(-2px)}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.icon-shape[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;border-radius:50%}.alert[_ngcontent-%COMP%]{border-radius:8px;border:none;margin-bottom:1.5rem}.alert-danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8d7da,#f5c6cb);color:#721c24}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem}@media (max-width: 768px){.modal-body[_ngcontent-%COMP%], .modal-header[_ngcontent-%COMP%]{padding:1rem}.modal-footer[_ngcontent-%COMP%]{padding:.75rem 1rem}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.875rem}.d-flex.gap-2[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}"]})};var vi=(m,p)=>p.id;function bi(m,p){if(m&1){let e=I();n(0,"tr",64)(1,"td",65),c(2,"input",45),t(),n(3,"td")(4,"div",66)(5,"div",67)(6,"div",68),r(7),t()(),n(8,"div",69)(9,"h6",70),r(10),t(),n(11,"p",71),c(12,"i",72),r(13),a(14,"translate"),t()()()(),n(15,"td",65)(16,"div",69)(17,"span",73),c(18,"i",74),r(19),t(),n(20,"span",73),c(21,"i",75),r(22),t()()(),n(23,"td",76)(24,"span",77),r(25),t()(),n(26,"td",76)(27,"div",78)(28,"div",79)(29,"div",80),r(30),t()(),n(31,"div",81)(32,"h6",82),r(33),t(),n(34,"p",71),r(35),a(36,"date"),t()()()(),n(37,"td",76)(38,"div",33)(39,"button",83),c(40,"i",84),t(),n(41,"ul",36)(42,"li")(43,"a",85),v("click",function(){let s=h(e).$implicit,u=_(2);return x(u.viewDetails(s.id))}),c(44,"i",86),r(45),a(46,"translate"),t()(),n(47,"li")(48,"a",85),v("click",function(){let s=h(e).$implicit,u=_(2);return x(u.editBuyer(s.id))}),c(49,"i",87),r(50),a(51,"translate"),t()(),n(52,"li")(53,"a",37),c(54,"i",88),r(55),a(56,"translate"),t()(),n(57,"li"),c(58,"hr",89),t(),n(59,"li")(60,"a",90),v("click",function(){let s=h(e).$implicit,u=_(2);return x(u.deleteBuyer(s.id))}),c(61,"i",91),r(62),a(63,"translate"),t()()()()()()}if(m&2){let e=p.$implicit,l=_(2);i(7),E(" ",e.first_name.charAt(0),"",e.last_name.charAt(0)," "),i(3),d(l.getFullName(e)),i(3),f("",o(14,14,"BuyerProfile")," "),i(6),f("",e.tel," "),i(3),f("",e.user.email||"N/A"," "),i(3),f(" ",e.cni," "),i(5),f(" ",e.first_name.charAt(0)," "),i(3),d(e.first_name),i(2),d(be(36,16,e.created_at,"shortDate")),i(10),f("",o(46,19,"View")," "),i(5),f("",o(51,21,"Edit")," "),i(5),f("",o(56,23,"Duplicate")," "),i(7),f("",o(63,25,"Delete")," ")}}function _i(m,p){m&1&&H(0,bi,64,27,"tr",64,vi),m&2&&W(p)}function hi(m,p){if(m&1){let e=I();n(0,"tr")(1,"td",92)(2,"div",93),c(3,"i",94),n(4,"h6",95),r(5),a(6,"translate"),t(),n(7,"p",52),r(8),a(9,"translate"),t(),n(10,"button",96),v("click",function(){h(e);let s=_();return x(s.createBuyer())}),c(11,"i",10),r(12),a(13,"translate"),t()()()()}m&2&&(i(5),d(o(6,3,"NoDataFound")),i(3),d(o(9,5,"NoBuyersAvailable")),i(4),f("",o(13,7,"AddFirst")," "))}var pt=class m extends z{constructor(e,l,s,u,b,g){super();this.languageService=e;this.reformService=l;this.modalService=s;this.router=u;this.formBuilder=b;this.route=g}loading$;itemsPerPage=10;paginateData$;paginateData;totaElement=0;pageEvent;pageArray=[];searchCtrl;buyers$;Math=Math;currentSortBy="created_at";sortDirection="desc";startDate="";endDate="";ngOnInit(){console.log("init"),this.loading$=this.reformService.loading$,this.searchCtrl=this.formBuilder.control(""),this.buyers$=this.reformService.buyers$,this.paginateData$=this.reformService.paginateData$,this.paginateData$.subscribe(e=>{this.paginateData=e,this.totaElement=e.total??0,this.changeChoiceItemPage()}),this.searchCtrl.valueChanges.pipe(ce(300),fe()).subscribe(()=>{this.applyFilters()}),this.applyFilters()}pageChange(e){return this.paginateData.current_page=e.pageIndex+1,this.paginateData.per_page=e.pageSize,this.applyFilters(),e}changeChoiceItemPage(){let e=[];if(this.totaElement<=2)e.push(this.totaElement);else{for(let l=1;l<this.totaElement/2;l++)e.push(l*2);this.totaElement%2>0&&e.push(this.totaElement)}this.pageArray=e}applyFilters(){let e=[];this.searchCtrl.value&&e.push(Ie(this.searchCtrl.value)),this.startDate&&e.push(P("start_date",this.startDate)),this.endDate&&e.push(P("end_date",this.endDate)),e.push(P("sort_by",this.currentSortBy)),e.push(P("sort_direction",this.sortDirection)),this.reformService.getBuyerFromServer(this.paginateData,e)}resetFilters(){this.searchCtrl.setValue(""),this.startDate="",this.endDate="",this.currentSortBy="created_at",this.sortDirection="desc",this.applyFilters()}sortBy(e){this.currentSortBy===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.currentSortBy=e,this.sortDirection="asc"),this.applyFilters()}getSortIcon(e){return this.currentSortBy!==e?"fas fa-sort text-muted":this.sortDirection==="asc"?"fas fa-sort-up text-primary":"fas fa-sort-down text-primary"}createBuyer(){this.modalService.open(et,{size:"lg",centered:!0,backdrop:"static"}).componentInstance.reload.subscribe(l=>{l&&this.applyFilters()})}editBuyer(e){let l=this.modalService.open(et,{size:"lg",centered:!0,backdrop:"static"});l.componentInstance.buyerId=e,l.componentInstance.reload.subscribe(s=>{s&&this.applyFilters()})}viewDetails(e){this.router.navigate(["/admin/reformes/buyers/detail",e])}deleteBuyer(e){confirm(this.languageService.instant("ConfirmDelete"))&&console.log("Delete buyer with id:",e)}onSearchChange(e){let l=e.target;this.searchCtrl.setValue(l.value)}onStartDateChange(e){let l=e.target;this.startDate=l.value,this.applyFilters()}onEndDateChange(e){let l=e.target;this.endDate=l.value,this.applyFilters()}getFullName(e){return`${e.first_name} ${e.last_name}`}static \u0275fac=function(l){return new(l||m)(y(O),y(k),y(Ee),y(G),y(q),y(J))};static \u0275cmp=F({type:m,selectors:[["app-list-buyer"]],standalone:!1,features:[ge],decls:145,vars:103,consts:[["paginator",""],["nameOption","Buyers"],[1,"row","mb-4"],[1,"col-lg-8","col-md-6","col-12"],[1,"d-flex","align-items-center"],[1,"mb-0","text-dark"],[1,"badge","bg-gradient-info","ms-2"],[1,"text-sm","text-secondary","mb-0"],[1,"col-lg-4","col-md-6","col-12","text-end"],[1,"btn","btn-primary","btn-sm","mb-0",3,"click"],[1,"fas","fa-plus","me-2"],[1,"col-12"],[1,"card"],[1,"card-body","p-3"],[1,"row","align-items-center"],[1,"col-lg-4","col-md-6","col-12"],[1,"form-group","mb-0"],[1,"form-label","text-xs"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text",1,"form-control",3,"placeholder","formControl"],[1,"col-lg-2","col-md-6","col-12"],["type","date",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-lg-1","col-md-6","col-12"],[1,"form-label","text-xs","opacity-0"],[1,"btn","btn-outline-secondary","btn-sm","w-100",3,"click","title"],[1,"fas","fa-undo"],[1,"row"],[1,"card-header","pb-0"],[1,"col-lg-6","col-7"],[1,"mb-0"],[1,"col-lg-6","col-5","text-end"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-sm","btn-outline-primary","dropdown-toggle"],[1,"fas","fa-download","me-1"],[1,"dropdown-menu"],[1,"dropdown-item"],[1,"fas","fa-file-excel","me-2"],[1,"fas","fa-file-pdf","me-2"],[1,"fas","fa-file-csv","me-2"],[1,"card-body","px-0","pt-0","pb-2"],[1,"table-responsive","p-0"],[1,"table","align-items-center","mb-0"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","ps-2"],["type","checkbox",1,"form-check-input"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","cursor-pointer",3,"click"],[1,"ms-1"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","cursor-pointer",3,"click"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7"],[1,"row","mt-3"],[1,"col-sm-6"],[1,"text-sm","text-secondary"],["aria-label","Select page",3,"page","length","pageSize","pageSizeOptions","showFirstLastButtons"],["id","bulkActionsModal","tabindex","-1",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn-close"],[1,"modal-body"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary"],[1,"hover-row"],[1,"ps-2"],[1,"d-flex","px-2","py-1"],[1,"avatar","avatar-sm","me-3"],[1,"avatar-initial","rounded-circle","bg-gradient-primary"],[1,"d-flex","flex-column","justify-content-center"],[1,"mb-0","text-sm"],[1,"text-xs","text-secondary","mb-0"],[1,"fas","fa-user","me-1"],[1,"text-xs","text-secondary"],[1,"fas","fa-phone","me-1"],[1,"fas","fa-envelope","me-1"],[1,"text-center"],[1,"badge","badge-sm","bg-gradient-secondary"],[1,"d-flex","align-items-center","justify-content-center"],[1,"avatar","avatar-xs","me-2"],[1,"avatar-initial","rounded-circle","bg-gradient-info"],[1,"d-flex","flex-column"],[1,"mb-0","text-xs"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-link","text-secondary","p-0","dropdown-toggle"],[1,"fas","fa-ellipsis-v"],[1,"dropdown-item",3,"click"],[1,"fas","fa-eye","me-2"],[1,"fas","fa-edit","me-2"],[1,"fas","fa-copy","me-2"],[1,"dropdown-divider"],[1,"dropdown-item","text-danger",3,"click"],[1,"fas","fa-trash","me-2"],["colspan","6",1,"text-center","py-4"],[1,"d-flex","flex-column","align-items-center"],[1,"fas","fa-user-friends","text-muted","mb-3",2,"font-size","3rem"],[1,"text-muted","mb-2"],[1,"btn","btn-primary","btn-sm",3,"click"]],template:function(l,s){if(l&1){let u=I();n(0,"app-base",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h4",5),r(5),a(6,"translate"),t(),n(7,"span",6),r(8),a(9,"async"),a(10,"translate"),t()(),n(11,"p",7),r(12),a(13,"translate"),t()(),n(14,"div",8)(15,"button",9),v("click",function(){return h(u),x(s.createBuyer())}),c(16,"i",10),r(17),a(18,"translate"),a(19,"translate"),t()()(),n(20,"div",2)(21,"div",11)(22,"div",12)(23,"div",13)(24,"div",14)(25,"div",15)(26,"div",16)(27,"label",17),r(28),a(29,"translate"),t(),n(30,"div",18)(31,"span",19),c(32,"i",20),t(),c(33,"input",21),a(34,"translate"),t()()(),n(35,"div",22)(36,"div",16)(37,"label",17),r(38),a(39,"translate"),t(),n(40,"input",23),ie("ngModelChange",function(g){return h(u),te(s.startDate,g)||(s.startDate=g),x(g)}),v("change",function(){return h(u),x(s.applyFilters())}),t()()(),n(41,"div",22)(42,"div",16)(43,"label",17),r(44),a(45,"translate"),t(),n(46,"input",23),ie("ngModelChange",function(g){return h(u),te(s.endDate,g)||(s.endDate=g),x(g)}),v("change",function(){return h(u),x(s.applyFilters())}),t()()(),n(47,"div",24)(48,"div",16)(49,"label",25),r(50,"Action"),t(),n(51,"button",26),a(52,"translate"),v("click",function(){return h(u),x(s.resetFilters())}),c(53,"i",27),t()()()()()()()(),n(54,"div",28)(55,"div",11)(56,"div",12)(57,"div",29)(58,"div",14)(59,"div",30)(60,"h6",31),r(61),a(62,"translate"),t()(),n(63,"div",32)(64,"div",33)(65,"button",34),c(66,"i",35),r(67),a(68,"translate"),t(),n(69,"ul",36)(70,"li")(71,"a",37),c(72,"i",38),r(73,"Excel"),t()(),n(74,"li")(75,"a",37),c(76,"i",39),r(77,"PDF"),t()(),n(78,"li")(79,"a",37),c(80,"i",40),r(81,"CSV"),t()()()()()()(),n(82,"div",41)(83,"div",42)(84,"table",43)(85,"thead")(86,"tr")(87,"th",44),c(88,"input",45),t(),n(89,"th",46),v("click",function(){return h(u),x(s.sortBy("first_name"))}),r(90),a(91,"translate"),c(92,"i",47),t(),n(93,"th",44),r(94),a(95,"translate"),t(),n(96,"th",48),v("click",function(){return h(u),x(s.sortBy("cni"))}),r(97),a(98,"translate"),c(99,"i",47),t(),n(100,"th",48),v("click",function(){return h(u),x(s.sortBy("created_at"))}),r(101),a(102,"translate"),c(103,"i",47),t(),n(104,"th",49),r(105),a(106,"translate"),t()()(),n(107,"tbody"),C(108,_i,2,0),a(109,"async"),C(110,hi,14,9,"tr"),t()()(),n(111,"div",50)(112,"div",51)(113,"div",4)(114,"span",52),r(115),a(116,"translate"),a(117,"async"),a(118,"translate"),a(119,"async"),a(120,"translate"),a(121,"async"),a(122,"translate"),t()()(),n(123,"div",51)(124,"mat-paginator",53,0),v("page",function(g){return h(u),x(s.pageEvent=s.pageChange(g))}),t()()()()()()(),n(126,"div",54)(127,"div",55)(128,"div",56)(129,"div",57)(130,"h5",58),r(131),a(132,"translate"),t(),c(133,"button",59),t(),n(134,"div",60)(135,"p"),r(136),a(137,"translate"),t()(),n(138,"div",61)(139,"button",62),r(140),a(141,"translate"),t(),n(142,"button",63),r(143),a(144,"translate"),t()()()()()()}if(l&2){let u,b,g;i(5),d(o(6,43,"Buyers")),i(3),E("",((u=o(9,45,s.buyers$))==null?null:u.length)||0," ",o(10,47,"items"),""),i(4),d(o(13,49,"ManageBuyersForReforms")),i(5),E(" ",o(18,51,"Add")," ",o(19,53,"Buyer")," "),i(11),d(o(29,55,"Search")),i(5),w("placeholder",o(34,57,"SearchByNameOrCNI")),S("formControl",s.searchCtrl),i(5),d(o(39,59,"DateFrom")),i(2),ee("ngModel",s.startDate),i(4),d(o(45,61,"DateTo")),i(2),ee("ngModel",s.endDate),i(5),w("title",o(52,63,"ResetFilters")),i(10),d(o(62,65,"BuyersList")),i(6),f("",o(68,67,"Export")," "),i(23),f(" ",o(91,69,"Buyer")," "),i(2),D(s.getSortIcon("first_name")),i(2),f(" ",o(95,71,"Contact")," "),i(3),f(" ",o(98,73,"CNI")," "),i(2),D(s.getSortIcon("cni")),i(2),f(" ",o(102,75,"CreatedAt")," "),i(2),D(s.getSortIcon("created_at")),i(2),f(" ",o(106,77,"Actions")," "),i(3),B((b=o(109,79,s.buyers$))?108:110,b),i(7),ve(" ",o(116,81,"Showing")," ",((g=o(117,83,s.paginateData$))==null?null:g.current_page)||0," ",o(118,85,"to")," ",((g=o(119,87,s.paginateData$))==null?null:g.per_page)||0," ",o(120,89,"of")," ",((g=o(121,91,s.paginateData$))==null?null:g.total)||0," ",o(122,93,"entries")," "),i(9),S("length",s.totaElement)("pageSize",s.itemsPerPage)("pageSizeOptions",s.pageArray)("showFirstLastButtons",!0),i(7),d(o(132,95,"BulkActions")),i(5),d(o(137,97,"SelectBulkAction")),i(4),d(o(141,99,"Cancel")),i(3),d(o(144,101,"Apply"))}},dependencies:[N,j,Ce,z,Me,we,R,_e,M],styles:['.hover-row[_ngcontent-%COMP%]{transition:all .3s ease}.hover-row[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.cursor-pointer[_ngcontent-%COMP%]:hover{color:#5e72e4!important}.avatar-initial[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-weight:600;color:#fff;font-size:.875rem}.avatar-xs[_ngcontent-%COMP%]   .avatar-initial[_ngcontent-%COMP%]{font-size:.75rem}.avatar-sm[_ngcontent-%COMP%]   .avatar-initial[_ngcontent-%COMP%]{font-size:1rem}.badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.375rem .75rem;border-radius:6px}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:2px solid #e9ecef;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #f0f2f5}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.dropdown-toggle[_ngcontent-%COMP%]:after{display:none}.dropdown-menu[_ngcontent-%COMP%]{border:none;box-shadow:0 4px 12px #00000026;border-radius:8px;padding:.5rem 0}.dropdown-item[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.875rem;border-radius:0;transition:all .3s ease}.dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;color:#5e72e4}.dropdown-item.text-danger[_ngcontent-%COMP%]:hover{background-color:#f8d7da;color:#721c24}.btn[_ngcontent-%COMP%]{border-radius:6px;font-weight:600;transition:all .3s ease}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#5e72e4,#825ee4);border:none}.btn-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#825ee4,#5e72e4);transform:translateY(-2px);box-shadow:0 4px 12px #5e72e44d}.btn-outline-primary[_ngcontent-%COMP%]{border:2px solid #5e72e4;color:#5e72e4}.btn-outline-primary[_ngcontent-%COMP%]:hover{background:#5e72e4;color:#fff;transform:translateY(-2px)}.btn-outline-secondary[_ngcontent-%COMP%]{border:2px solid #6c757d;color:#6c757d}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background:#6c757d;color:#fff;transform:translateY(-2px)}.card[_ngcontent-%COMP%]{border:none;box-shadow:0 4px 12px #00000014;border-radius:12px;overflow:hidden}.card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8f9fa);border-bottom:1px solid #e9ecef;padding:1.5rem}.card-body[_ngcontent-%COMP%]{padding:1.5rem}.form-control[_ngcontent-%COMP%]{border-radius:6px;border-color:#d2d6da;transition:all .3s ease}.form-control[_ngcontent-%COMP%]:focus{border-color:#5e72e4;box-shadow:0 0 0 .2rem #5e72e440}.input-group-text[_ngcontent-%COMP%]{border-color:#d2d6da;background:linear-gradient(180deg,#f8f9fa,#e9ecef)}.form-label[_ngcontent-%COMP%]{font-weight:600;color:#344767;margin-bottom:.5rem}.fa-sort[_ngcontent-%COMP%], .fa-sort-up[_ngcontent-%COMP%], .fa-sort-down[_ngcontent-%COMP%]{font-size:.75rem;margin-left:.25rem}.fa-sort-up[_ngcontent-%COMP%], .fa-sort-down[_ngcontent-%COMP%]{color:#5e72e4}.text-center.py-4[_ngcontent-%COMP%]{padding:3rem 1rem}.text-center.py-4[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{opacity:.6}@media (max-width: 768px){.card-header[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{padding:1rem}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.875rem}.table[_ngcontent-%COMP%]{font-size:.875rem}.dropdown-menu[_ngcontent-%COMP%]{min-width:150px}}@media (max-width: 576px){.hover-row[_ngcontent-%COMP%]:hover{transform:none;box-shadow:none}.btn-primary[_ngcontent-%COMP%]:hover, .btn-outline-primary[_ngcontent-%COMP%]:hover, .btn-outline-secondary[_ngcontent-%COMP%]:hover{transform:none}.table-responsive[_ngcontent-%COMP%]{font-size:.8rem}}.loading-overlay[_ngcontent-%COMP%]{position:relative}.loading-overlay[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:#fffc;display:flex;align-items:center;justify-content:center;z-index:10}.mat-paginator[_ngcontent-%COMP%]{border-radius:8px;background:#f8f9fa}.bg-gradient-secondary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6c757d,#5a6268)}.bg-gradient-info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#17a2b8,#138496)}.bg-gradient-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#5e72e4,#825ee4)}']})};function xi(m,p){if(m&1&&r(0),m&2){let e=p.item;E(" ",e.name," - ",e.code," ")}}function Ci(m,p){if(m&1&&(n(0,"div",24),r(1),t()),m&2){let e=_();i(),f(" ",e.getFormControlErrorText(e.reformeBrokenForm.get("immobilisation_id"))," ")}}function Si(m,p){if(m&1&&(n(0,"div",24),r(1),t()),m&2){let e=_();i(),f(" ",e.getFormControlErrorText(e.reformeBrokenForm.get("comment"))," ")}}function yi(m,p){if(m&1){let e=I();n(0,"div",28),c(1,"i",29),n(2,"span"),r(3),t(),n(4,"button",30),v("click",function(){let s=h(e).index,u=_(2);return x(u.removeFile(s))}),t()()}if(m&2){let e=p.$implicit;i(3),d(e.name)}}function Bi(m,p){if(m&1&&(n(0,"div",25)(1,"h6"),r(2),a(3,"translate"),t(),n(4,"div",26),C(5,yi,5,1,"div",27),t()()),m&2){let e=_();i(2),f("",o(3,2,"SelectedFiles"),":"),i(3),S("ngForOf",e.selectedFiles)}}function Ei(m,p){if(m&1&&(n(0,"div",31)(1,"div",32),c(2,"i",33),n(3,"span"),r(4),t()(),c(5,"button",34),t()),m&2){let e=_();i(4),d(e.message)}}function Ii(m,p){m&1&&C(0,Ei,6,1,"div",31),m&2&&B(p.status?0:-1)}function wi(m,p){m&1&&(n(0,"div",35)(1,"div",36)(2,"span",37),r(3),a(4,"translate"),t()()()),m&2&&(i(3),f("",o(4,1,"Loading"),"..."))}function ki(m,p){m&1&&(n(0,"span",38)(1,"span",37),r(2),a(3,"translate"),t()()),m&2&&(i(2),f("",o(3,1,"Loading"),"..."))}var Pe=class m{constructor(p,e,l,s,u){this.languageService=p;this.activeModal=e;this.formBuilder=l;this.reformeService=s;this.immoService=u}reload=new ue;loading$;reformeBrokenForm;btnSubmit=!1;error$;confirmSubmit$;immobilisations$;selectedFiles=[];ngOnInit(){this.loading$=this.reformeService.loading$,this.reformeService.setLoadStatus(!1),this.immobilisations$=this.immoService.immobilisations$,this.initForm(),this.loadImmobilisations()}confirm(){this.activeModal&&this.activeModal.close()}dismiss(){this.activeModal&&this.activeModal.dismiss()}loadImmobilisations(){this.immoService.getImmoFullFromServer()}initForm(){this.error$=this.reformeService.error$,this.confirmSubmit$=this.reformeService.confirmSubmit$,this.confirmSubmit$.subscribe(p=>{this.btnSubmit&&p&&(this.reload.emit(!0),this.dismiss())}),this.reformeBrokenForm=this.formBuilder.group({immobilisation_id:["",T.required],comment:["",T.required],documents:[[]]})}onFileSelected(p){let e=p.target.files;if(e&&e.length>0){console.log("Files selected:",e.length);let l=Array.from(e);this.selectedFiles=[...this.selectedFiles,...l],console.log("Total selected files:",this.selectedFiles.map(s=>s.name)),p.target.value=""}}clearAllFiles(){this.selectedFiles=[]}removeFile(p){this.selectedFiles.splice(p,1)}submitForm(){if(this.reformeBrokenForm.valid){this.btnSubmit=!0,console.log(this.reformeBrokenForm.value);let p=new FormData,e=this.reformeBrokenForm.value;p.append("immobilisation_id",e.immobilisation_id),p.append("comment",e.comment),this.selectedFiles.forEach((l,s)=>{p.append(`documents[${s}]`,l)}),this.reformeService.createReformeBroken(p)}else console.log("Form is invalid:",this.reformeBrokenForm.value),this.btnSubmit=!0}getFormControlErrorText(p){return p?.hasError("required")?this.languageService.instant("FieldRequired"):p?.hasError("minlength")?this.languageService.instant("FieldTooShort"):p?.hasError("maxlength")?this.languageService.instant("FieldTooLong"):""}static \u0275fac=function(e){return new(e||m)(y(O),y(Be,8),y(q),y(k),y(ze))};static \u0275cmp=F({type:m,selectors:[["app-create-reforme-broken"]],outputs:{reload:"reload"},standalone:!1,decls:50,vars:53,consts:[[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button","aria-describedby","modal-title",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit","formGroup"],[1,"form-group","mb-3"],["for","immobilisation_id",1,"form-label"],["bindLabel","name","bindValue","id","formControlName","immobilisation_id",3,"items","placeholder","searchable","clearable"],["ng-option-tmp",""],["class","invalid-feedback",4,"ngIf"],["for","comment",1,"form-label"],["id","comment","formControlName","comment","rows","4",1,"form-control",3,"placeholder"],["for","documents",1,"form-label"],[1,"input-group"],["type","file","id","documents","multiple","","accept",".pdf,.doc,.docx,.jpg,.jpeg,.png",1,"form-control",3,"change"],["type","button",1,"btn","btn-outline-secondary",3,"click","title"],[1,"fas","fa-trash"],[1,"form-text","text-muted"],["class","mb-3",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2","role","status",4,"ngIf"],[1,"invalid-feedback"],[1,"mb-3"],[1,"d-flex","flex-wrap","gap-2"],["class","badge bg-primary d-flex align-items-center gap-1",4,"ngFor","ngForOf"],[1,"badge","bg-primary","d-flex","align-items-center","gap-1"],[1,"fas","fa-file"],["type","button",1,"btn-close","btn-close-white",2,"font-size","0.6rem",3,"click"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"d-flex","align-items-center"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button","data-bs-dismiss","alert",1,"btn-close"],[1,"text-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["role","status",1,"spinner-border","spinner-border-sm","me-2"]],template:function(e,l){if(e&1&&(n(0,"div",0)(1,"h4",1),r(2),a(3,"translate"),t(),n(4,"button",2),v("click",function(){return l.dismiss()}),t()(),n(5,"div",3)(6,"form",4),v("ngSubmit",function(){return l.submitForm()}),n(7,"div",5)(8,"label",6),r(9),a(10,"translate"),t(),n(11,"ng-select",7),a(12,"async"),a(13,"translate"),C(14,xi,1,2,"ng-template",8),t(),C(15,Ci,2,1,"div",9),t(),n(16,"div",5)(17,"label",10),r(18),a(19,"translate"),t(),n(20,"textarea",11),a(21,"translate"),r(22,"      "),t(),C(23,Si,2,1,"div",9),t(),n(24,"div",5)(25,"label",12),r(26),a(27,"translate"),t(),n(28,"div",13)(29,"input",14),v("change",function(u){return l.onFileSelected(u)}),t(),n(30,"button",15),a(31,"translate"),v("click",function(){return l.clearAllFiles()}),c(32,"i",16),t()(),n(33,"small",17),r(34),a(35,"translate"),t()(),C(36,Bi,6,4,"div",18)(37,Ii,1,1),a(38,"async"),C(39,wi,5,3,"div",19),a(40,"async"),t()(),n(41,"div",20)(42,"button",21),v("click",function(){return l.dismiss()}),r(43),a(44,"translate"),t(),n(45,"button",22),v("click",function(){return l.submitForm()}),C(46,ki,4,3,"span",23),a(47,"async"),r(48),a(49,"translate"),t()()),e&2){let s,u,b,g,L;i(2),f(" ",o(3,25,"CreateReformeBroken")," "),i(4),S("formGroup",l.reformeBrokenForm),i(3),f("",o(10,27,"Immobilisation")," *"),i(2),V("is-invalid",((s=l.reformeBrokenForm.get("immobilisation_id"))==null?null:s.invalid)&&(((s=l.reformeBrokenForm.get("immobilisation_id"))==null?null:s.dirty)||((s=l.reformeBrokenForm.get("immobilisation_id"))==null?null:s.touched))),S("items",o(12,29,l.immobilisations$))("placeholder",o(13,31,"SelectImmobilisation"))("searchable",!0)("clearable",!0),i(4),S("ngIf",((u=l.reformeBrokenForm.get("immobilisation_id"))==null?null:u.invalid)&&(((u=l.reformeBrokenForm.get("immobilisation_id"))==null?null:u.dirty)||((u=l.reformeBrokenForm.get("immobilisation_id"))==null?null:u.touched))),i(3),f("",o(19,33,"Comment")," *"),i(2),V("is-invalid",((b=l.reformeBrokenForm.get("comment"))==null?null:b.invalid)&&(((b=l.reformeBrokenForm.get("comment"))==null?null:b.dirty)||((b=l.reformeBrokenForm.get("comment"))==null?null:b.touched))),w("placeholder",o(21,35,"EnterComment")),i(3),S("ngIf",((g=l.reformeBrokenForm.get("comment"))==null?null:g.invalid)&&(((g=l.reformeBrokenForm.get("comment"))==null?null:g.dirty)||((g=l.reformeBrokenForm.get("comment"))==null?null:g.touched))),i(3),d(o(27,37,"Documents")),i(4),w("title",o(31,39,"ClearAllFiles")),i(4),f("",o(35,41,"SupportedFormats"),": PDF, DOC, DOCX, JPG, JPEG, PNG"),i(2),S("ngIf",l.selectedFiles.length>0),i(),B((L=o(38,43,l.error$))?37:-1,L),i(2),S("ngIf",o(40,45,l.loading$)),i(4),f(" ",o(44,47,"Cancel")," "),i(2),S("disabled",!l.reformeBrokenForm.valid||l.btnSubmit),i(),S("ngIf",o(47,49,l.loading$)),i(2),f(" ",o(49,51,"Create")," ")}},dependencies:[Ne,Q,xe,N,j,he,Se,ye,Ge,Ue,R,M],styles:[".modal-header[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;padding:1rem 1.5rem}.modal-title[_ngcontent-%COMP%]{color:#344767;font-weight:600}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #dee2e6;padding:1rem 1.5rem}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#344767;margin-bottom:.5rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border-radius:.5rem;border:1px solid #d2d6da;padding:.75rem 1rem;font-size:.875rem;transition:all .2s ease}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#5e72e4;box-shadow:0 0 0 .2rem #5e72e440}.form-control.is-invalid[_ngcontent-%COMP%], .form-select.is-invalid[_ngcontent-%COMP%]{border-color:#f5365c}.invalid-feedback[_ngcontent-%COMP%]{display:block;width:100%;margin-top:.25rem;font-size:.875rem;color:#f5365c}textarea.form-control[_ngcontent-%COMP%]{resize:vertical;min-height:100px}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-top-right-radius:0;border-bottom-right-radius:0}.input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}.badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem .75rem;border-radius:.375rem}.badge[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{margin-left:.5rem}.spinner-border[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem}.btn[_ngcontent-%COMP%]{border-radius:.5rem;padding:.75rem 1.5rem;font-weight:500;transition:all .2s ease}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(87deg,#5e72e4 0,#825ee4);border-color:#5e72e4}.btn-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(87deg,#324cdd 0,#7a2dd8);border-color:#324cdd}.btn-secondary[_ngcontent-%COMP%]{background-color:#8898aa;border-color:#8898aa}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#6c757d;border-color:#6c757d}.btn-outline-secondary[_ngcontent-%COMP%]{color:#8898aa;border-color:#8898aa}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#8898aa;border-color:#8898aa}.alert[_ngcontent-%COMP%]{border-radius:.5rem;padding:.75rem 1rem;margin-bottom:1rem}.alert-danger[_ngcontent-%COMP%]{background-color:#f8d7da;border-color:#f5c6cb;color:#721c24}@media (max-width: 768px){.modal-body[_ngcontent-%COMP%], .modal-footer[_ngcontent-%COMP%]{padding:1rem}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.875rem}}"]})};var Fi=(m,p)=>p.id;function Di(m,p){if(m&1){let e=I();n(0,"div",7)(1,"button",58),v("click",function(){h(e);let s=_();return x(s.closeScan())}),r(2),a(3,"translate"),t()()}m&2&&(i(2),f(" ",o(3,1,"close scan barcode")," "))}function Mi(m,p){if(m&1){let e=I();n(0,"div",7)(1,"button",58),v("click",function(){h(e);let s=_();return x(s.scanCodeBarre())}),c(2,"i",59),r(3),a(4,"translate"),t()()}m&2&&(i(3),f(" ",o(4,1,"scan a barcode")," "))}function Oi(m,p){m&1&&(n(0,"span"),r(1,"..."),t())}function Pi(m,p){if(m&1){let e=I();n(0,"tr",60)(1,"td",61),c(2,"input",49),t(),n(3,"td")(4,"div",62)(5,"div",63)(6,"div",64),c(7,"i",65),t()(),n(8,"div",66)(9,"h6",67),r(10),t(),n(11,"p",68),c(12,"i",69),r(13),a(14,"translate"),t(),n(15,"p",68),c(16,"i",70),r(17),a(18,"translate"),t(),n(19,"p",68),c(20,"i",71),r(21),a(22,"translate"),a(23,"currency"),t()()()(),n(24,"td",61)(25,"div",66)(26,"p",68),r(27),a(28,"slice"),C(29,Oi,2,0,"span"),t()()(),n(30,"td",72)(31,"span",73),r(32),a(33,"translate"),t()(),n(34,"td",72)(35,"div",74)(36,"div",75)(37,"div",76),r(38),t()(),n(39,"div",77)(40,"h6",78),r(41),t(),n(42,"p",68),r(43),a(44,"date"),t()()()(),n(45,"td",72)(46,"div",37)(47,"button",79),c(48,"i",80),t(),n(49,"ul",40)(50,"li")(51,"a",81),v("click",function(){let s=h(e).$implicit,u=_(2);return x(u.viewDetails(s.id))}),c(52,"i",82),r(53),a(54,"translate"),t()(),n(55,"li")(56,"a",81),v("click",function(){let s=h(e).$implicit,u=_(2);return x(u.viewImmobilisationDetails(s.immobilisation_id))}),c(57,"i",83),r(58),a(59,"translate"),t()()()()()()}if(m&2){let e=p.$implicit;i(10),d(e.immobilisation.name),i(3),E("",o(14,18,"Code"),": ",e.immobilisation.code," "),i(4),E("",o(18,20,"Category"),": ",e.immobilisation.categorie.name," "),i(4),E("",o(22,22,"Value"),": ",K(23,24,e.immobilisation.unit_price,"XAF","symbol","1.0-0")," "),i(6),f(" ",ne(28,29,e.comment,0,50)," "),i(2),B(e.comment.length>50?29:-1),i(2),S("ngClass",e.documents.length>0?"bg-gradient-success":"bg-gradient-secondary"),i(),E(" ",e.documents.length," ",o(33,33,"files")," "),i(6),f(" ",e.user.first_name.charAt(0)||"U"," "),i(3),E("",e.user.first_name," ",e.user.last_name,""),i(2),d(be(44,35,e.created_at,"shortDate")),i(10),f("",o(54,38,"View")," "),i(5),f("",o(59,40,"ViewImmobilisationDetails")," ")}}function Ri(m,p){m&1&&H(0,Pi,60,42,"tr",60,Fi),m&2&&W(p)}function Ti(m,p){if(m&1){let e=I();n(0,"tr")(1,"td",84)(2,"div",85),c(3,"i",86),n(4,"h6",87),r(5),a(6,"translate"),t(),n(7,"p",56),r(8),a(9,"translate"),t(),n(10,"button",88),v("click",function(){h(e);let s=_();return x(s.createReformeBroken())}),c(11,"i",14),r(12),a(13,"translate"),t()()()()}m&2&&(i(5),d(o(6,3,"NoDataFound")),i(3),d(o(9,5,"NoBrokenAssetsAvailable")),i(4),f("",o(13,7,"AddFirst")," "))}var dt=class m extends z{constructor(e,l,s,u,b,g){super();this.languageService=e;this.reformService=l;this.modalService=s;this.router=u;this.formBuilder=b;this.route=g}loading$;itemsPerPage=10;paginateData$;paginateData;totaElement=0;pageEvent;pageArray=[];searchCtrl;reformeBrokens$;Math=Math;barcodeScanner;isActiveScan=!1;currentSortBy="created_at";sortDirection="desc";startDate="";endDate="";ngOnInit(){console.log("init"),this.loading$=this.reformService.loading$,this.searchCtrl=this.formBuilder.control(""),this.reformeBrokens$=this.reformService.reformeBrokens$,this.paginateData$=this.reformService.paginateData$,this.paginateData$.subscribe(e=>{this.paginateData=e,this.totaElement=e.total??0,this.changeChoiceItemPage()}),this.reformeBrokens$.subscribe(e=>{this.isActiveScan&&e.length==1&&(this.isActiveScan=!1,this.barcodeScanner.stop(),this.reformService.setSnackMesage("Article cass\xE9 trouv\xE9 : "+e[0].id))}),this.searchCtrl.valueChanges.pipe(ce(300),fe()).subscribe(()=>{this.applyFilters()}),this.applyFilters()}pageChange(e){return this.paginateData.current_page=e.pageIndex+1,this.paginateData.per_page=e.pageSize,this.applyFilters(),e}changeChoiceItemPage(){let e=[];if(this.totaElement<=2)e.push(this.totaElement);else{for(let l=1;l<this.totaElement/2;l++)e.push(l*2);this.totaElement%2>0&&e.push(this.totaElement)}this.pageArray=e}applyFilters(){let e=[];this.searchCtrl.value&&e.push(Ie(this.searchCtrl.value)),this.startDate&&e.push(P("start_date",this.startDate)),this.endDate&&e.push(P("end_date",this.endDate)),e.push(P("sort_by",this.currentSortBy)),e.push(P("sort_direction",this.sortDirection)),this.reformService.getReformeBrokenFromServer(this.paginateData,e)}resetFilters(){this.searchCtrl.setValue(""),this.startDate="",this.endDate="",this.currentSortBy="created_at",this.sortDirection="desc",this.applyFilters()}sortBy(e){this.currentSortBy===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.currentSortBy=e,this.sortDirection="asc"),this.applyFilters()}getSortIcon(e){return this.currentSortBy!==e?"fas fa-sort text-muted":this.sortDirection==="asc"?"fas fa-sort-up text-primary":"fas fa-sort-down text-primary"}createReformeBroken(){this.modalService.open(Pe,{size:"lg",centered:!0,backdrop:"static"}).componentInstance.reload.subscribe(l=>{l&&this.applyFilters()})}viewDetails(e){this.router.navigate(["/admin/reformes/brokens/detail",e])}viewImmobilisationDetails(e){this.router.navigate(["/admin/immobilisations/detail",e])}onSearchChange(e){let l=e.target;this.searchCtrl.setValue(l.value)}onStartDateChange(e){let l=e.target;this.startDate=l.value,this.applyFilters()}onEndDateChange(e){let l=e.target;this.endDate=l.value,this.applyFilters()}onValueChanges(e){console.log("valueChanges :",e.codeResult.code),e.codeResult.code.length>8&&(console.log("valueChanges 2 : ",e.codeResult.code),this.searchCtrl.setValue(e.codeResult.code),this.applyFilters())}scanCodeBarre(){this.barcodeScanner&&typeof this.barcodeScanner.start=="function"&&(this.barcodeScanner.start(),this.isActiveScan=!0)}closeScan(){this.barcodeScanner.stop(),this.isActiveScan=!1}onStarted(e){console.log("started :",e)}static \u0275fac=function(l){return new(l||m)(y(O),y(k),y(Ee),y(G),y(q),y(J))};static \u0275cmp=F({type:m,selectors:[["app-list-reforme-broken"]],viewQuery:function(l,s){if(l&1&&Ve(oe,5),l&2){let u;Ae(u=$e())&&(s.barcodeScanner=u.first)}},standalone:!1,features:[ge],decls:134,vars:103,consts:[["barcodeScanner",""],["paginator",""],["nameOption","Broken Assets"],[1,"row","col-6"],["type","code_128",3,"valueChanges","started"],["class","col-lg-8 col-md-6 col-12",4,"ngIf"],[1,"row","mb-4"],[1,"col-lg-8","col-md-6","col-12"],[1,"d-flex","align-items-center"],[1,"mb-0","text-dark"],[1,"badge","bg-gradient-danger","ms-2"],[1,"text-sm","text-secondary","mb-0"],[1,"col-lg-4","col-md-6","col-12","text-end"],[1,"btn","btn-danger","btn-sm","mb-0",3,"click"],[1,"fas","fa-plus","me-2"],[1,"col-12"],[1,"card"],[1,"card-body","p-3"],[1,"row","align-items-center"],[1,"col-lg-4","col-md-6","col-12"],[1,"form-group","mb-0"],[1,"form-label","text-xs"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text",1,"form-control",3,"placeholder","formControl"],[1,"col-lg-2","col-md-6","col-12"],["type","date",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-lg-1","col-md-6","col-12"],[1,"form-label","text-xs","opacity-0"],[1,"btn","btn-outline-secondary","btn-sm","w-100",3,"click","title"],[1,"fas","fa-undo"],[1,"row"],[1,"card-header","pb-0"],[1,"col-lg-6","col-7"],[1,"mb-0"],[1,"col-lg-6","col-5","text-end"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-sm","btn-outline-primary","dropdown-toggle"],[1,"fas","fa-download","me-1"],[1,"dropdown-menu"],[1,"dropdown-item"],[1,"fas","fa-file-excel","me-2"],[1,"fas","fa-file-pdf","me-2"],[1,"fas","fa-file-csv","me-2"],[1,"card-body","px-0","pt-0","pb-2"],[1,"table-responsive","p-0"],[1,"table","align-items-center","mb-0"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","ps-2"],["type","checkbox",1,"form-check-input"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","cursor-pointer",3,"click"],[1,"ms-1"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","cursor-pointer",3,"click"],[1,"row","mt-3"],[1,"col-sm-6"],[1,"text-sm","text-secondary"],["aria-label","Select page",3,"page","length","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"btn","btn-outline-info","btn-sm","mb-1","me-2",3,"click"],[1,"fas","fa-barcode","me-2"],[1,"hover-row"],[1,"ps-2"],[1,"d-flex","px-2","py-1"],[1,"avatar","avatar-sm","me-3"],[1,"avatar-initial","rounded-circle","bg-gradient-danger"],[1,"fas","fa-exclamation-triangle"],[1,"d-flex","flex-column","justify-content-center"],[1,"mb-0","text-sm"],[1,"text-xs","text-secondary","mb-0"],[1,"fas","fa-barcode","me-1"],[1,"fas","fa-tag","me-1"],[1,"fas","fa-dollar-sign","me-1"],[1,"text-center"],[1,"badge","badge-sm",3,"ngClass"],[1,"d-flex","align-items-center","justify-content-center"],[1,"avatar","avatar-xs","me-2"],[1,"avatar-initial","rounded-circle","bg-gradient-info"],[1,"d-flex","flex-column"],[1,"mb-0","text-xs"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-link","text-secondary","p-0","dropdown-toggle"],[1,"fas","fa-ellipsis-v"],[1,"dropdown-item",3,"click"],[1,"fas","fa-eye","me-2"],[1,"fas","fa-info-circle","me-2"],["colspan","6",1,"text-center","py-4"],[1,"d-flex","flex-column","align-items-center"],[1,"fas","fa-exclamation-triangle","text-muted","mb-3",2,"font-size","3rem"],[1,"text-muted","mb-2"],[1,"btn","btn-danger","btn-sm",3,"click"]],template:function(l,s){if(l&1){let u=I();n(0,"app-base",2)(1,"div",3)(2,"barcode-scanner-livestream",4,0),v("valueChanges",function(g){return h(u),x(s.onValueChanges(g))})("started",function(){return h(u),x(s.onStarted(!0))}),t(),C(4,Di,4,3,"div",5),t(),C(5,Mi,5,3,"div",5),n(6,"div",6)(7,"div",7)(8,"div",8)(9,"h4",9),r(10),a(11,"translate"),t(),n(12,"span",10),r(13),a(14,"async"),a(15,"translate"),t()(),n(16,"p",11),r(17),a(18,"translate"),t()(),n(19,"div",12)(20,"button",13),v("click",function(){return h(u),x(s.createReformeBroken())}),c(21,"i",14),r(22),a(23,"translate"),a(24,"translate"),t()()(),n(25,"div",6)(26,"div",15)(27,"div",16)(28,"div",17)(29,"div",18)(30,"div",19)(31,"div",20)(32,"label",21),r(33),a(34,"translate"),t(),n(35,"div",22)(36,"span",23),c(37,"i",24),t(),c(38,"input",25),a(39,"translate"),t()()(),n(40,"div",26)(41,"div",20)(42,"label",21),r(43),a(44,"translate"),t(),n(45,"input",27),ie("ngModelChange",function(g){return h(u),te(s.startDate,g)||(s.startDate=g),x(g)}),v("change",function(){return h(u),x(s.applyFilters())}),t()()(),n(46,"div",26)(47,"div",20)(48,"label",21),r(49),a(50,"translate"),t(),n(51,"input",27),ie("ngModelChange",function(g){return h(u),te(s.endDate,g)||(s.endDate=g),x(g)}),v("change",function(){return h(u),x(s.applyFilters())}),t()()(),n(52,"div",28)(53,"div",20)(54,"label",29),r(55),a(56,"translate"),t(),n(57,"button",30),a(58,"translate"),v("click",function(){return h(u),x(s.resetFilters())}),c(59,"i",31),t()()()()()()()(),n(60,"div",32)(61,"div",15)(62,"div",16)(63,"div",33)(64,"div",18)(65,"div",34)(66,"h6",35),r(67),a(68,"translate"),t()(),n(69,"div",36)(70,"div",37)(71,"button",38),c(72,"i",39),r(73),a(74,"translate"),t(),n(75,"ul",40)(76,"li")(77,"a",41),c(78,"i",42),r(79),a(80,"translate"),t()(),n(81,"li")(82,"a",41),c(83,"i",43),r(84),a(85,"translate"),t()(),n(86,"li")(87,"a",41),c(88,"i",44),r(89),a(90,"translate"),t()()()()()()(),n(91,"div",45)(92,"div",46)(93,"table",47)(94,"thead")(95,"tr")(96,"th",48),c(97,"input",49),t(),n(98,"th",50),v("click",function(){return h(u),x(s.sortBy("immobilisation"))}),r(99),a(100,"translate"),c(101,"i",51),t(),n(102,"th",48),r(103),a(104,"translate"),t(),n(105,"th",52),r(106),a(107,"translate"),t(),n(108,"th",53),v("click",function(){return h(u),x(s.sortBy("created_at"))}),r(109),a(110,"translate"),c(111,"i",51),t(),n(112,"th",52),r(113),a(114,"translate"),t()()(),n(115,"tbody"),C(116,Ri,2,0),a(117,"async"),C(118,Ti,14,9,"tr"),t()()(),n(119,"div",54)(120,"div",55)(121,"div",8)(122,"span",56),r(123),a(124,"translate"),a(125,"async"),a(126,"translate"),a(127,"async"),a(128,"translate"),a(129,"async"),a(130,"translate"),t()()(),n(131,"div",55)(132,"mat-paginator",57,1),v("page",function(g){return h(u),x(s.pageEvent=s.pageChange(g))}),t()()()()()()()()}if(l&2){let u,b,g;i(4),S("ngIf",s.isActiveScan),i(),S("ngIf",!s.isActiveScan),i(5),d(o(11,43,"BrokenAssets")),i(3),E("",((u=o(14,45,s.reformeBrokens$))==null?null:u.length)||0," ",o(15,47,"items"),""),i(4),d(o(18,49,"ManageBrokenAssetsForReform")),i(5),E(" ",o(23,51,"AddU")," ",o(24,53,"Immobilisation")," "),i(11),d(o(34,55,"Search")),i(5),w("placeholder",o(39,57,"SearchByAssetOrComment")),S("formControl",s.searchCtrl),i(5),d(o(44,59,"DateFrom")),i(2),ee("ngModel",s.startDate),i(4),d(o(50,61,"DateTo")),i(2),ee("ngModel",s.endDate),i(4),d(o(56,63,"Actions")),i(2),w("title",o(58,65,"ResetFilters")),i(10),d(o(68,67,"BrokenAssetsList")),i(6),f("",o(74,69,"Export")," "),i(6),d(o(80,71,"Excel")),i(5),d(o(85,73,"PDF")),i(5),d(o(90,75,"CSV")),i(10),f(" ",o(100,77,"Asset")," "),i(2),D(s.getSortIcon("immobilisation")),i(2),f(" ",o(104,79,"Comment")," "),i(3),f(" ",o(107,81,"Documents")," "),i(3),f(" ",o(110,83,"CreatedAt")," "),i(2),D(s.getSortIcon("created_at")),i(2),f(" ",o(114,85,"Actions")," "),i(3),B((b=o(117,87,s.reformeBrokens$))?116:118,b),i(7),ve(" ",o(124,89,"Showing")," ",((g=o(125,91,s.paginateData$))==null?null:g.current_page)||0," ",o(126,93,"to")," ",((g=o(127,95,s.paginateData$))==null?null:g.per_page)||0," ",o(128,97,"of")," ",((g=o(129,99,s.paginateData$))==null?null:g.total)||0," ",o(130,101,"entries")," "),i(9),S("length",s.totaElement)("pageSize",s.itemsPerPage)("pageSizeOptions",s.pageArray)("showFirstLastButtons",!0)}},dependencies:[Y,Q,N,j,Ce,z,Me,we,oe,R,ae,re,_e,M],encapsulation:2})};function Li(m,p){if(m&1&&(n(0,"div",3),c(1,"i",4),r(2),c(3,"button",5),t()),m&2){let e=_();i(2),f(" ",e.message," ")}}function Vi(m,p){m&1&&C(0,Li,4,1,"div",3),m&2&&B(p.status?0:-1)}function Ai(m,p){m&1&&(n(0,"div",2)(1,"div",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"span",10),r(6),a(7,"translate"),t()(),n(8,"p",11),r(9),a(10,"translate"),t()()()()()),m&2&&(i(6),f("",o(7,2,"Loading"),"..."),i(3),f("",o(10,4,"LoadingBrokenAssetDetails"),"..."))}function $i(m,p){if(m&1){let e=I();n(0,"div",47)(1,"div",48),c(2,"i",49),n(3,"span",50),r(4),a(5,"slice"),t()(),n(6,"button",51),v("click",function(){let s=h(e).$implicit,u=_(3);return x(u.downloadDocument(s))}),c(7,"i",52),t()()}if(m&2){let e=p.$implicit,l=_(3);i(2),D(l.getFileIcon(e)),i(2),d(ne(5,3,e.split("/").pop(),0,10))}}function Ni(m,p){if(m&1&&(n(0,"div",42),H(1,$i,8,7,"div",47,Le),t()),m&2){let e=_(2);i(),W(e.reformeBroken.documents)}}function ji(m,p){m&1&&(n(0,"p",43),r(1),a(2,"translate"),t()),m&2&&(i(),d(o(2,1,"NoDocumentsAttached")))}function zi(m,p){if(m&1){let e=I();n(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17)(6,"div",18)(7,"div",19),c(8,"i",20),t(),n(9,"div")(10,"h3",21),r(11),a(12,"translate"),t(),n(13,"p",22),c(14,"i",23),r(15),t()()()(),n(16,"div",24)(17,"button",25),v("click",function(){h(e);let s=_();return x(s.goBack())}),c(18,"i",26),r(19),a(20,"translate"),t(),n(21,"button",27),v("click",function(){h(e);let s=_();return x(s.viewImmobilisationDetails())}),c(22,"i",28),r(23),a(24,"translate"),t()()()()()()(),n(25,"div",29)(26,"div",30)(27,"div",31)(28,"div",32)(29,"h6",21),r(30),a(31,"translate"),t()(),n(32,"div",33)(33,"div",29)(34,"div",34)(35,"label",35),r(36),a(37,"translate"),t(),n(38,"p",36),r(39),t()(),n(40,"div",34)(41,"label",35),r(42),a(43,"translate"),t(),n(44,"p",36),r(45),t()(),n(46,"div",34)(47,"label",35),r(48),a(49,"translate"),t(),n(50,"p",36),r(51),t()(),n(52,"div",34)(53,"label",35),r(54),a(55,"translate"),t(),n(56,"p",36),r(57),t()(),n(58,"div",34)(59,"label",35),r(60),a(61,"translate"),t(),n(62,"p",36),r(63),t()(),n(64,"div",34)(65,"label",35),r(66),a(67,"translate"),t(),n(68,"p",36),r(69),t()(),n(70,"div",34)(71,"label",35),r(72),a(73,"translate"),t(),n(74,"p",36),r(75),a(76,"currency"),t()(),n(77,"div",34)(78,"label",35),r(79),a(80,"translate"),t(),n(81,"p",36)(82,"span",37),r(83),t()()(),n(84,"div",34)(85,"label",35),r(86),a(87,"translate"),t(),n(88,"p",36),r(89),t()(),n(90,"div",34)(91,"label",35),r(92),a(93,"translate"),t(),n(94,"p",36),r(95),t()(),n(96,"div",34)(97,"label",35),r(98),a(99,"translate"),t(),n(100,"p",36),r(101),t()(),n(102,"div",34)(103,"label",35),r(104),a(105,"translate"),t(),n(106,"p",36),r(107),t()(),n(108,"div",34)(109,"label",35),r(110),a(111,"translate"),t(),n(112,"p",36),r(113),t()()()()(),n(114,"div",38)(115,"div",32)(116,"h6",21),r(117),a(118,"translate"),t()(),n(119,"div",33)(120,"div",29)(121,"div",39)(122,"label",35),r(123),a(124,"translate"),t(),n(125,"div",40)(126,"p",21),r(127),t()()(),n(128,"div",34)(129,"label",35),r(130),a(131,"translate"),t(),n(132,"p",36),r(133),t()(),n(134,"div",34)(135,"label",35),r(136),a(137,"translate"),t(),n(138,"p",36),r(139),t()(),n(140,"div",34)(141,"label",35),r(142),a(143,"translate"),t(),n(144,"p",36),r(145),t()()()()()(),n(146,"div",41)(147,"div",31)(148,"div",32)(149,"h6",21),r(150),a(151,"translate"),t()(),n(152,"div",33),C(153,Ni,3,0,"div",42)(154,ji,3,3,"p",43),t()(),n(155,"div",38)(156,"div",32)(157,"h6",21),r(158),a(159,"translate"),t()(),n(160,"div",33)(161,"div",44)(162,"button",45),v("click",function(){h(e);let s=_();return x(s.viewImmobilisationDetails())}),c(163,"i",28),r(164),a(165,"translate"),t(),n(166,"button",46),v("click",function(){h(e);let s=_();return x(s.goBack())}),c(167,"i",26),r(168),a(169,"translate"),t()()()()()()}if(m&2){let e=_();i(11),d(o(12,47,"BrokenAssetDetails")),i(4),f("",e.formatDate(e.reformeBroken.created_at)," "),i(4),f("",o(20,49,"Back")," "),i(4),f("",o(24,51,"ViewImmobilisationDetails")," "),i(7),d(o(31,53,"ImmobilisationInformation")),i(6),d(o(37,55,"Name")),i(3),d(e.reformeBroken.immobilisation.name),i(3),d(o(43,57,"Code")),i(3),d(e.reformeBroken.immobilisation.code),i(3),d(o(49,59,"Category")),i(3),d(e.reformeBroken.immobilisation.categorie.name),i(3),d(o(55,61,"Brand")),i(3),d(e.reformeBroken.immobilisation.mark||"N/A"),i(3),d(o(61,63,"Model")),i(3),d(e.reformeBroken.immobilisation.model||"N/A"),i(3),d(o(67,65,"Quantity")),i(3),d(e.reformeBroken.immobilisation.quantity),i(3),d(o(73,67,"UnitPrice")),i(3),d(K(76,69,e.reformeBroken.immobilisation.unit_price,"XAF","symbol","1.0-0")),i(4),d(o(80,74,"Status")),i(3),S("ngClass",e.getStatusBadgeClass(e.reformeBroken.immobilisation.status)),i(),f(" ",e.reformeBroken.immobilisation.status," "),i(3),d(o(87,76,"PurchaseDate")),i(3),d(e.formatDate(e.reformeBroken.immobilisation.date_of_receipt)),i(3),d(o(93,78,"OrderNumber")),i(3),d(e.reformeBroken.immobilisation.num_bon_commande||"N/A"),i(3),d(o(99,80,"ProcessNumber")),i(3),d(e.reformeBroken.immobilisation.num_proces_verbal||"N/A"),i(3),d(o(105,82,"Supplier")),i(3),d(e.reformeBroken.immobilisation.fournisseur.raison_social),i(3),d(o(111,84,"Structure")),i(3),d(e.reformeBroken.immobilisation.structure.name),i(4),d(o(118,86,"BrokenAssetInformation")),i(6),d(o(124,88,"Comment")),i(4),d(e.reformeBroken.comment),i(3),d(o(131,90,"CreatedAt")),i(3),d(e.formatDate(e.reformeBroken.created_at)),i(3),d(o(137,92,"UpdatedAt")),i(3),d(e.formatDate(e.reformeBroken.updated_at)),i(3),d(o(143,94,"CreatedBy")),i(3),E("",e.reformeBroken.user.first_name," ",e.reformeBroken.user.last_name,""),i(5),d(o(151,96,"Documents")),i(3),B(e.reformeBroken.documents&&e.reformeBroken.documents.length>0?153:154),i(5),d(o(159,98,"Actions")),i(6),f("",o(165,100,"ViewImmobilisationDetails")," "),i(4),f("",o(169,102,"BackToList")," ")}}function Ui(m,p){if(m&1){let e=I();n(0,"div",2)(1,"div",53)(2,"div",7)(3,"div",8),c(4,"i",54),n(5,"h5",55),r(6),a(7,"translate"),t(),n(8,"p",56),r(9),a(10,"translate"),t(),n(11,"button",57),v("click",function(){h(e);let s=_();return x(s.goBack())}),c(12,"i",26),r(13),a(14,"translate"),t()()()()()}m&2&&(i(6),d(o(7,3,"BrokenAssetNotFound")),i(3),d(o(10,5,"BrokenAssetNotFoundDescription")),i(4),f("",o(14,7,"BackToList")," "))}var ct=class m{constructor(p,e,l,s){this.route=p;this.router=e;this.reformeService=l;this.languageService=s;this.loading$=this.reformeService.loading$,this.error$=this.reformeService.error$}destroy$=new Re;reformeBroken;loading$;error$;reformeBrokenId=null;ngOnInit(){this.reformeBrokenId=this.route.snapshot.paramMap.get("id"),this.reformeBrokenId&&this.loadReformeBrokenDetail()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadReformeBrokenDetail(){this.reformeBrokenId&&this.reformeService.getReformeBrokenDetailFromServer(this.reformeBrokenId).pipe(tt(p=>{console.log("Reforme Broken Detail:",p),this.reformeBroken=p})).subscribe()}goBack(){window.history.back()}viewImmobilisationDetails(){this.reformeBroken&&this.router.navigate(["/admin/immobilisations/detail",this.reformeBroken.immobilisation_id])}getStatusBadgeClass(p){switch(p.toLowerCase()){case"active":return"bg-gradient-success";case"inactive":return"bg-gradient-secondary";case"maintenance":return"bg-gradient-warning";case"broken":return"bg-gradient-danger";default:return"bg-gradient-secondary"}}formatDate(p){return new Date(p).toLocaleDateString("fr-FR")}downloadDocument(p){window.open(p,"_blank")}getFileIcon(p){switch(p.split(".").pop()?.toLowerCase()){case"pdf":return"fas fa-file-pdf";case"doc":case"docx":return"fas fa-file-word";case"jpg":case"jpeg":case"png":return"fas fa-file-image";default:return"fas fa-file"}}static \u0275fac=function(e){return new(e||m)(y(J),y(G),y(k),y(O))};static \u0275cmp=F({type:m,selectors:[["app-detail-reforme-broken"]],standalone:!1,decls:10,vars:12,consts:[[1,"main-content","position-relative","max-height-vh-100","h-100","detail-reforme-broken"],[1,"container-fluid","py-4"],[1,"row","justify-content-center"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button","data-bs-dismiss","alert",1,"btn-close"],[1,"col-12","text-center"],[1,"card","shadow-lg"],[1,"card-body","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"text-secondary","mt-3"],[1,"row","mb-4"],[1,"col-12"],[1,"card","bg-gradient-danger","shadow-lg","border-0"],[1,"card-body","p-4"],[1,"row","align-items-center"],[1,"col-md-8"],[1,"d-flex","align-items-center","text-white"],[1,"icon","icon-shape","icon-lg","bg-white","shadow","text-center","me-3"],[1,"fas","fa-exclamation-triangle","text-danger"],[1,"mb-0"],[1,"text-sm","opacity-8","mb-0"],[1,"fas","fa-calendar","me-2"],[1,"col-md-4","text-end"],[1,"btn","btn-white","btn-sm","me-2",3,"click"],[1,"fas","fa-arrow-left","me-2"],[1,"btn","btn-light","btn-sm",3,"click"],[1,"fas","fa-info-circle","me-2"],[1,"row"],[1,"col-lg-8"],[1,"card","shadow-sm","mb-4"],[1,"card-header","pb-0"],[1,"card-body"],[1,"col-md-6","mb-3"],[1,"form-label","text-sm","text-secondary"],[1,"form-control-plaintext"],[1,"badge",3,"ngClass"],[1,"card","shadow-sm"],[1,"col-12","mb-3"],[1,"p-3","bg-light","rounded"],[1,"col-lg-4"],[1,"list-group","list-group-flush"],[1,"text-muted","text-center","py-3"],[1,"d-grid","gap-2"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"btn","btn-outline-secondary","btn-sm",3,"click"],[1,"list-group-item","d-flex","justify-content-between","align-items-center","px-0"],[1,"d-flex","align-items-center"],[1,"text-primary","me-2"],[1,"text-sm"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"fas","fa-download"],[1,"col-md-6","text-center"],[1,"fas","fa-exclamation-triangle","text-warning","fa-3x","mb-3"],[1,"text-secondary"],[1,"text-muted"],[1,"btn","btn-primary",3,"click"]],template:function(e,l){if(e&1&&(n(0,"div",0)(1,"div",1),C(2,Vi,1,1),a(3,"async"),C(4,Ai,11,6,"div",2),a(5,"async"),C(6,zi,170,104),a(7,"async"),C(8,Ui,15,9,"div",2),a(9,"async"),t()()),e&2){let s;i(2),B((s=o(3,4,l.error$))?2:-1,s),i(2),B(o(5,6,l.loading$)?4:-1),i(2),B(!o(7,8,l.loading$)&&l.reformeBroken?6:-1),i(2),B(!o(9,10,l.loading$)&&!l.reformeBroken?8:-1)}},dependencies:[Y,R,ae,re,M],styles:[".detail-reforme-broken[_ngcontent-%COMP%]{background-color:#f8f9fa;min-height:100vh}.bg-gradient-danger[_ngcontent-%COMP%]{background:linear-gradient(87deg,#f5365c 0,#f56036)}.icon-shape[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:.75rem;display:flex;align-items:center;justify-content:center}.icon-lg[_ngcontent-%COMP%]{width:58px;height:58px}.card[_ngcontent-%COMP%]{border:none;border-radius:1rem;box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.card-header[_ngcontent-%COMP%]{border-bottom:1px solid #e9ecef;background-color:transparent;padding:1.5rem 1.5rem .75rem}.card-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#344767;font-weight:600;margin-bottom:0}.card-body[_ngcontent-%COMP%]{padding:1.5rem}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#344767;margin-bottom:.5rem;font-size:.875rem}.form-control-plaintext[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #e9ecef;border-radius:.5rem;padding:.75rem 1rem;margin-bottom:0;color:#495057;font-size:.875rem}.bg-light[_ngcontent-%COMP%]{background-color:#f8f9fa!important;border:1px solid #e9ecef}.list-group-flush[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]{border:none;border-bottom:1px solid #e9ecef;padding:.75rem 0}.list-group-flush[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.btn[_ngcontent-%COMP%]{border-radius:.5rem;padding:.5rem 1rem;font-weight:500;transition:all .2s ease}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.875rem}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(87deg,#5e72e4 0,#825ee4);border-color:#5e72e4}.btn-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(87deg,#324cdd 0,#7a2dd8);border-color:#324cdd}.btn-outline-primary[_ngcontent-%COMP%]{color:#5e72e4;border-color:#5e72e4}.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:#5e72e4;border-color:#5e72e4}.btn-outline-secondary[_ngcontent-%COMP%]{color:#8898aa;border-color:#8898aa}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#8898aa;border-color:#8898aa}.btn-white[_ngcontent-%COMP%]{background-color:#fff;border-color:#fff;color:#344767}.btn-white[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;border-color:#f8f9fa}.btn-light[_ngcontent-%COMP%]{background-color:#fff3;border-color:#fff3;color:#fff}.btn-light[_ngcontent-%COMP%]:hover{background-color:#ffffff4d;border-color:#ffffff4d}.alert[_ngcontent-%COMP%]{border-radius:.5rem;padding:1rem 1.5rem;margin-bottom:1.5rem;border:none}.alert-danger[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}.spinner-border[_ngcontent-%COMP%]{width:2rem;height:2rem}.text-primary[_ngcontent-%COMP%]{color:#5e72e4!important}.text-secondary[_ngcontent-%COMP%]{color:#8898aa!important}.text-muted[_ngcontent-%COMP%]{color:#6c757d!important}.text-warning[_ngcontent-%COMP%]{color:#fb6340!important}.text-sm[_ngcontent-%COMP%]{font-size:.875rem}.opacity-8[_ngcontent-%COMP%]{opacity:.8}.py-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.mb-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.me-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-3[_ngcontent-%COMP%]{margin-right:1rem!important}.d-grid[_ngcontent-%COMP%]{display:grid!important}.gap-2[_ngcontent-%COMP%]{gap:.5rem!important}.d-flex[_ngcontent-%COMP%]{display:flex!important}.align-items-center[_ngcontent-%COMP%]{align-items:center!important}.justify-content-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-center[_ngcontent-%COMP%]{justify-content:center!important}.text-center[_ngcontent-%COMP%]{text-align:center!important}.text-end[_ngcontent-%COMP%]{text-align:end!important}@media (max-width: 768px){.card-body[_ngcontent-%COMP%], .container-fluid[_ngcontent-%COMP%]{padding:1rem}.icon-lg[_ngcontent-%COMP%]{width:48px;height:48px}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.8rem}}"]})};function Gi(m,p){if(m&1&&r(0),m&2){let e=p.item;E(" ",e.name," - ",e.code," ")}}function qi(m,p){if(m&1&&(n(0,"div",27),r(1),t()),m&2){let e=_();i(),f(" ",e.getFormControlErrorText(e.reformeCessionForm.get("immobilisation_id"))," ")}}function Hi(m,p){if(m&1&&r(0),m&2){let e=p.item;E(" ",e.name," - ",e.nui," ")}}function Wi(m,p){if(m&1&&(n(0,"div",27),r(1),t()),m&2){let e=_();i(),f(" ",e.getFormControlErrorText(e.reformeCessionForm.get("entreprise_id"))," ")}}function Qi(m,p){if(m&1&&(n(0,"div",27),r(1),t()),m&2){let e=_();i(),f(" ",e.getFormControlErrorText(e.reformeCessionForm.get("comment"))," ")}}function Xi(m,p){if(m&1){let e=I();n(0,"div",28)(1,"input",29),v("change",function(s){h(e);let u=_();return x(u.onFileAdd(s))}),t(),n(2,"label",30),c(3,"i",31),r(4),a(5,"translate"),t()()}m&2&&(i(4),f(" ",o(5,1,"AddMoreFiles")," "))}function Yi(m,p){if(m&1){let e=I();n(0,"div",35),c(1,"i",36),n(2,"span"),r(3),t(),n(4,"button",37),v("click",function(){let s=h(e).index,u=_(2);return x(u.removeFile(s))}),t()()}if(m&2){let e=p.$implicit;i(3),d(e.name)}}function Ji(m,p){if(m&1&&(n(0,"div",32)(1,"h6"),r(2),a(3,"translate"),t(),n(4,"div",33),C(5,Yi,5,1,"div",34),t()()),m&2){let e=_();i(2),f("",o(3,2,"SelectedFiles"),":"),i(3),S("ngForOf",e.selectedFiles)}}function Ki(m,p){if(m&1&&(n(0,"div",38)(1,"div",39),c(2,"i",40),n(3,"span"),r(4),t()(),c(5,"button",41),t()),m&2){let e=_();i(4),d(e.message)}}function Zi(m,p){m&1&&C(0,Ki,6,1,"div",38),m&2&&B(p.status?0:-1)}function en(m,p){m&1&&(n(0,"div",42)(1,"div",43)(2,"span",44),r(3),a(4,"translate"),t()()()),m&2&&(i(3),f("",o(4,1,"Loading"),"..."))}function tn(m,p){m&1&&(n(0,"span",45)(1,"span",44),r(2),a(3,"translate"),t()()),m&2&&(i(2),f("",o(3,1,"Loading"),"..."))}var qe=class m{constructor(p,e,l,s,u){this.languageService=p;this.activeModal=e;this.formBuilder=l;this.reformeService=s;this.immoService=u}reload=new ue;loading$;reformeCessionForm;btnSubmit=!1;error$;confirmSubmit$;immobilisations$;entreprises$;selectedFiles=[];ngOnInit(){this.loading$=this.reformeService.loading$,this.reformeService.setLoadStatus(!1),this.immobilisations$=this.immoService.immobilisations$,this.entreprises$=this.reformeService.entreprises$,this.initForm(),this.loadImmobilisations(),this.loadEntreprises()}confirm(){this.activeModal&&this.activeModal.close()}dismiss(){this.activeModal&&this.activeModal.dismiss()}loadImmobilisations(){this.immoService.getImmoFullFromServer()}loadEntreprises(){this.reformeService.getEntreprisesFromServer()}initForm(){this.error$=this.reformeService.error$,this.confirmSubmit$=this.reformeService.confirmSubmit$,this.confirmSubmit$.subscribe(p=>{this.btnSubmit&&p&&(this.reload.emit(!0),this.dismiss())}),this.reformeCessionForm=this.formBuilder.group({immobilisation_id:["",T.required],entreprise_id:["",T.required],comment:["",T.required],documents:[[]]})}onFileSelected(p){let e=p.target.files;if(e&&e.length>0){console.log("Files selected:",e.length);let l=Array.from(e);this.selectedFiles=[...this.selectedFiles,...l],console.log("Total selected files:",this.selectedFiles.map(s=>s.name)),p.target.value=""}}onFileAdd(p){let e=p.target.files;if(e&&e.length>0){console.log("Files to add:",e.length);let l=Array.from(e);this.selectedFiles=[...this.selectedFiles,...l],console.log("Total selected files:",this.selectedFiles.map(s=>s.name)),p.target.value=""}}removeFile(p){this.selectedFiles.splice(p,1)}clearAllFiles(){this.selectedFiles=[]}submitForm(){if(this.reformeCessionForm.valid){this.btnSubmit=!0,console.log(this.reformeCessionForm.value);let p=new FormData,e=this.reformeCessionForm.value;p.append("immobilisation_id",e.immobilisation_id),p.append("entreprise_id",e.entreprise_id),p.append("comment",e.comment),this.selectedFiles.forEach((l,s)=>{p.append(`documents[${s}]`,l)}),this.reformeService.createCession(p),console.log("Form data ready for submission:",p),this.btnSubmit=!1}else console.log("Form is invalid:",this.reformeCessionForm.value),this.btnSubmit=!0}getFormControlErrorText(p){return p?.hasError("required")?this.languageService.instant("FieldRequired"):p?.hasError("minlength")?this.languageService.instant("FieldTooShort"):p?.hasError("maxlength")?this.languageService.instant("FieldTooLong"):""}static \u0275fac=function(e){return new(e||m)(y(O),y(Be,8),y(q),y(k),y(ze))};static \u0275cmp=F({type:m,selectors:[["app-create-reforme-cession"]],outputs:{reload:"reload"},standalone:!1,decls:60,vars:68,consts:[[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button","aria-describedby","modal-title",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit","formGroup"],[1,"form-group","mb-3"],["for","immobilisation_id",1,"form-label"],["bindLabel","name","bindValue","id","formControlName","immobilisation_id",3,"items","placeholder","searchable","clearable"],["ng-option-tmp",""],["class","invalid-feedback",4,"ngIf"],["for","entreprise_id",1,"form-label"],["bindLabel","name","bindValue","id","formControlName","entreprise_id",3,"items","placeholder","searchable","clearable"],["for","comment",1,"form-label"],["id","comment","formControlName","comment","rows","4",1,"form-control",3,"placeholder"],["for","documents",1,"form-label"],[1,"input-group","mb-2"],["type","file","id","documents","multiple","","accept",".pdf,.doc,.docx,.jpg,.jpeg,.png",1,"form-control",3,"change"],["type","button",1,"btn","btn-outline-secondary",3,"click","title"],[1,"fas","fa-trash"],["class","input-group",4,"ngIf"],[1,"form-text","text-muted"],["class","mb-3",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2","role","status",4,"ngIf"],[1,"invalid-feedback"],[1,"input-group"],["type","file","id","additionalDocuments","multiple","","accept",".pdf,.doc,.docx,.jpg,.jpeg,.png",1,"form-control",3,"change"],["for","additionalDocuments",1,"btn","btn-outline-primary"],[1,"fas","fa-plus"],[1,"mb-3"],[1,"d-flex","flex-wrap","gap-2"],["class","badge bg-primary d-flex align-items-center gap-1",4,"ngFor","ngForOf"],[1,"badge","bg-primary","d-flex","align-items-center","gap-1"],[1,"fas","fa-file"],["type","button",1,"btn-close","btn-close-white",2,"font-size","0.6rem",3,"click"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"d-flex","align-items-center"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button","data-bs-dismiss","alert",1,"btn-close"],[1,"text-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["role","status",1,"spinner-border","spinner-border-sm","me-2"]],template:function(e,l){if(e&1&&(n(0,"div",0)(1,"h4",1),r(2),a(3,"translate"),t(),n(4,"button",2),v("click",function(){return l.dismiss()}),t()(),n(5,"div",3)(6,"form",4),v("ngSubmit",function(){return l.submitForm()}),n(7,"div",5)(8,"label",6),r(9),a(10,"translate"),t(),n(11,"ng-select",7),a(12,"async"),a(13,"translate"),C(14,Gi,1,2,"ng-template",8),t(),C(15,qi,2,1,"div",9),t(),n(16,"div",5)(17,"label",10),r(18),a(19,"translate"),t(),n(20,"ng-select",11),a(21,"async"),a(22,"translate"),C(23,Hi,1,2,"ng-template",8),t(),C(24,Wi,2,1,"div",9),t(),n(25,"div",5)(26,"label",12),r(27),a(28,"translate"),t(),n(29,"textarea",13),a(30,"translate"),r(31,"      "),t(),C(32,Qi,2,1,"div",9),t(),n(33,"div",5)(34,"label",14),r(35),a(36,"translate"),t(),n(37,"div",15)(38,"input",16),v("change",function(u){return l.onFileSelected(u)}),t(),n(39,"button",17),a(40,"translate"),v("click",function(){return l.clearAllFiles()}),c(41,"i",18),t()(),C(42,Xi,6,3,"div",19),n(43,"small",20),r(44),a(45,"translate"),t()(),C(46,Ji,6,4,"div",21)(47,Zi,1,1),a(48,"async"),C(49,en,5,3,"div",22),a(50,"async"),t()(),n(51,"div",23)(52,"button",24),v("click",function(){return l.dismiss()}),r(53),a(54,"translate"),t(),n(55,"button",25),v("click",function(){return l.submitForm()}),C(56,tn,4,3,"span",26),a(57,"async"),r(58),a(59,"translate"),t()()),e&2){let s,u,b,g,L,U,pe;i(2),f(" ",o(3,34,"CreateReformeCession")," "),i(4),S("formGroup",l.reformeCessionForm),i(3),f("",o(10,36,"Immobilisation")," *"),i(2),V("is-invalid",((s=l.reformeCessionForm.get("immobilisation_id"))==null?null:s.invalid)&&(((s=l.reformeCessionForm.get("immobilisation_id"))==null?null:s.dirty)||((s=l.reformeCessionForm.get("immobilisation_id"))==null?null:s.touched))),S("items",o(12,38,l.immobilisations$))("placeholder",o(13,40,"SelectImmobilisation"))("searchable",!0)("clearable",!0),i(4),S("ngIf",((u=l.reformeCessionForm.get("immobilisation_id"))==null?null:u.invalid)&&(((u=l.reformeCessionForm.get("immobilisation_id"))==null?null:u.dirty)||((u=l.reformeCessionForm.get("immobilisation_id"))==null?null:u.touched))),i(3),f("",o(19,42,"Company")," *"),i(2),V("is-invalid",((b=l.reformeCessionForm.get("entreprise_id"))==null?null:b.invalid)&&(((b=l.reformeCessionForm.get("entreprise_id"))==null?null:b.dirty)||((b=l.reformeCessionForm.get("entreprise_id"))==null?null:b.touched))),S("items",o(21,44,l.entreprises$))("placeholder",o(22,46,"SelectCompany"))("searchable",!0)("clearable",!0),i(4),S("ngIf",((g=l.reformeCessionForm.get("entreprise_id"))==null?null:g.invalid)&&(((g=l.reformeCessionForm.get("entreprise_id"))==null?null:g.dirty)||((g=l.reformeCessionForm.get("entreprise_id"))==null?null:g.touched))),i(3),f("",o(28,48,"Comment")," *"),i(2),V("is-invalid",((L=l.reformeCessionForm.get("comment"))==null?null:L.invalid)&&(((L=l.reformeCessionForm.get("comment"))==null?null:L.dirty)||((L=l.reformeCessionForm.get("comment"))==null?null:L.touched))),w("placeholder",o(30,50,"EnterComment")),i(3),S("ngIf",((U=l.reformeCessionForm.get("comment"))==null?null:U.invalid)&&(((U=l.reformeCessionForm.get("comment"))==null?null:U.dirty)||((U=l.reformeCessionForm.get("comment"))==null?null:U.touched))),i(3),d(o(36,52,"Documents")),i(4),w("title",o(40,54,"ClearAllFiles")),i(3),S("ngIf",l.selectedFiles.length>0),i(2),f("",o(45,56,"SupportedFormats"),": PDF, DOC, DOCX, JPG, JPEG, PNG"),i(2),S("ngIf",l.selectedFiles.length>0),i(),B((pe=o(48,58,l.error$))?47:-1,pe),i(2),S("ngIf",o(50,60,l.loading$)),i(4),f(" ",o(54,62,"Cancel")," "),i(2),S("disabled",!l.reformeCessionForm.valid||l.btnSubmit),i(),S("ngIf",o(57,64,l.loading$)),i(2),f(" ",o(59,66,"Add")," ")}},dependencies:[Ne,Q,xe,N,j,he,Se,ye,Ge,Ue,R,M],encapsulation:2})};var nn=()=>[5,10,25,100],rn=(m,p)=>p.id;function an(m,p){if(m&1){let e=I();n(0,"div",6)(1,"button",58),v("click",function(){h(e);let s=_();return x(s.closeScan())}),r(2),a(3,"translate"),t()()}m&2&&(i(2),f(" ",o(3,1,"close scan barcode")," "))}function on(m,p){if(m&1){let e=I();n(0,"div",6)(1,"button",58),v("click",function(){h(e);let s=_();return x(s.scanCodeBarre())}),c(2,"i",59),r(3),a(4,"translate"),t()()}m&2&&(i(3),f(" ",o(4,1,"scan a barcode")," "))}function ln(m,p){m&1&&(n(0,"span"),r(1,"..."),t())}function sn(m,p){if(m&1){let e=I();n(0,"tr",60)(1,"td",61),c(2,"input",48),t(),n(3,"td")(4,"div",62)(5,"div",63)(6,"div",64),c(7,"i",65),t()(),n(8,"div",66)(9,"h6",67),r(10),t(),n(11,"p",55),c(12,"i",68),r(13),a(14,"translate"),t(),n(15,"p",55),c(16,"i",69),r(17),a(18,"translate"),t(),n(19,"p",55),c(20,"i",70),r(21),a(22,"translate"),a(23,"currency"),t()()()(),n(24,"td",61)(25,"div",66)(26,"p",55),r(27),a(28,"slice"),C(29,ln,2,0,"span"),t()()(),n(30,"td",61)(31,"div",66)(32,"h6",67),r(33),t(),n(34,"p",55),c(35,"i",71),r(36),t()()(),n(37,"td",72)(38,"span",73),r(39),a(40,"translate"),t()(),n(41,"td",72)(42,"div",74)(43,"div",75)(44,"div",64),r(45),t()(),n(46,"div",76)(47,"h6",77),r(48),t(),n(49,"p",55),r(50),a(51,"date"),t()()()(),n(52,"td",72)(53,"div",36)(54,"button",78),c(55,"i",79),t(),n(56,"ul",39)(57,"li")(58,"a",80),v("click",function(){let s=h(e).$implicit,u=_(2);return x(u.viewDetails(s.id))}),c(59,"i",81),r(60),a(61,"translate"),t()(),n(62,"li")(63,"a",80),v("click",function(){let s=h(e).$implicit,u=_(2);return x(u.viewImmobilisationDetails(s.immobilisation_id))}),c(64,"i",82),r(65),a(66,"translate"),t()()()()()()}if(m&2){let e=p.$implicit;i(10),d(e.immobilisation.name||"N/A"),i(3),E("",o(14,20,"Code"),": ",e.immobilisation.code||"N/A"," "),i(4),E("",o(18,22,"Category"),": ",e.immobilisation.categorie.name||"N/A"," "),i(4),E("",o(22,24,"Value"),": ",K(23,26,e.immobilisation.unit_price,"XAF","symbol","1.0-0")," "),i(6),f(" ",ne(28,31,e.comment,0,50)," "),i(2),B(e.comment.length>50?29:-1),i(4),d(e.entreprise.name||"N/A"),i(3),f("NUI: ",e.entreprise.nui||"N/A"," "),i(2),S("ngClass",e.documents.length>0?"bg-gradient-success":"bg-gradient-secondary"),i(),E(" ",e.documents.length," ",o(40,35,"files")," "),i(6),f(" ",e.user.first_name.charAt(0)||"U"," "),i(3),E("",e.user.first_name," ",e.user.last_name,""),i(2),d(be(51,37,e.created_at,"shortDate")),i(10),f("",o(61,40,"View")," "),i(5),f("",o(66,42,"ViewImmobilisationDetails")," ")}}function mn(m,p){m&1&&H(0,sn,67,44,"tr",60,rn),m&2&&W(p)}function pn(m,p){m&1&&(n(0,"tr")(1,"td",83)(2,"div",84),c(3,"i",85),n(4,"h6",86),r(5),a(6,"translate"),t(),n(7,"p",87),r(8),a(9,"translate"),t()()()()),m&2&&(i(5),d(o(6,2,"NoCessionAssetsAvailable")),i(3),d(o(9,4,"AddFirst")))}var ft=class m extends z{constructor(e,l,s,u,b,g){super();this.languageService=e;this.reformService=l;this.modalService=s;this.router=u;this.formBuilder=b;this.route=g}loading$;itemsPerPage=10;paginateData$;paginateData;totaElement=0;pageEvent;pageArray=[];searchCtrl;reformeCessions$;Math=Math;barcodeScanner;isActiveScan=!1;currentSortBy="created_at";sortDirection="desc";startDate="";endDate="";ngOnInit(){console.log("init"),this.loading$=this.reformService.loading$,this.searchCtrl=this.formBuilder.control(""),this.reformeCessions$=this.reformService.cessions$,this.paginateData$=this.reformService.paginateData$,this.paginateData$.subscribe(e=>{this.paginateData=e,this.totaElement=e.total??0,this.changeChoiceItemPage()}),this.reformeCessions$.subscribe(e=>{this.isActiveScan&&e.length==1&&(this.isActiveScan=!1,this.barcodeScanner.stop(),this.reformService.setSnackMesage("Cession trouv\xE9e : "+e[0].id))}),this.searchCtrl.valueChanges.pipe(ce(300),fe()).subscribe(()=>{this.applyFilters()}),this.applyFilters()}pageChange(e){return this.paginateData.current_page=e.pageIndex+1,this.paginateData.per_page=e.pageSize,this.applyFilters(),e}applyFilters(){let e=[];this.searchCtrl.value&&e.push(Ie(this.searchCtrl.value)),this.startDate&&e.push(P("start_date",this.startDate)),this.endDate&&e.push(P("end_date",this.endDate)),e.push(P("sort_by",this.currentSortBy)),e.push(P("sort_direction",this.sortDirection)),this.reformService.getCessionFromServer(this.paginateData,e)}resetFilters(){this.searchCtrl.setValue(""),this.startDate="",this.endDate="",this.currentSortBy="created_at",this.sortDirection="desc",this.applyFilters()}sortBy(e){this.currentSortBy===e?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.currentSortBy=e,this.sortDirection="asc"),this.applyFilters()}getSortIcon(e){return this.currentSortBy!==e?"fas fa-sort text-muted":this.sortDirection==="asc"?"fas fa-sort-up text-primary":"fas fa-sort-down text-primary"}createReformeCession(){this.modalService.open(qe,{size:"lg",centered:!0,backdrop:"static"}).componentInstance.reload.subscribe(l=>{l&&this.applyFilters()})}viewDetails(e){this.router.navigate(["/admin/reformes/cessions/detail",e])}viewImmobilisationDetails(e){this.router.navigate(["/admin/immobilisations/detail",e])}onSearchChange(e){let l=e.target;this.searchCtrl.setValue(l.value)}onStartDateChange(e){let l=e.target;this.startDate=l.value,this.applyFilters()}onEndDateChange(e){let l=e.target;this.endDate=l.value,this.applyFilters()}onValueChanges(e){console.log("valueChanges :",e.codeResult.code),e.codeResult.code.length>8&&(console.log("valueChanges 2 : ",e.codeResult.code),this.searchCtrl.setValue(e.codeResult.code),this.applyFilters())}scanCodeBarre(){this.barcodeScanner&&typeof this.barcodeScanner.start=="function"&&(this.barcodeScanner.start(),this.isActiveScan=!0)}closeScan(){this.barcodeScanner.stop(),this.isActiveScan=!1}onStarted(e){console.log("started :",e)}changeChoiceItemPage(){let e=[];if(this.totaElement<=2)e.push(this.totaElement);else{for(let l=1;l<this.totaElement/2;l++)e.push(l*2);this.totaElement%2>0&&e.push(this.totaElement)}this.pageArray=e}static \u0275fac=function(l){return new(l||m)(y(O),y(k),y(Ee),y(G),y(q),y(J))};static \u0275cmp=F({type:m,selectors:[["app-list-reforme-cession"]],viewQuery:function(l,s){if(l&1&&Ve(oe,5),l&2){let u;Ae(u=$e())&&(s.barcodeScanner=u.first)}},standalone:!1,features:[ge],decls:133,vars:101,consts:[["barcodeScanner",""],["nameOption","Cession Assets"],[1,"row","col-6"],["type","code_128",3,"valueChanges","started"],["class","col-lg-8 col-md-6 col-12",4,"ngIf"],[1,"row","mb-4"],[1,"col-lg-8","col-md-6","col-12"],[1,"d-flex","align-items-center"],[1,"mb-0","text-dark"],[1,"badge","bg-gradient-info","ms-2"],[1,"text-sm","text-secondary","mb-0"],[1,"col-lg-4","col-md-6","col-12","text-end"],[1,"btn","btn-info","btn-sm","mb-0",3,"click"],[1,"fas","fa-plus","me-2"],[1,"col-12"],[1,"card"],[1,"card-body","p-3"],[1,"row","align-items-center"],[1,"col-lg-4","col-md-6","col-12"],[1,"form-group","mb-0"],[1,"form-label","text-xs"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text",1,"form-control",3,"placeholder","formControl"],[1,"col-lg-2","col-md-6","col-12"],["type","date",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-lg-1","col-md-6","col-12"],[1,"form-label","text-xs","opacity-0"],[1,"btn","btn-outline-secondary","btn-sm","w-100",3,"click","title"],[1,"fas","fa-undo"],[1,"row"],[1,"card-header","pb-0"],[1,"col-lg-6","col-7"],[1,"mb-0"],[1,"col-lg-6","col-5","text-end"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-sm","btn-outline-primary","dropdown-toggle"],[1,"fas","fa-download","me-1"],[1,"dropdown-menu"],[1,"dropdown-item"],[1,"fas","fa-file-excel","me-2"],[1,"fas","fa-file-pdf","me-2"],[1,"fas","fa-file-csv","me-2"],[1,"card-body","px-0","pt-0","pb-2"],[1,"table-responsive","p-0"],[1,"table","align-items-center","mb-0"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","ps-2"],["type","checkbox",1,"form-check-input"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","cursor-pointer",3,"click"],[1,"ms-1"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","cursor-pointer",3,"click"],[1,"card-footer"],[1,"col-lg-6","col-sm-12","text-start"],[1,"text-xs","text-secondary","mb-0"],[1,"col-lg-6","col-sm-12","text-end"],["showFirstLastButtons","",3,"page","length","pageSize","pageIndex","pageSizeOptions"],[1,"btn","btn-outline-info","btn-sm","mb-1","me-2",3,"click"],[1,"fas","fa-barcode","me-2"],[1,"hover-row"],[1,"ps-2"],[1,"d-flex","px-2","py-1"],[1,"avatar","avatar-sm","me-3"],[1,"avatar-initial","rounded-circle","bg-gradient-info"],[1,"fas","fa-handshake"],[1,"d-flex","flex-column","justify-content-center"],[1,"mb-0","text-sm"],[1,"fas","fa-barcode","me-1"],[1,"fas","fa-tag","me-1"],[1,"fas","fa-dollar-sign","me-1"],[1,"fas","fa-id-card","me-1"],[1,"text-center"],[1,"badge","badge-sm",3,"ngClass"],[1,"d-flex","align-items-center","justify-content-center"],[1,"avatar","avatar-xs","me-2"],[1,"d-flex","flex-column"],[1,"mb-0","text-xs"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-link","text-secondary","p-0","dropdown-toggle"],[1,"fas","fa-ellipsis-v"],[1,"dropdown-item",3,"click"],[1,"fas","fa-eye","me-2"],[1,"fas","fa-info-circle","me-2"],["colspan","7",1,"text-center","py-4"],[1,"d-flex","flex-column","align-items-center"],[1,"fas","fa-handshake","fa-3x","text-secondary","mb-3"],[1,"text-secondary"],[1,"text-xs","text-secondary"]],template:function(l,s){if(l&1){let u=I();n(0,"app-base",1)(1,"div",2)(2,"barcode-scanner-livestream",3,0),v("valueChanges",function(g){return h(u),x(s.onValueChanges(g))})("started",function(){return h(u),x(s.onStarted(!0))}),t(),C(4,an,4,3,"div",4),t(),C(5,on,5,3,"div",4),n(6,"div",5)(7,"div",6)(8,"div",7)(9,"h4",8),r(10),a(11,"translate"),t(),n(12,"span",9),r(13),a(14,"async"),a(15,"translate"),t()(),n(16,"p",10),r(17),a(18,"translate"),t()(),n(19,"div",11)(20,"button",12),v("click",function(){return h(u),x(s.createReformeCession())}),c(21,"i",13),r(22),a(23,"translate"),a(24,"translate"),t()()(),n(25,"div",5)(26,"div",14)(27,"div",15)(28,"div",16)(29,"div",17)(30,"div",18)(31,"div",19)(32,"label",20),r(33),a(34,"translate"),t(),n(35,"div",21)(36,"span",22),c(37,"i",23),t(),c(38,"input",24),a(39,"translate"),t()()(),n(40,"div",25)(41,"div",19)(42,"label",20),r(43),a(44,"translate"),t(),n(45,"input",26),ie("ngModelChange",function(g){return h(u),te(s.startDate,g)||(s.startDate=g),x(g)}),v("change",function(){return h(u),x(s.applyFilters())}),t()()(),n(46,"div",25)(47,"div",19)(48,"label",20),r(49),a(50,"translate"),t(),n(51,"input",26),ie("ngModelChange",function(g){return h(u),te(s.endDate,g)||(s.endDate=g),x(g)}),v("change",function(){return h(u),x(s.applyFilters())}),t()()(),n(52,"div",27)(53,"div",19)(54,"label",28),r(55),a(56,"translate"),t(),n(57,"button",29),a(58,"translate"),v("click",function(){return h(u),x(s.resetFilters())}),c(59,"i",30),t()()()()()()()(),n(60,"div",31)(61,"div",14)(62,"div",15)(63,"div",32)(64,"div",17)(65,"div",33)(66,"h6",34),r(67),a(68,"translate"),t()(),n(69,"div",35)(70,"div",36)(71,"button",37),c(72,"i",38),r(73),a(74,"translate"),t(),n(75,"ul",39)(76,"li")(77,"a",40),c(78,"i",41),r(79),a(80,"translate"),t()(),n(81,"li")(82,"a",40),c(83,"i",42),r(84),a(85,"translate"),t()(),n(86,"li")(87,"a",40),c(88,"i",43),r(89),a(90,"translate"),t()()()()()()(),n(91,"div",44)(92,"div",45)(93,"table",46)(94,"thead")(95,"tr")(96,"th",47),c(97,"input",48),t(),n(98,"th",49),v("click",function(){return h(u),x(s.sortBy("immobilisation"))}),r(99),a(100,"translate"),c(101,"i",50),t(),n(102,"th",47),r(103),a(104,"translate"),t(),n(105,"th",47),r(106),a(107,"translate"),t(),n(108,"th",51),r(109),a(110,"translate"),t(),n(111,"th",52),v("click",function(){return h(u),x(s.sortBy("created_at"))}),r(112),a(113,"translate"),c(114,"i",50),t(),n(115,"th",51),r(116),a(117,"translate"),t()()(),n(118,"tbody"),C(119,mn,2,0),a(120,"async"),C(121,pn,10,6,"tr"),t()()()(),n(122,"div",53)(123,"div",17)(124,"div",54)(125,"p",55),r(126),a(127,"translate"),a(128,"translate"),a(129,"translate"),a(130,"translate"),t()(),n(131,"div",56)(132,"mat-paginator",57),v("page",function(g){return h(u),x(s.pageChange(g))}),t()()()()()()()()}if(l&2){let u,b;i(4),S("ngIf",s.isActiveScan),i(),S("ngIf",!s.isActiveScan),i(5),d(o(11,44,"CessionAssets")),i(3),E("",((u=o(14,46,s.reformeCessions$))==null?null:u.length)||0," ",o(15,48,"items"),""),i(4),d(o(18,50,"ManageCessionAssetsForReform")),i(5),E(" ",o(23,52,"AddU")," ",o(24,54,"Immobilisation")," "),i(11),d(o(34,56,"Search")),i(5),w("placeholder",o(39,58,"SearchByAssetOrComment")),S("formControl",s.searchCtrl),i(5),d(o(44,60,"DateFrom")),i(2),ee("ngModel",s.startDate),i(4),d(o(50,62,"DateTo")),i(2),ee("ngModel",s.endDate),i(4),d(o(56,64,"Actions")),i(2),w("title",o(58,66,"ResetFilters")),i(10),d(o(68,68,"CessionAssetsList")),i(6),f("",o(74,70,"Export")," "),i(6),d(o(80,72,"Excel")),i(5),d(o(85,74,"PDF")),i(5),d(o(90,76,"CSV")),i(10),f(" ",o(100,78,"Asset")," "),i(2),D(s.getSortIcon("immobilisation")),i(2),f(" ",o(104,80,"Comment")," "),i(3),f(" ",o(107,82,"Company")," "),i(3),f(" ",o(110,84,"Documents")," "),i(3),f(" ",o(113,86,"CreatedAt")," "),i(2),D(s.getSortIcon("created_at")),i(2),f(" ",o(117,88,"Actions")," "),i(3),B((b=o(120,90,s.reformeCessions$))?119:121,b),i(7),ve(" ",o(127,92,"Showing")," ",(s.paginateData.current_page-1)*s.paginateData.per_page+1," ",o(128,94,"to")," ",s.Math.min(s.paginateData.current_page*s.paginateData.per_page,s.totaElement)," ",o(129,96,"of")," ",s.totaElement," ",o(130,98,"entries")," "),i(6),S("length",s.totaElement)("pageSize",s.paginateData.per_page)("pageIndex",s.paginateData.current_page-1)("pageSizeOptions",rt(100,nn))}},dependencies:[Y,Q,N,j,Ce,z,Me,we,oe,R,ae,re,_e,M],encapsulation:2})};function dn(m,p){if(m&1&&(n(0,"div",3),c(1,"i",4),r(2),c(3,"button",5),t()),m&2){let e=_();i(2),f(" ",e.message," ")}}function cn(m,p){m&1&&C(0,dn,4,1,"div",3),m&2&&B(p.status?0:-1)}function fn(m,p){m&1&&(n(0,"div",2)(1,"div",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"span",10),r(6),a(7,"translate"),t()(),n(8,"p",11),r(9),a(10,"translate"),t()()()()()),m&2&&(i(6),f("",o(7,2,"Loading"),"..."),i(3),f("",o(10,4,"LoadingCessionAssetDetails"),"..."))}function un(m,p){if(m&1&&(n(0,"div",29)(1,"div",39)(2,"label",37),r(3),a(4,"translate"),t(),n(5,"p",40),r(6),t()(),n(7,"div",39)(8,"label",37),r(9),a(10,"translate"),t(),n(11,"p",40),r(12),t()(),n(13,"div",39)(14,"label",37),r(15),a(16,"translate"),t(),n(17,"p",40),r(18),t()(),n(19,"div",39)(20,"label",37),r(21),a(22,"translate"),t(),n(23,"p",40),r(24),t()(),n(25,"div",39)(26,"label",37),r(27),a(28,"translate"),t(),n(29,"p",40),r(30),t()(),n(31,"div",39)(32,"label",37),r(33),a(34,"translate"),t(),n(35,"p",40),r(36),t()(),n(37,"div",39)(38,"label",37),r(39),a(40,"translate"),t(),n(41,"p",40),r(42),a(43,"currency"),t()(),n(44,"div",39)(45,"label",37),r(46),a(47,"translate"),t(),n(48,"p",40)(49,"span",47),r(50),t()()()()),m&2){let e=_(2);i(3),d(o(4,17,"AssetName")),i(3),d(e.reformeCession.immobilisation.name),i(3),d(o(10,19,"AssetCode")),i(3),d(e.reformeCession.immobilisation.code),i(3),d(o(16,21,"Category")),i(3),d(e.reformeCession.immobilisation.categorie.name),i(3),d(o(22,23,"Brand")),i(3),d(e.reformeCession.immobilisation.mark||"N/A"),i(3),d(o(28,25,"Model")),i(3),d(e.reformeCession.immobilisation.model||"N/A"),i(3),d(o(34,27,"Quantity")),i(3),d(e.reformeCession.immobilisation.quantity),i(3),d(o(40,29,"PurchaseValue")),i(3),d(K(43,31,e.reformeCession.immobilisation.unit_price,"XOF","symbol","1.0-0")),i(4),d(o(47,36,"Status")),i(3),S("ngClass",e.getStatusBadgeClass(e.reformeCession.immobilisation.status)),i(),f(" ",e.reformeCession.immobilisation.status," ")}}function gn(m,p){if(m&1&&(n(0,"div",29)(1,"div",39)(2,"label",37),r(3),a(4,"translate"),t(),n(5,"p",40),r(6),t()(),n(7,"div",39)(8,"label",37),r(9),a(10,"translate"),t(),n(11,"p",40),r(12),t()(),n(13,"div",39)(14,"label",37),r(15),a(16,"translate"),t(),n(17,"p",40),r(18),t()(),n(19,"div",39)(20,"label",37),r(21),a(22,"translate"),t(),n(23,"p",40),r(24),t()()()),m&2){let e=_(2);i(3),d(o(4,8,"CompanyName")),i(3),d(e.reformeCession.entreprise.name),i(3),d(o(10,10,"NUI")),i(3),d(e.reformeCession.entreprise.nui||"N/A"),i(3),d(o(16,12,"Phone")),i(3),d(e.reformeCession.entreprise.tel||"N/A"),i(3),d(o(22,14,"Address")),i(3),d(e.reformeCession.entreprise.adresse||"N/A")}}function vn(m,p){if(m&1){let e=I();n(0,"div",48)(1,"div",49),c(2,"i",50),n(3,"span",51),r(4),a(5,"slice"),t()(),n(6,"button",52),v("click",function(){let s=h(e).$implicit,u=_(3);return x(u.downloadDocument(s))}),c(7,"i",53),t()()}if(m&2){let e=p.$implicit,l=_(3);i(2),D(l.getFileIcon(e)),i(2),d(ne(5,3,e.split("/").pop(),0,10))}}function bn(m,p){if(m&1&&(n(0,"div",42),H(1,vn,8,7,"div",48,Le),t()),m&2){let e=_(2);i(),W(e.reformeCession.documents)}}function _n(m,p){m&1&&(n(0,"p",43),r(1),a(2,"translate"),t()),m&2&&(i(),d(o(2,1,"NoDocumentsAvailable")))}function hn(m,p){if(m&1){let e=I();n(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17)(6,"div",18)(7,"div",19),c(8,"i",20),t(),n(9,"div")(10,"h3",21),r(11),a(12,"translate"),t(),n(13,"p",22),c(14,"i",23),r(15),t()()()(),n(16,"div",24)(17,"button",25),v("click",function(){h(e);let s=_();return x(s.goBack())}),c(18,"i",26),r(19),a(20,"translate"),t(),n(21,"button",27),v("click",function(){h(e);let s=_();return x(s.viewImmobilisationDetails())}),c(22,"i",28),r(23),a(24,"translate"),t()()()()()()(),n(25,"div",29)(26,"div",30)(27,"div",31)(28,"div",32)(29,"h6",21),r(30),a(31,"translate"),t()(),n(32,"div",33),C(33,un,51,38,"div",34),t()(),n(34,"div",31)(35,"div",32)(36,"h6",21),r(37),a(38,"translate"),t()(),n(39,"div",33),C(40,gn,25,16,"div",34),t()(),n(41,"div",35)(42,"div",32)(43,"h6",21),r(44),a(45,"translate"),t()(),n(46,"div",33)(47,"div",29)(48,"div",36)(49,"label",37),r(50),a(51,"translate"),t(),n(52,"div",38)(53,"p",21),r(54),t()()(),n(55,"div",39)(56,"label",37),r(57),a(58,"translate"),t(),n(59,"p",40),r(60),t()(),n(61,"div",39)(62,"label",37),r(63),a(64,"translate"),t(),n(65,"p",40),r(66),t()(),n(67,"div",39)(68,"label",37),r(69),a(70,"translate"),t(),n(71,"p",40),r(72),t()()()()()(),n(73,"div",41)(74,"div",31)(75,"div",32)(76,"h6",21),r(77),a(78,"translate"),t()(),n(79,"div",33),C(80,bn,3,0,"div",42)(81,_n,3,3,"p",43),t()(),n(82,"div",35)(83,"div",32)(84,"h6",21),r(85),a(86,"translate"),t()(),n(87,"div",33)(88,"div",44)(89,"button",45),v("click",function(){h(e);let s=_();return x(s.viewImmobilisationDetails())}),c(90,"i",28),r(91),a(92,"translate"),t(),n(93,"button",46),v("click",function(){h(e);let s=_();return x(s.goBack())}),c(94,"i",26),r(95),a(96,"translate"),t()()()()()()}if(m&2){let e=_();i(11),d(o(12,23,"CessionAssetDetails")),i(4),f("",e.formatDate(e.reformeCession.created_at)," "),i(4),f("",o(20,25,"Back")," "),i(4),f("",o(24,27,"ViewImmobilisationDetails")," "),i(7),d(o(31,29,"AssetInformation")),i(3),S("ngIf",e.reformeCession.immobilisation),i(4),d(o(38,31,"CompanyInformation")),i(3),S("ngIf",e.reformeCession.entreprise),i(4),d(o(45,33,"CessionAssetInformation")),i(6),d(o(51,35,"Comment")),i(4),d(e.reformeCession.comment||"N/A"),i(3),d(o(58,37,"CreatedAt")),i(3),d(e.formatDate(e.reformeCession.created_at)),i(3),d(o(64,39,"UpdatedAt")),i(3),d(e.formatDate(e.reformeCession.updated_at)),i(3),d(o(70,41,"CreatedBy")),i(3),E("",e.reformeCession.user.first_name," ",e.reformeCession.user.last_name,""),i(5),d(o(78,43,"Documents")),i(3),B(e.reformeCession.documents&&e.reformeCession.documents.length>0?80:81),i(5),d(o(86,45,"Actions")),i(6),f("",o(92,47,"ViewImmobilisationDetails")," "),i(4),f("",o(96,49,"BackToList")," ")}}function xn(m,p){if(m&1){let e=I();n(0,"div",2)(1,"div",54)(2,"div",7)(3,"div",8),c(4,"i",55),n(5,"h5",56),r(6),a(7,"translate"),t(),n(8,"p",57),r(9),a(10,"translate"),t(),n(11,"button",58),v("click",function(){h(e);let s=_();return x(s.goBack())}),c(12,"i",26),r(13),a(14,"translate"),t()()()()()}m&2&&(i(6),d(o(7,3,"CessionAssetNotFound")),i(3),d(o(10,5,"CessionAssetNotFoundDescription")),i(4),f("",o(14,7,"BackToList")," "))}var ut=class m{constructor(p,e,l,s){this.route=p;this.router=e;this.reformeService=l;this.languageService=s;this.loading$=this.reformeService.loading$,this.error$=this.reformeService.error$}destroy$=new Re;reformeCession;loading$;error$;reformeCessionId=null;ngOnInit(){this.reformeCessionId=this.route.snapshot.paramMap.get("id"),this.reformeCessionId&&this.loadReformeCessionDetail()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadReformeCessionDetail(){this.reformeCessionId&&(this.reformeCession={id:this.reformeCessionId,immobilisation_id:"1",entreprise_id:"1",comment:"Cession temporaire pour d\xE9monstration",documents:["doc1.pdf","doc2.jpg"],user_id:"1",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),immobilisation:{id:"1",name:"Ordinateur portable",code:"ORD001",categorie:{id:"1",name:"Informatique"},mark:"Dell",model:"Latitude",unit_price:15e4,quantity:1,status:"cession",date_of_receipt:new Date().toISOString()},entreprise:{id:"1",name:"Entreprise ABC",nui:"123456789",adresse:"123 Rue de la Paix",tel:"+237 123 456 789",is_physic:!1,user_id:"1",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),user:{id:"1",first_name:"Admin",last_name:"User"}},user:{id:"1",first_name:"Admin",last_name:"User",email:"admin@example.com"}})}goBack(){this.router.navigate(["/admin/reformes/cession"],{relativeTo:this.route})}viewImmobilisationDetails(){this.reformeCession&&this.router.navigate(["/admin/immobilisations/detail",this.reformeCession.immobilisation_id])}getStatusBadgeClass(p){switch(p.toLowerCase()){case"active":return"bg-gradient-success";case"inactive":return"bg-gradient-secondary";case"maintenance":return"bg-gradient-warning";case"broken":return"bg-gradient-danger";case"cession":return"bg-gradient-info";case"sale":return"bg-gradient-primary";default:return"bg-gradient-secondary"}}formatDate(p){return new Date(p).toLocaleDateString("fr-FR")}downloadDocument(p){window.open(p,"_blank")}getFileIcon(p){switch(p.split(".").pop()?.toLowerCase()){case"pdf":return"fas fa-file-pdf";case"doc":case"docx":return"fas fa-file-word";case"jpg":case"jpeg":case"png":return"fas fa-file-image";default:return"fas fa-file"}}static \u0275fac=function(e){return new(e||m)(y(J),y(G),y(k),y(O))};static \u0275cmp=F({type:m,selectors:[["app-detail-reforme-cession"]],standalone:!1,decls:10,vars:12,consts:[[1,"main-content","position-relative","max-height-vh-100","h-100","detail-reforme-cession"],[1,"container-fluid","py-4"],[1,"row","justify-content-center"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button","data-bs-dismiss","alert",1,"btn-close"],[1,"col-12","text-center"],[1,"card","shadow-lg"],[1,"card-body","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"text-secondary","mt-3"],[1,"row","mb-4"],[1,"col-12"],[1,"card","bg-gradient-info","shadow-lg","border-0"],[1,"card-body","p-4"],[1,"row","align-items-center"],[1,"col-md-8"],[1,"d-flex","align-items-center","text-white"],[1,"icon","icon-shape","icon-lg","bg-white","shadow","text-center","me-3"],[1,"fas","fa-handshake","text-info"],[1,"mb-0"],[1,"text-sm","opacity-8","mb-0"],[1,"fas","fa-calendar","me-2"],[1,"col-md-4","text-end"],[1,"btn","btn-white","btn-sm","me-2",3,"click"],[1,"fas","fa-arrow-left","me-2"],[1,"btn","btn-light","btn-sm",3,"click"],[1,"fas","fa-info-circle","me-2"],[1,"row"],[1,"col-lg-8"],[1,"card","shadow-sm","mb-4"],[1,"card-header","pb-0"],[1,"card-body"],["class","row",4,"ngIf"],[1,"card","shadow-sm"],[1,"col-12","mb-3"],[1,"form-label","text-sm","text-secondary"],[1,"p-3","bg-light","rounded"],[1,"col-md-6","mb-3"],[1,"form-control-plaintext"],[1,"col-lg-4"],[1,"list-group","list-group-flush"],[1,"text-muted","text-center","py-3"],[1,"d-grid","gap-2"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"btn","btn-outline-secondary","btn-sm",3,"click"],[1,"badge",3,"ngClass"],[1,"list-group-item","d-flex","justify-content-between","align-items-center","px-0"],[1,"d-flex","align-items-center"],[1,"text-primary","me-2"],[1,"text-sm"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"fas","fa-download"],[1,"col-md-6","text-center"],[1,"fas","fa-handshake","text-info","fa-3x","mb-3"],[1,"text-secondary"],[1,"text-muted"],[1,"btn","btn-primary",3,"click"]],template:function(e,l){if(e&1&&(n(0,"div",0)(1,"div",1),C(2,cn,1,1),a(3,"async"),C(4,fn,11,6,"div",2),a(5,"async"),C(6,hn,97,51),a(7,"async"),C(8,xn,15,9,"div",2),a(9,"async"),t()()),e&2){let s;i(2),B((s=o(3,4,l.error$))?2:-1,s),i(2),B(o(5,6,l.loading$)?4:-1),i(2),B(!o(7,8,l.loading$)&&l.reformeCession?6:-1),i(2),B(!o(9,10,l.loading$)&&!l.reformeCession?8:-1)}},dependencies:[Y,Q,R,ae,re,M],styles:[".detail-reforme-cession[_ngcontent-%COMP%]{min-height:100vh;background-color:#f8f9fa}.card[_ngcontent-%COMP%]{border:none;border-radius:15px;box-shadow:0 4px 6px #00000012;transition:all .3s ease}.card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 25px #00000026}.card-header[_ngcontent-%COMP%]{background-color:transparent;border-bottom:1px solid rgba(0,0,0,.125);padding:1.5rem}.card-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#344767;font-weight:600;margin-bottom:0}.form-label[_ngcontent-%COMP%]{font-weight:600;color:#67748e;margin-bottom:.5rem;font-size:.875rem}.form-control-plaintext[_ngcontent-%COMP%]{padding:.5rem 0;margin-bottom:0;font-size:.875rem;color:#344767;font-weight:500}.bg-light[_ngcontent-%COMP%]{background-color:#f8f9fa!important;border-radius:8px}.bg-gradient-info[_ngcontent-%COMP%]{background:linear-gradient(87deg,#11cdef 0,#1171ef)}.text-info[_ngcontent-%COMP%]{color:#11cdef!important}.icon-shape[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center}.icon-lg[_ngcontent-%COMP%]{width:64px;height:64px}.shadow-lg[_ngcontent-%COMP%]{box-shadow:0 15px 35px #32325d1a,0 5px 15px #00000012!important}.shadow-sm[_ngcontent-%COMP%]{box-shadow:0 2px 9px #00000026!important}.list-group-item[_ngcontent-%COMP%]{border:none;padding:.75rem 0;border-bottom:1px solid rgba(0,0,0,.125)}.list-group-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.btn-white[_ngcontent-%COMP%]{background-color:#fff;border-color:#fff;color:#344767}.btn-white[_ngcontent-%COMP%]:hover{background-color:#ffffffe6;border-color:#ffffffe6;color:#344767}.btn-light[_ngcontent-%COMP%]{background-color:#fff3;border-color:#fff3;color:#fff}.btn-light[_ngcontent-%COMP%]:hover{background-color:#ffffff4d;border-color:#ffffff4d;color:#fff}.opacity-8[_ngcontent-%COMP%]{opacity:.8}.badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.35em .65em}.bg-gradient-success[_ngcontent-%COMP%]{background:linear-gradient(87deg,#2dce89 0,#2dcecc)}.bg-gradient-danger[_ngcontent-%COMP%]{background:linear-gradient(87deg,#f5365c 0,#f56036)}.bg-gradient-warning[_ngcontent-%COMP%]{background:linear-gradient(87deg,#fb6340 0,#fbb140)}.bg-gradient-secondary[_ngcontent-%COMP%]{background:linear-gradient(87deg,#8392ab 0,#83a9ab)}.bg-gradient-primary[_ngcontent-%COMP%]{background:linear-gradient(87deg,#5e72e4 0,#825ee4)}@media (max-width: 768px){.detail-reforme-cession[_ngcontent-%COMP%]   .container-fluid[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{padding:1rem}.icon-shape[_ngcontent-%COMP%]{width:40px;height:40px}.icon-lg[_ngcontent-%COMP%]{width:48px;height:48px}}@media (max-width: 576px){.btn-white[_ngcontent-%COMP%], .btn-light[_ngcontent-%COMP%]{width:100%;margin-bottom:.5rem}.col-md-4.text-end[_ngcontent-%COMP%]{text-align:center!important}}"]})};function Cn(m,p){if(m&1&&r(0),m&2){let e=p.item;E(" ",e.name," - ",e.code," ")}}function Sn(m,p){if(m&1&&(n(0,"div",29),r(1),t()),m&2){let e=_();i(),f(" ",e.getFormControlErrorText(e.reformeSaleForm.get("immobilisation_id"))," ")}}function yn(m,p){if(m&1&&r(0),m&2){let e=p.item;Bt(" ",e.first_name," ",e.last_name," - ",e.cni," ")}}function Bn(m,p){if(m&1&&(n(0,"div",29),r(1),t()),m&2){let e=_();i(),f(" ",e.getFormControlErrorText(e.reformeSaleForm.get("buyer_id"))," ")}}function En(m,p){if(m&1&&(n(0,"div",29),r(1),t()),m&2){let e=_();i(),f(" ",e.getFormControlErrorText(e.reformeSaleForm.get("amount"))," ")}}function In(m,p){if(m&1){let e=I();n(0,"div",33),c(1,"i",34),n(2,"span"),r(3),t(),n(4,"button",35),v("click",function(){let s=h(e).index,u=_(2);return x(u.removeFile(s))}),t()()}if(m&2){let e=p.$implicit;i(3),d(e.name)}}function wn(m,p){if(m&1&&(n(0,"div",30)(1,"h6"),r(2),a(3,"translate"),t(),n(4,"div",31),C(5,In,5,1,"div",32),t()()),m&2){let e=_();i(2),f("",o(3,2,"SelectedFiles"),":"),i(3),S("ngForOf",e.selectedFiles)}}function kn(m,p){if(m&1&&(n(0,"div",36)(1,"div",37),c(2,"i",38),n(3,"span"),r(4),t()(),c(5,"button",39),t()),m&2){let e=_();i(4),d(e.message)}}function Fn(m,p){m&1&&C(0,kn,6,1,"div",36),m&2&&B(p.status?0:-1)}function Dn(m,p){m&1&&(n(0,"div",40)(1,"div",41)(2,"span",42),r(3),a(4,"translate"),t()()()),m&2&&(i(3),f("",o(4,1,"Loading"),"..."))}function Mn(m,p){m&1&&(n(0,"span",43)(1,"span",42),r(2),a(3,"translate"),t()()),m&2&&(i(2),f("",o(3,1,"Loading"),"..."))}var He=class m{constructor(p,e,l,s,u){this.languageService=p;this.activeModal=e;this.formBuilder=l;this.reformeService=s;this.immoService=u}reload=new ue;loading$;reformeSaleForm;btnSubmit=!1;error$;confirmSubmit$;immobilisations$;buyers$;selectedFiles=[];ngOnInit(){this.loading$=this.reformeService.loading$,this.reformeService.setLoadStatus(!1),this.immobilisations$=this.immoService.immobilisations$,this.buyers$=this.reformeService.buyers$,this.initForm(),this.loadImmobilisations(),this.loadBuyers()}confirm(){this.activeModal&&this.activeModal.close("created")}dismiss(){this.activeModal&&this.activeModal.dismiss()}loadImmobilisations(){this.immoService.getImmoFullFromServer()}loadBuyers(){this.reformeService.getBuyersFullFromServer()}initForm(){this.error$=this.reformeService.error$,this.confirmSubmit$=this.reformeService.confirmSubmit$,this.confirmSubmit$.subscribe(p=>{this.btnSubmit&&p&&(this.reload.emit(!0),this.confirm())}),this.reformeSaleForm=this.formBuilder.group({immobilisation_id:["",T.required],buyer_id:["",T.required],amount:["",[T.required,T.min(0)]],comment:[""],documents:[[]]})}onFileSelected(p){let e=p.target.files;if(e&&e.length>0){console.log("Files selected:",e.length);let l=Array.from(e);this.selectedFiles=[...this.selectedFiles,...l],console.log("Total selected files:",this.selectedFiles.map(s=>s.name)),p.target.value=""}}clearAllFiles(){this.selectedFiles=[]}removeFile(p){this.selectedFiles.splice(p,1)}submitForm(){if(this.reformeSaleForm.valid){this.btnSubmit=!0,console.log(this.reformeSaleForm.value);let p=new FormData,e=this.reformeSaleForm.value;p.append("immobilisation_id",e.immobilisation_id),p.append("buyer_id",e.buyer_id),p.append("amount",e.amount),p.append("comment",e.comment||""),this.selectedFiles.forEach((l,s)=>{p.append(`documents[${s}]`,l)}),this.reformeService.createReformeSale(p)}else console.log("Form is invalid:",this.reformeSaleForm.value),this.btnSubmit=!0}getFormControlErrorText(p){return p?.hasError("required")?this.languageService.instant("FieldRequired"):p?.hasError("min")?this.languageService.instant("AmountMustBePositive"):p?.hasError("minlength")?this.languageService.instant("FieldTooShort"):p?.hasError("maxlength")?this.languageService.instant("FieldTooLong"):""}static \u0275fac=function(e){return new(e||m)(y(O),y(Be,8),y(q),y(k),y(ze))};static \u0275cmp=F({type:m,selectors:[["app-create-reforme-sale"]],outputs:{reload:"reload"},standalone:!1,decls:68,vars:73,consts:[[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button","aria-describedby","modal-title",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit","formGroup"],[1,"form-group","mb-3"],["for","immobilisation_id",1,"form-label"],["bindLabel","name","bindValue","id","formControlName","immobilisation_id",3,"items","placeholder","searchable","clearable"],["ng-option-tmp",""],["class","invalid-feedback",4,"ngIf"],["for","buyer_id",1,"form-label"],["bindLabel","first_name","bindValue","id","formControlName","buyer_id",3,"items","placeholder","searchable","clearable"],["for","amount",1,"form-label"],[1,"input-group"],[1,"input-group-text"],["type","number","id","amount","formControlName","amount","min","0","step","0.01",1,"form-control",3,"placeholder"],["for","comment",1,"form-label"],["id","comment","formControlName","comment","rows","4",1,"form-control",3,"placeholder"],["for","documents",1,"form-label"],["type","file","id","documents","multiple","","accept",".pdf,.doc,.docx,.jpg,.jpeg,.png",1,"form-control",3,"change"],["type","button",1,"btn","btn-outline-secondary",3,"click","title"],[1,"fas","fa-trash"],[1,"form-text","text-muted"],["class","mb-3",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-success",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2","role","status",4,"ngIf"],[1,"invalid-feedback"],[1,"mb-3"],[1,"d-flex","flex-wrap","gap-2"],["class","badge bg-primary d-flex align-items-center gap-1",4,"ngFor","ngForOf"],[1,"badge","bg-primary","d-flex","align-items-center","gap-1"],[1,"fas","fa-file"],["type","button",1,"btn-close","btn-close-white",2,"font-size","0.6rem",3,"click"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"d-flex","align-items-center"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button","data-bs-dismiss","alert",1,"btn-close"],[1,"text-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["role","status",1,"spinner-border","spinner-border-sm","me-2"]],template:function(e,l){if(e&1&&(n(0,"div",0)(1,"h4",1),r(2),a(3,"translate"),t(),n(4,"button",2),v("click",function(){return l.dismiss()}),t()(),n(5,"div",3)(6,"form",4),v("ngSubmit",function(){return l.submitForm()}),n(7,"div",5)(8,"label",6),r(9),a(10,"translate"),t(),n(11,"ng-select",7),a(12,"async"),a(13,"translate"),C(14,Cn,1,2,"ng-template",8),t(),C(15,Sn,2,1,"div",9),t(),n(16,"div",5)(17,"label",10),r(18),a(19,"translate"),t(),n(20,"ng-select",11),a(21,"async"),a(22,"translate"),C(23,yn,1,3,"ng-template",8),t(),C(24,Bn,2,1,"div",9),t(),n(25,"div",5)(26,"label",12),r(27),a(28,"translate"),t(),n(29,"div",13)(30,"span",14),r(31,"XAF"),t(),c(32,"input",15),a(33,"translate"),t(),C(34,En,2,1,"div",9),t(),n(35,"div",5)(36,"label",16),r(37),a(38,"translate"),t(),n(39,"textarea",17),a(40,"translate"),r(41,"      "),t()(),n(42,"div",5)(43,"label",18),r(44),a(45,"translate"),t(),n(46,"div",13)(47,"input",19),v("change",function(u){return l.onFileSelected(u)}),t(),n(48,"button",20),a(49,"translate"),v("click",function(){return l.clearAllFiles()}),c(50,"i",21),t()(),n(51,"small",22),r(52),a(53,"translate"),t()(),C(54,wn,6,4,"div",23)(55,Fn,1,1),a(56,"async"),C(57,Dn,5,3,"div",24),a(58,"async"),t()(),n(59,"div",25)(60,"button",26),v("click",function(){return l.dismiss()}),r(61),a(62,"translate"),t(),n(63,"button",27),v("click",function(){return l.submitForm()}),C(64,Mn,4,3,"span",28),a(65,"async"),r(66),a(67,"translate"),t()()),e&2){let s,u,b,g,L,U,pe;i(2),f(" ",o(3,35,"CreateReformeSale")," "),i(4),S("formGroup",l.reformeSaleForm),i(3),f("",o(10,37,"Immobilisation")," *"),i(2),V("is-invalid",((s=l.reformeSaleForm.get("immobilisation_id"))==null?null:s.invalid)&&(((s=l.reformeSaleForm.get("immobilisation_id"))==null?null:s.dirty)||((s=l.reformeSaleForm.get("immobilisation_id"))==null?null:s.touched))),S("items",o(12,39,l.immobilisations$))("placeholder",o(13,41,"SelectImmobilisation"))("searchable",!0)("clearable",!0),i(4),S("ngIf",((u=l.reformeSaleForm.get("immobilisation_id"))==null?null:u.invalid)&&(((u=l.reformeSaleForm.get("immobilisation_id"))==null?null:u.dirty)||((u=l.reformeSaleForm.get("immobilisation_id"))==null?null:u.touched))),i(3),f("",o(19,43,"Buyer")," *"),i(2),V("is-invalid",((b=l.reformeSaleForm.get("buyer_id"))==null?null:b.invalid)&&(((b=l.reformeSaleForm.get("buyer_id"))==null?null:b.dirty)||((b=l.reformeSaleForm.get("buyer_id"))==null?null:b.touched))),S("items",o(21,45,l.buyers$))("placeholder",o(22,47,"SelectBuyer"))("searchable",!0)("clearable",!0),i(4),S("ngIf",((g=l.reformeSaleForm.get("buyer_id"))==null?null:g.invalid)&&(((g=l.reformeSaleForm.get("buyer_id"))==null?null:g.dirty)||((g=l.reformeSaleForm.get("buyer_id"))==null?null:g.touched))),i(3),f("",o(28,49,"SaleAmount")," *"),i(5),V("is-invalid",((L=l.reformeSaleForm.get("amount"))==null?null:L.invalid)&&(((L=l.reformeSaleForm.get("amount"))==null?null:L.dirty)||((L=l.reformeSaleForm.get("amount"))==null?null:L.touched))),w("placeholder",o(33,51,"EnterSaleAmount")),i(2),S("ngIf",((U=l.reformeSaleForm.get("amount"))==null?null:U.invalid)&&(((U=l.reformeSaleForm.get("amount"))==null?null:U.dirty)||((U=l.reformeSaleForm.get("amount"))==null?null:U.touched))),i(3),d(o(38,53,"Comment")),i(2),w("placeholder",o(40,55,"EnterComment")),i(5),d(o(45,57,"Documents")),i(4),w("title",o(49,59,"ClearAllFiles")),i(4),f("",o(53,61,"SupportedFormats"),": PDF, DOC, DOCX, JPG, JPEG, PNG"),i(2),S("ngIf",l.selectedFiles.length>0),i(),B((pe=o(56,63,l.error$))?55:-1,pe),i(2),S("ngIf",o(58,65,l.loading$)),i(4),f(" ",o(62,67,"Cancel")," "),i(2),S("disabled",!l.reformeSaleForm.valid||l.btnSubmit),i(),S("ngIf",o(65,69,l.loading$)),i(2),f(" ",o(67,71,"Create")," ")}},dependencies:[Ne,Q,xe,N,Mt,j,he,Tt,Se,ye,Ge,Ue,R,M],encapsulation:2})};var On=()=>[5,10,20,50],Pn=(m,p)=>p.id;function Rn(m,p){if(m&1){let e=I();n(0,"div",6)(1,"button",55),v("click",function(){h(e);let s=_();return x(s.closeScan())}),r(2),a(3,"translate"),t()()}m&2&&(i(2),f(" ",o(3,1,"close scan barcode")," "))}function Tn(m,p){if(m&1){let e=I();n(0,"div",6)(1,"button",55),v("click",function(){h(e);let s=_();return x(s.scanCodeBarre())}),c(2,"i",56),r(3),a(4,"translate"),t()()}m&2&&(i(3),f(" ",o(4,1,"scan a barcode")," "))}function Ln(m,p){m&1&&(n(0,"span"),r(1,"..."),t())}function Vn(m,p){if(m&1&&(n(0,"p",65),r(1),a(2,"slice"),C(3,Ln,2,0,"span"),t()),m&2){let e=_().$implicit;i(),f(" ",ne(2,2,e.comment,0,30)," "),i(2),B(e.comment.length>30?3:-1)}}function An(m,p){if(m&1){let e=I();n(0,"tr",57)(1,"td",58),c(2,"input",48),t(),n(3,"td")(4,"div",59)(5,"div",60)(6,"div",61),c(7,"i",62),t()(),n(8,"div",63)(9,"h6",64),r(10),t(),n(11,"p",65),c(12,"i",66),r(13),a(14,"translate"),t(),n(15,"p",65),c(16,"i",67),r(17),a(18,"translate"),t(),n(19,"p",65),c(20,"i",68),r(21),a(22,"translate"),a(23,"currency"),t()()()(),n(24,"td",58)(25,"div",63)(26,"h6",64),r(27),t(),n(28,"p",65),c(29,"i",69),r(30),a(31,"translate"),t()()(),n(32,"td",58)(33,"div",63)(34,"h6",70),r(35),a(36,"currency"),t(),C(37,Vn,4,6,"p",65),t()(),n(38,"td",71)(39,"span",72),r(40),a(41,"translate"),t()(),n(42,"td",71)(43,"div",73)(44,"div",74)(45,"div",75),r(46),t()(),n(47,"div",76)(48,"h6",77),r(49),t(),n(50,"p",65),r(51),a(52,"date"),t()()()(),n(53,"td",71)(54,"div",36)(55,"button",78),c(56,"i",79),t(),n(57,"ul",39)(58,"li")(59,"a",80),v("click",function(){let s=h(e).$implicit,u=_(2);return x(u.viewDetail(s))}),c(60,"i",81),r(61),a(62,"translate"),t()(),n(63,"li")(64,"a",80),v("click",function(){let s=h(e).$implicit,u=_(2);return x(u.viewImmobilisationDetails(s.immobilisation_id))}),c(65,"i",82),r(66),a(67,"translate"),t()()()()()()}if(m&2){let e=p.$implicit;i(10),d(e.immobilisation.name),i(3),E("",o(14,20,"Code"),": ",e.immobilisation.code," "),i(4),E("",o(18,22,"Category"),": ",e.immobilisation.categorie.name," "),i(4),E("",o(22,24,"OriginalValue"),": ",K(23,26,e.immobilisation.unit_price,"XAF","symbol","1.0-0")," "),i(6),d(e.buyer_id),i(3),f("",o(31,31,"Buyer")," "),i(5),d(K(36,33,e.amount,"XAF","symbol","1.0-0")),i(2),B(e.comment?37:-1),i(2),S("ngClass",e.documents&&e.documents.length>0?"bg-gradient-success":"bg-gradient-secondary"),i(),E(" ",e.documents.length||0," ",o(41,38,"files")," "),i(6),f(" ",e.user.first_name.charAt(0)||"U"," "),i(3),E("",e.user.first_name," ",e.user.last_name,""),i(2),d(be(52,40,e.created_at,"shortDate")),i(10),f("",o(62,43,"View")," "),i(5),f("",o(67,45,"ViewImmobilisationDetails")," ")}}function $n(m,p){if(m&1&&H(0,An,68,47,"tr",57,Pn),m&2){let e=_();W(e.sales)}}function Nn(m,p){if(m&1){let e=I();n(0,"tr")(1,"td",83)(2,"div",84),c(3,"i",85),n(4,"h6",86),r(5),a(6,"translate"),t(),n(7,"p",87),r(8),a(9,"translate"),t(),n(10,"button",88),v("click",function(){h(e);let s=_();return x(s.openCreateModal())}),c(11,"i",13),r(12),a(13,"translate"),t()()()()}m&2&&(i(5),d(o(6,3,"NoDataFound")),i(3),d(o(9,5,"NoSaleAssetsAvailable")),i(4),f("",o(13,7,"AddFirst")," "))}function jn(m,p){if(m&1){let e=I();n(0,"div",89)(1,"div",90)(2,"div",7)(3,"span",87),r(4),a(5,"translate"),a(6,"translate"),a(7,"translate"),a(8,"translate"),t()()(),n(9,"div",90)(10,"mat-paginator",91),v("page",function(s){h(e);let u=_();return x(u.onPageChange(s))}),t()()()}if(m&2){let e=_();i(4),ve(" ",o(5,11,"Showing")," ",e.paginationDetail.current_page||0," ",o(6,13,"to")," ",e.paginationDetail.per_page||0," ",o(7,15,"of")," ",e.sales.length||0," ",o(8,17,"entries")," "),i(6),S("length",e.sales.length||0)("pageSize",e.paginationDetail.per_page||10)("pageSizeOptions",rt(19,On))("showFirstLastButtons",!0)}}function zn(m,p){m&1&&(n(0,"div",54)(1,"div",92)(2,"span",93),r(3),a(4,"translate"),t()()()),m&2&&(i(3),f("",o(4,1,"Loading"),"..."))}var gt=class m extends z{constructor(e,l,s){super();this.reformeService=e;this.modalService=l;this.router=s}searchCtrl=new ot("");dateFromCtrl=new ot("");dateToCtrl=new ot("");sales=[];searchOptions=[];displayedColumns=["id","immobilisation","buyer","amount","created_at","actions"];paginationDetail={current_page:1,per_page:10};loading=!1;barcodeScanner;isActiveScan=!1;ngOnInit(){this.initializeData(),this.setupSearchControls()}initializeData(){this.reformeService.sales$.subscribe(e=>{this.sales=e,this.isActiveScan&&this.sales.length==1&&(this.isActiveScan=!1,this.barcodeScanner.stop(),this.reformeService.setSnackMesage("Vente trouv\xE9e : "+this.sales[0].id))}),this.reformeService.paginateData$.subscribe(e=>{this.paginationDetail=e}),this.reformeService.loading$.subscribe(e=>{this.loading=e}),this.getReformeSaleFromServer()}setupSearchControls(){this.searchCtrl.valueChanges.pipe(ce(300),fe()).subscribe(e=>{this.onSearch(e)}),this.dateFromCtrl.valueChanges.subscribe(()=>{this.onDateFilter()}),this.dateToCtrl.valueChanges.subscribe(()=>{this.onDateFilter()})}onSearch(e){this.searchOptions=[],e&&e.trim()&&this.searchOptions.push(Ie(e.trim())),this.getReformeSaleFromServer()}onDateFilter(){let e=this.dateFromCtrl.value,l=this.dateToCtrl.value;this.searchOptions=this.searchOptions.filter(s=>s.name!=="date_from"&&s.name!=="date_to"),e&&this.searchOptions.push(P("date_from",e)),l&&this.searchOptions.push(P("date_to",l)),this.getReformeSaleFromServer()}onSortChange(e){this.searchOptions=this.searchOptions.filter(l=>l.name!=="sort_by"&&l.name!=="sort_direction"),e.active&&e.direction&&this.searchOptions.push(P("sort_by",e.active),P("sort_direction",e.direction)),this.getReformeSaleFromServer()}onPageChange(e){this.paginationDetail.current_page=e.pageIndex+1,this.paginationDetail.per_page=e.pageSize,this.getReformeSaleFromServer()}getReformeSaleFromServer(){let e={current_page:this.paginationDetail.current_page,per_page:this.paginationDetail.per_page};this.reformeService.getReformeSaleFromServer(e,this.searchOptions)}openCreateModal(){this.modalService.open(He,{size:"lg",backdrop:"static",keyboard:!1}).result.then(l=>{l==="created"&&this.getReformeSaleFromServer()}).catch(()=>{})}viewDetail(e){this.router.navigate(["/admin/reformes/sales/detail",e.id])}viewImmobilisationDetails(e){this.router.navigate(["/admin/immobilisations",e])}clearFilters(){this.searchCtrl.setValue(""),this.dateFromCtrl.setValue(""),this.dateToCtrl.setValue(""),this.searchOptions=[],this.getReformeSaleFromServer()}onValueChanges(e){console.log("valueChanges :",e.codeResult.code),e.codeResult.code.length>8&&(console.log("valueChanges 2 : ",e.codeResult.code),this.searchCtrl.setValue(e.codeResult.code),this.getReformeSaleFromServer())}scanCodeBarre(){this.barcodeScanner&&typeof this.barcodeScanner.start=="function"&&(this.barcodeScanner.start(),this.isActiveScan=!0)}closeScan(){this.barcodeScanner.stop(),this.isActiveScan=!1}onStarted(e){console.log("started :",e)}static \u0275fac=function(l){return new(l||m)(y(k),y(Ee),y(G))};static \u0275cmp=F({type:m,selectors:[["app-list-reforme-sale"]],viewQuery:function(l,s){if(l&1&&Ve(oe,5),l&2){let u;Ae(u=$e())&&(s.barcodeScanner=u.first)}},standalone:!1,features:[ge],decls:123,vars:78,consts:[["barcodeScanner",""],[3,"nameOption"],[1,"row","col-6"],["type","code_128",3,"valueChanges","started"],["class","col-lg-8 col-md-6 col-12",4,"ngIf"],[1,"row","mb-4"],[1,"col-lg-8","col-md-6","col-12"],[1,"d-flex","align-items-center"],[1,"mb-0","text-dark"],[1,"badge","bg-gradient-success","ms-2"],[1,"text-sm","text-secondary","mb-0"],[1,"col-lg-4","col-md-6","col-12","text-end"],[1,"btn","btn-success","btn-sm","mb-0",3,"click"],[1,"fas","fa-plus","me-2"],[1,"col-12"],[1,"card"],[1,"card-body","p-3"],[1,"row","align-items-center"],[1,"col-lg-4","col-md-6","col-12"],[1,"form-group","mb-0"],[1,"form-label","text-xs"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text",1,"form-control",3,"placeholder","formControl"],[1,"col-lg-2","col-md-6","col-12"],["type","date",1,"form-control",3,"formControl"],[1,"col-lg-1","col-md-6","col-12"],[1,"form-label","text-xs","opacity-0"],[1,"btn","btn-outline-secondary","btn-sm","w-100",3,"click","title"],[1,"fas","fa-undo"],[1,"row"],[1,"card-header","pb-0"],[1,"col-lg-6","col-7"],[1,"mb-0"],[1,"col-lg-6","col-5","text-end"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-sm","btn-outline-primary","dropdown-toggle"],[1,"fas","fa-download","me-1"],[1,"dropdown-menu"],[1,"dropdown-item"],[1,"fas","fa-file-excel","me-2"],[1,"fas","fa-file-pdf","me-2"],[1,"fas","fa-file-csv","me-2"],[1,"card-body","px-0","pt-0","pb-2"],[1,"table-responsive","p-0"],[1,"table","align-items-center","mb-0"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","ps-2"],["type","checkbox",1,"form-check-input"],[1,"text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","cursor-pointer",3,"click"],[1,"fas","fa-sort","ms-1"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7"],[1,"text-center","text-uppercase","text-secondary","text-xxs","font-weight-bolder","opacity-7","cursor-pointer",3,"click"],["class","row mt-3",4,"ngIf"],[1,"position-fixed","top-0","start-0","w-100","h-100","d-flex","align-items-center","justify-content-center",2,"background-color","rgba(0,0,0,0.5)","z-index","9999"],[1,"btn","btn-outline-info","btn-sm","mb-1","me-2",3,"click"],[1,"fas","fa-barcode","me-2"],[1,"hover-row"],[1,"ps-2"],[1,"d-flex","px-2","py-1"],[1,"avatar","avatar-sm","me-3"],[1,"avatar-initial","rounded-circle","bg-gradient-success"],[1,"fas","fa-dollar-sign"],[1,"d-flex","flex-column","justify-content-center"],[1,"mb-0","text-sm"],[1,"text-xs","text-secondary","mb-0"],[1,"fas","fa-barcode","me-1"],[1,"fas","fa-tag","me-1"],[1,"fas","fa-dollar-sign","me-1"],[1,"fas","fa-user","me-1"],[1,"mb-0","text-sm","text-success"],[1,"text-center"],[1,"badge","badge-sm",3,"ngClass"],[1,"d-flex","align-items-center","justify-content-center"],[1,"avatar","avatar-xs","me-2"],[1,"avatar-initial","rounded-circle","bg-gradient-info"],[1,"d-flex","flex-column"],[1,"mb-0","text-xs"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-link","text-secondary","p-0","dropdown-toggle"],[1,"fas","fa-ellipsis-v"],[1,"dropdown-item",3,"click"],[1,"fas","fa-eye","me-2"],[1,"fas","fa-info-circle","me-2"],["colspan","7",1,"text-center","py-4"],[1,"d-flex","flex-column","align-items-center"],[1,"fas","fa-dollar-sign","text-muted","mb-3",2,"font-size","3rem"],[1,"text-muted","mb-2"],[1,"text-sm","text-secondary"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"row","mt-3"],[1,"col-sm-6"],["aria-label","Select page",3,"page","length","pageSize","pageSizeOptions","showFirstLastButtons"],["role","status",1,"spinner-border","text-success"],[1,"visually-hidden"]],template:function(l,s){if(l&1){let u=I();n(0,"app-base",1),a(1,"translate"),n(2,"div",2)(3,"barcode-scanner-livestream",3,0),v("valueChanges",function(g){return h(u),x(s.onValueChanges(g))})("started",function(){return h(u),x(s.onStarted(!0))}),t(),C(5,Rn,4,3,"div",4),t(),C(6,Tn,5,3,"div",4),n(7,"div",5)(8,"div",6)(9,"div",7)(10,"h4",8),r(11),a(12,"translate"),t(),n(13,"span",9),r(14),a(15,"translate"),t()(),n(16,"p",10),r(17),a(18,"translate"),t()(),n(19,"div",11)(20,"button",12),v("click",function(){return h(u),x(s.openCreateModal())}),c(21,"i",13),r(22),a(23,"translate"),a(24,"translate"),t()()(),n(25,"div",5)(26,"div",14)(27,"div",15)(28,"div",16)(29,"div",17)(30,"div",18)(31,"div",19)(32,"label",20),r(33),a(34,"translate"),t(),n(35,"div",21)(36,"span",22),c(37,"i",23),t(),c(38,"input",24),a(39,"translate"),t()()(),n(40,"div",25)(41,"div",19)(42,"label",20),r(43),a(44,"translate"),t(),c(45,"input",26),t()(),n(46,"div",25)(47,"div",19)(48,"label",20),r(49),a(50,"translate"),t(),c(51,"input",26),t()(),n(52,"div",27)(53,"div",19)(54,"label",28),r(55),a(56,"translate"),t(),n(57,"button",29),a(58,"translate"),v("click",function(){return h(u),x(s.clearFilters())}),c(59,"i",30),t()()()()()()()(),n(60,"div",31)(61,"div",14)(62,"div",15)(63,"div",32)(64,"div",17)(65,"div",33)(66,"h6",34),r(67),a(68,"translate"),t()(),n(69,"div",35)(70,"div",36)(71,"button",37),c(72,"i",38),r(73),a(74,"translate"),t(),n(75,"ul",39)(76,"li")(77,"a",40),c(78,"i",41),r(79),a(80,"translate"),t()(),n(81,"li")(82,"a",40),c(83,"i",42),r(84),a(85,"translate"),t()(),n(86,"li")(87,"a",40),c(88,"i",43),r(89),a(90,"translate"),t()()()()()()(),n(91,"div",44)(92,"div",45)(93,"table",46)(94,"thead")(95,"tr")(96,"th",47),c(97,"input",48),t(),n(98,"th",49),v("click",function(){return h(u),x(s.onSortChange({active:"immobilisation",direction:"asc"}))}),r(99),a(100,"translate"),c(101,"i",50),t(),n(102,"th",47),r(103),a(104,"translate"),t(),n(105,"th",47),r(106),a(107,"translate"),t(),n(108,"th",51),r(109),a(110,"translate"),t(),n(111,"th",52),v("click",function(){return h(u),x(s.onSortChange({active:"created_at",direction:"desc"}))}),r(112),a(113,"translate"),c(114,"i",50),t(),n(115,"th",51),r(116),a(117,"translate"),t()()(),n(118,"tbody"),C(119,$n,2,0)(120,Nn,14,9,"tr"),t()()(),C(121,jn,11,20,"div",53),t()()()(),C(122,zn,5,3,"div",54),t()}l&2&&(w("nameOption",o(1,32,"SaleAssets")),i(5),S("ngIf",s.isActiveScan),i(),S("ngIf",!s.isActiveScan),i(5),d(o(12,34,"SaleAssets")),i(3),E("",s.sales.length||0," ",o(15,36,"items"),""),i(3),d(o(18,38,"ManageSaleAssetsForReform")),i(5),E(" ",o(23,40,"AddU")," ",o(24,42,"Immobilisation")," "),i(11),d(o(34,44,"Search")),i(5),w("placeholder",o(39,46,"SearchByAssetOrBuyer")),S("formControl",s.searchCtrl),i(5),d(o(44,48,"DateFrom")),i(2),S("formControl",s.dateFromCtrl),i(4),d(o(50,50,"DateTo")),i(2),S("formControl",s.dateToCtrl),i(4),d(o(56,52,"Actions")),i(2),w("title",o(58,54,"ResetFilters")),i(10),d(o(68,56,"SaleAssetsList")),i(6),f("",o(74,58,"Export")," "),i(6),d(o(80,60,"Excel")),i(5),d(o(85,62,"PDF")),i(5),d(o(90,64,"CSV")),i(10),f(" ",o(100,66,"Asset")," "),i(4),f(" ",o(104,68,"Buyer")," "),i(3),f(" ",o(107,70,"Amount")," "),i(3),f(" ",o(110,72,"Documents")," "),i(3),f(" ",o(113,74,"CreatedAt")," "),i(4),f(" ",o(117,76,"Actions")," "),i(3),B(s.sales&&s.sales.length>0?119:120),i(2),S("ngIf",s.sales&&s.sales.length>0),i(),B(s.loading?122:-1))},dependencies:[Y,Q,N,j,Ce,z,we,oe,ae,re,_e,M],encapsulation:2})};function Un(m,p){if(m&1&&(n(0,"div",3),c(1,"i",4),r(2),c(3,"button",5),t()),m&2){let e=_();i(2),f(" ",e.message," ")}}function Gn(m,p){m&1&&C(0,Un,4,1,"div",3),m&2&&B(p.status?0:-1)}function qn(m,p){m&1&&(n(0,"div",2)(1,"div",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"span",10),r(6),a(7,"translate"),t()(),n(8,"p",11),r(9),a(10,"translate"),t()()()()()),m&2&&(i(6),f("",o(7,2,"Loading"),"..."),i(3),f("",o(10,4,"LoadingSaleAssetDetails"),"..."))}function Hn(m,p){if(m&1&&(n(0,"div",57)(1,"label",35),r(2),a(3,"translate"),t(),n(4,"div",58)(5,"p",21),r(6),t()()()),m&2){let e=_(2);i(2),d(o(3,2,"Comment")),i(4),d(e.reformeSale.comment)}}function Wn(m,p){if(m&1){let e=I();n(0,"div",59)(1,"div",60),c(2,"i",61),n(3,"span",50),r(4),a(5,"slice"),t()(),n(6,"button",62),v("click",function(){let s=h(e).$implicit,u=_(3);return x(u.downloadDocument(s))}),c(7,"i",63),t()()}if(m&2){let e=p.$implicit,l=_(3);i(2),D(l.getFileIcon(e)),i(2),d(ne(5,3,e.split("/").pop(),0,10))}}function Qn(m,p){if(m&1&&(n(0,"div",52),H(1,Wn,8,7,"div",59,Le),t()),m&2){let e=_(2);i(),W(e.reformeSale.documents)}}function Xn(m,p){m&1&&(n(0,"p",53),r(1),a(2,"translate"),t()),m&2&&(i(),d(o(2,1,"NoDocumentsAttached")))}function Yn(m,p){if(m&1){let e=I();n(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17)(6,"div",18)(7,"div",19),c(8,"i",20),t(),n(9,"div")(10,"h3",21),r(11),a(12,"translate"),t(),n(13,"p",22),c(14,"i",23),r(15),t()()()(),n(16,"div",24)(17,"button",25),v("click",function(){h(e);let s=_();return x(s.goBack())}),c(18,"i",26),r(19),a(20,"translate"),t(),n(21,"button",27),v("click",function(){h(e);let s=_();return x(s.viewImmobilisationDetails())}),c(22,"i",28),r(23),a(24,"translate"),t()()()()()()(),n(25,"div",29)(26,"div",30)(27,"div",31)(28,"div",32)(29,"h6",21),r(30),a(31,"translate"),t()(),n(32,"div",33)(33,"div",29)(34,"div",34)(35,"label",35),r(36),a(37,"translate"),t(),n(38,"p",36),r(39),t()(),n(40,"div",34)(41,"label",35),r(42),a(43,"translate"),t(),n(44,"p",36),r(45),t()(),n(46,"div",34)(47,"label",35),r(48),a(49,"translate"),t(),n(50,"p",36),r(51),t()(),n(52,"div",34)(53,"label",35),r(54),a(55,"translate"),t(),n(56,"p",36),r(57),a(58,"translate"),t()(),n(59,"div",34)(60,"label",35),r(61),a(62,"translate"),t(),n(63,"p",36),r(64),a(65,"translate"),t()(),n(66,"div",34)(67,"label",35),r(68),a(69,"translate"),t(),n(70,"p",36),r(71),t()(),n(72,"div",34)(73,"label",35),r(74),a(75,"translate"),t(),n(76,"p",36),r(77),a(78,"currency"),t()(),n(79,"div",34)(80,"label",35),r(81),a(82,"translate"),t(),n(83,"p",36)(84,"span",37),r(85),t()()(),n(86,"div",34)(87,"label",35),r(88),a(89,"translate"),t(),n(90,"p",36),r(91),t()(),n(92,"div",34)(93,"label",35),r(94),a(95,"translate"),t(),n(96,"p",36),r(97),a(98,"translate"),t()(),n(99,"div",34)(100,"label",35),r(101),a(102,"translate"),t(),n(103,"p",36),r(104),a(105,"translate"),t()(),n(106,"div",34)(107,"label",35),r(108),a(109,"translate"),t(),n(110,"p",36),r(111),t()(),n(112,"div",34)(113,"label",35),r(114),a(115,"translate"),t(),n(116,"p",36),r(117),t()()()()(),n(118,"div",38)(119,"div",32)(120,"h6",21),r(121),a(122,"translate"),t()(),n(123,"div",33)(124,"div",29)(125,"div",34)(126,"label",35),r(127),a(128,"translate"),t(),n(129,"p",36),c(130,"i",39),r(131),t()(),n(132,"div",34)(133,"label",35),r(134),a(135,"translate"),t(),n(136,"p",36)(137,"span",40),c(138,"i",41),r(139),t()()(),C(140,Hn,7,4,"div",42),n(141,"div",34)(142,"label",35),r(143),a(144,"translate"),t(),n(145,"p",36),r(146),t()(),n(147,"div",34)(148,"label",35),r(149),a(150,"translate"),t(),n(151,"p",36),r(152),t()(),n(153,"div",34)(154,"label",35),r(155),a(156,"translate"),t(),n(157,"p",36),r(158),t()()()()()(),n(159,"div",43)(160,"div",31)(161,"div",32)(162,"h6",21),r(163),a(164,"translate"),t()(),n(165,"div",33)(166,"div",44)(167,"div",45),c(168,"i",46),t(),n(169,"h4",47),r(170),t(),n(171,"p",48),r(172),a(173,"translate"),t(),c(174,"hr"),n(175,"div",49)(176,"span",50),r(177),a(178,"translate"),t(),n(179,"span",51),r(180),t()(),n(181,"div",49)(182,"span",50),r(183),a(184,"translate"),t(),n(185,"span",51),r(186),t()()()()(),n(187,"div",31)(188,"div",32)(189,"h6",21),r(190),a(191,"translate"),t()(),n(192,"div",33),C(193,Qn,3,0,"div",52)(194,Xn,3,3,"p",53),t()(),n(195,"div",38)(196,"div",32)(197,"h6",21),r(198),a(199,"translate"),t()(),n(200,"div",33)(201,"div",54)(202,"button",55),v("click",function(){h(e);let s=_();return x(s.viewImmobilisationDetails())}),c(203,"i",28),r(204),a(205,"translate"),t(),n(206,"button",56),v("click",function(){h(e);let s=_();return x(s.goBack())}),c(207,"i",26),r(208),a(209,"translate"),t()()()()()()}if(m&2){let e=_();i(11),d(o(12,57,"SaleAssetDetails")),i(4),f("",e.formatDate(e.reformeSale.created_at)," "),i(4),f("",o(20,59,"Back")," "),i(4),f("",o(24,61,"ViewImmobilisationDetails")," "),i(7),d(o(31,63,"ImmobilisationInformation")),i(6),d(o(37,65,"Name")),i(3),d(e.reformeSale.immobilisation.name),i(3),d(o(43,67,"Code")),i(3),d(e.reformeSale.immobilisation.code),i(3),d(o(49,69,"Category")),i(3),d(e.reformeSale.immobilisation.categorie.name),i(3),d(o(55,71,"Brand")),i(3),d(e.reformeSale.immobilisation.mark||o(58,73,"NotAvailable")),i(4),d(o(62,75,"Model")),i(3),d(e.reformeSale.immobilisation.model||o(65,77,"NotAvailable")),i(4),d(o(69,79,"Quantity")),i(3),d(e.reformeSale.immobilisation.quantity),i(3),d(o(75,81,"OriginalUnitPrice")),i(3),d(K(78,83,e.reformeSale.immobilisation.unit_price,"XAF","symbol","1.0-0")),i(4),d(o(82,88,"Status")),i(3),S("ngClass",e.getStatusBadgeClass(e.reformeSale.immobilisation.status||"sold")),i(),f(" ",e.reformeSale.immobilisation.status," "),i(3),d(o(89,90,"PurchaseDate")),i(3),d(e.formatDate(e.reformeSale.immobilisation.date_of_receipt||"")),i(3),d(o(95,92,"OrderNumber")),i(3),d(e.reformeSale.immobilisation.num_bon_commande||o(98,94,"NotAvailable")),i(4),d(o(102,96,"ProcessNumber")),i(3),d(e.reformeSale.immobilisation.num_proces_verbal||o(105,98,"NotAvailable")),i(4),d(o(109,100,"Supplier")),i(3),d(e.reformeSale.immobilisation.fournisseur.raison_social),i(3),d(o(115,102,"Structure")),i(3),d(e.reformeSale.immobilisation.structure.name),i(4),d(o(122,104,"SaleInformation")),i(6),d(o(128,106,"Buyer")),i(4),f("",e.reformeSale.buyer_id," "),i(3),d(o(135,108,"SaleAmount")),i(5),f("",e.formatCurrency(e.reformeSale.amount)," "),i(),S("ngIf",e.reformeSale.comment),i(3),d(o(144,110,"SaleDate")),i(3),d(e.formatDate(e.reformeSale.created_at)),i(3),d(o(150,112,"UpdatedAt")),i(3),d(e.formatDate(e.reformeSale.updated_at)),i(3),d(o(156,114,"ProcessedBy")),i(3),E("",e.reformeSale.user.first_name," ",e.reformeSale.user.last_name,""),i(5),d(o(164,116,"SaleSummary")),i(7),d(e.formatCurrency(e.reformeSale.amount)),i(2),d(o(173,118,"TotalSaleAmount")),i(5),f("",o(178,120,"Buyer"),":"),i(3),d(e.reformeSale.buyer_id),i(3),f("",o(184,122,"SaleDate"),":"),i(3),d(e.formatDate(e.reformeSale.created_at)),i(4),d(o(191,124,"Documents")),i(3),B(e.reformeSale.documents&&e.reformeSale.documents.length>0?193:194),i(5),d(o(199,126,"Actions")),i(6),f("",o(205,128,"ViewImmobilisationDetails")," "),i(4),f("",o(209,130,"BackToList")," ")}}function Jn(m,p){if(m&1){let e=I();n(0,"div",2)(1,"div",64)(2,"div",7)(3,"div",8),c(4,"i",65),n(5,"h5",66),r(6),a(7,"translate"),t(),n(8,"p",67),r(9),a(10,"translate"),t(),n(11,"button",68),v("click",function(){h(e);let s=_();return x(s.goBack())}),c(12,"i",26),r(13),a(14,"translate"),t()()()()()}m&2&&(i(6),d(o(7,3,"SaleAssetNotFound")),i(3),d(o(10,5,"SaleAssetNotFoundDescription")),i(4),f("",o(14,7,"BackToList")," "))}var vt=class m{constructor(p,e,l,s){this.route=p;this.router=e;this.reformeService=l;this.languageService=s;this.loading$=this.reformeService.loading$,this.error$=this.reformeService.error$}destroy$=new Re;reformeSale;loading$;error$;reformeSaleId=null;ngOnInit(){this.reformeSaleId=this.route.snapshot.paramMap.get("id"),this.reformeSaleId&&this.loadReformeSaleDetail()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadReformeSaleDetail(){this.reformeSaleId&&this.reformeService.getReformeSaleDetailFromServer(this.reformeSaleId).pipe(tt(p=>{console.log("Reforme Sale Detail:",p),this.reformeSale=p})).subscribe()}goBack(){window.history.back()}viewImmobilisationDetails(){this.reformeSale&&this.router.navigate(["/admin/immobilisations/detail",this.reformeSale.immobilisation_id])}getStatusBadgeClass(p){switch(p.toLowerCase()){case"active":return"bg-gradient-success";case"inactive":return"bg-gradient-secondary";case"maintenance":return"bg-gradient-warning";case"sold":return"bg-gradient-success";default:return"bg-gradient-secondary"}}formatDate(p){return new Date(p).toLocaleDateString("fr-FR")}formatCurrency(p){let e=typeof p=="string"?parseFloat(p):p;return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(e)}downloadDocument(p){window.open(p,"_blank")}getFileIcon(p){switch(p.split(".").pop()?.toLowerCase()){case"pdf":return"fas fa-file-pdf";case"doc":case"docx":return"fas fa-file-word";case"jpg":case"jpeg":case"png":return"fas fa-file-image";default:return"fas fa-file"}}static \u0275fac=function(e){return new(e||m)(y(J),y(G),y(k),y(O))};static \u0275cmp=F({type:m,selectors:[["app-detail-reforme-sale"]],standalone:!1,decls:10,vars:12,consts:[[1,"main-content","position-relative","max-height-vh-100","h-100","detail-reforme-sale"],[1,"container-fluid","py-4"],[1,"row","justify-content-center"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button","data-bs-dismiss","alert",1,"btn-close"],[1,"col-12","text-center"],[1,"card","shadow-lg"],[1,"card-body","py-5"],["role","status",1,"spinner-border","text-success"],[1,"visually-hidden"],[1,"text-secondary","mt-3"],[1,"row","mb-4"],[1,"col-12"],[1,"card","bg-gradient-success","shadow-lg","border-0"],[1,"card-body","p-4"],[1,"row","align-items-center"],[1,"col-md-8"],[1,"d-flex","align-items-center","text-white"],[1,"icon","icon-shape","icon-lg","bg-white","shadow","text-center","me-3"],[1,"fas","fa-dollar-sign","text-success"],[1,"mb-0"],[1,"text-sm","opacity-8","mb-0"],[1,"fas","fa-calendar","me-2"],[1,"col-md-4","text-end"],[1,"btn","btn-white","btn-sm","me-2",3,"click"],[1,"fas","fa-arrow-left","me-2"],[1,"btn","btn-light","btn-sm",3,"click"],[1,"fas","fa-info-circle","me-2"],[1,"row"],[1,"col-lg-8"],[1,"card","shadow-sm","mb-4"],[1,"card-header","pb-0"],[1,"card-body"],[1,"col-md-6","mb-3"],[1,"form-label","text-sm","text-secondary"],[1,"form-control-plaintext"],[1,"badge",3,"ngClass"],[1,"card","shadow-sm"],[1,"fas","fa-user","me-2"],[1,"badge","bg-gradient-success","px-3","py-2","fs-6"],[1,"fas","fa-dollar-sign","me-1"],["class","col-12 mb-3",4,"ngIf"],[1,"col-lg-4"],[1,"text-center"],[1,"icon","icon-shape","icon-lg","bg-gradient-success","shadow","mx-auto","mb-3"],[1,"fas","fa-dollar-sign","text-white"],[1,"text-success"],[1,"text-secondary","mb-0"],[1,"d-flex","justify-content-between"],[1,"text-sm"],[1,"text-sm","text-dark"],[1,"list-group","list-group-flush"],[1,"text-muted","text-center","py-3"],[1,"d-grid","gap-2"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"btn","btn-outline-secondary","btn-sm",3,"click"],[1,"col-12","mb-3"],[1,"p-3","bg-light","rounded"],[1,"list-group-item","d-flex","justify-content-between","align-items-center","px-0"],[1,"d-flex","align-items-center"],[1,"text-primary","me-2"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"fas","fa-download"],[1,"col-md-6","text-center"],[1,"fas","fa-dollar-sign","text-warning","fa-3x","mb-3"],[1,"text-secondary"],[1,"text-muted"],[1,"btn","btn-primary",3,"click"]],template:function(e,l){if(e&1&&(n(0,"div",0)(1,"div",1),C(2,Gn,1,1),a(3,"async"),C(4,qn,11,6,"div",2),a(5,"async"),C(6,Yn,210,132),a(7,"async"),C(8,Jn,15,9,"div",2),a(9,"async"),t()()),e&2){let s;i(2),B((s=o(3,4,l.error$))?2:-1,s),i(2),B(o(5,6,l.loading$)?4:-1),i(2),B(!o(7,8,l.loading$)&&l.reformeSale?6:-1),i(2),B(!o(9,10,l.loading$)&&!l.reformeSale?8:-1)}},dependencies:[Y,Q,R,ae,re,M],styles:[".detail-reforme-sale[_ngcontent-%COMP%]{min-height:100vh;background-color:#f8f9fa}.card[_ngcontent-%COMP%]{border:none;border-radius:15px;box-shadow:0 4px 6px #00000012;transition:all .3s ease}.card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 25px #00000026}.card-header[_ngcontent-%COMP%]{background-color:transparent;border-bottom:1px solid rgba(0,0,0,.125);padding:1.5rem}.card-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#344767;font-weight:600;margin-bottom:0}.form-label[_ngcontent-%COMP%]{font-weight:600;color:#67748e;margin-bottom:.5rem;font-size:.875rem}.form-control-plaintext[_ngcontent-%COMP%]{padding:.5rem 0;margin-bottom:0;font-size:.875rem;color:#344767;font-weight:500}.bg-light[_ngcontent-%COMP%]{background-color:#f8f9fa!important;border-radius:8px}.bg-gradient-success[_ngcontent-%COMP%]{background:linear-gradient(87deg,#2dce89 0,#2dcecc)}.text-success[_ngcontent-%COMP%]{color:#2dce89!important}.icon-shape[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center}.icon-lg[_ngcontent-%COMP%]{width:64px;height:64px}.shadow-lg[_ngcontent-%COMP%]{box-shadow:0 15px 35px #32325d1a,0 5px 15px #00000012!important}.shadow-sm[_ngcontent-%COMP%]{box-shadow:0 2px 9px #00000026!important}.list-group-item[_ngcontent-%COMP%]{border:none;padding:.75rem 0;border-bottom:1px solid rgba(0,0,0,.125)}.list-group-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.btn-white[_ngcontent-%COMP%]{background-color:#fff;border-color:#fff;color:#344767}.btn-white[_ngcontent-%COMP%]:hover{background-color:#ffffffe6;border-color:#ffffffe6;color:#344767}.btn-light[_ngcontent-%COMP%]{background-color:#fff3;border-color:#fff3;color:#fff}.btn-light[_ngcontent-%COMP%]:hover{background-color:#ffffff4d;border-color:#ffffff4d;color:#fff}.opacity-8[_ngcontent-%COMP%]{opacity:.8}.badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.35em .65em}.bg-gradient-danger[_ngcontent-%COMP%]{background:linear-gradient(87deg,#f5365c 0,#f56036)}.bg-gradient-warning[_ngcontent-%COMP%]{background:linear-gradient(87deg,#fb6340 0,#fbb140)}.bg-gradient-secondary[_ngcontent-%COMP%]{background:linear-gradient(87deg,#8392ab 0,#83a9ab)}.bg-gradient-primary[_ngcontent-%COMP%]{background:linear-gradient(87deg,#5e72e4 0,#825ee4)}@media (max-width: 768px){.detail-reforme-sale[_ngcontent-%COMP%]   .container-fluid[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{padding:1rem}.icon-shape[_ngcontent-%COMP%]{width:40px;height:40px}.icon-lg[_ngcontent-%COMP%]{width:48px;height:48px}}@media (max-width: 576px){.btn-white[_ngcontent-%COMP%], .btn-light[_ngcontent-%COMP%]{width:100%;margin-bottom:.5rem}.col-md-4.text-end[_ngcontent-%COMP%]{text-align:center!important}}"]})};var Kn=[{path:"entreprises",component:lt},{path:"entreprises/create",component:ke},{path:"entreprises/edit/:id",component:ke},{path:"buyers",component:pt},{path:"buyers/create",component:ke},{path:"buyers/edit/:id",component:ke},{path:"brokens",component:dt},{path:"brokens/create",component:Pe},{path:"brokens/edit/:id",component:Pe},{path:"brokens/detail/:id",component:ct},{path:"cessions",component:ft},{path:"cessions/create",component:qe},{path:"cessions/detail/:id",component:ut},{path:"sales",component:gt},{path:"sales/create",component:He},{path:"sales/detail/:id",component:vt}],bt=class m{static \u0275fac=function(e){return new(e||m)};static \u0275mod=nt({type:m});static \u0275inj=it({imports:[_t.forChild(Kn),_t]})};var Qt=class m{static \u0275fac=function(e){return new(e||m)};static \u0275mod=nt({type:m});static \u0275inj=it({providers:[O],imports:[Et,bt,Lt,jt,Ut,Nt,zt,kt.forRoot({loader:{provide:wt,useFactory:Gt,deps:[at]}}),At,Vt,$t]})};export{Qt as ReformesModule};
